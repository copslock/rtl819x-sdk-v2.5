Index: fastpath/98/fastpath_core.S
===================================================================
--- fastpath/98/fastpath_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/98/fastpath_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -2859,33 +2859,33 @@
 	addiu	$sp,$sp,-88
 	li	$2,1			# 0x1
 	sw	$23,76($sp)
-	move	$23,$4
-	sw	$22,72($sp)
+	move	$23,$0
+	sw	$21,68($sp)
 	sw	$31,84($sp)
 	sw	$fp,80($sp)
-	sw	$21,68($sp)
+	sw	$22,72($sp)
 	sw	$20,64($sp)
 	sw	$19,60($sp)
 	sw	$18,56($sp)
 	sw	$17,52($sp)
 	sw	$16,48($sp)
 	lw	$18,156($4)
-	sw	$2,24($sp)
+	sw	$2,32($sp)
 	li	$2,6			# 0x6
-	sw	$0,28($sp)
-	sw	$0,32($sp)
-	lbu	$20,9($18)
+	sw	$0,36($sp)
+	sw	$0,40($sp)
+	lbu	$19,9($18)
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L475
-	move	$22,$0
+	beq	$19,$2,$L475
+	move	$21,$4
 	.set	macro
 	.set	reorder
 
 	li	$2,17			# 0x11
 	.set	noreorder
 	.set	nomacro
-	bne	$20,$2,$L472
+	bne	$19,$2,$L472
 	move	$4,$0
 	.set	macro
 	.set	reorder
@@ -2893,14 +2893,14 @@
 $L475:
 	lbu	$2,0($18)
 	move	$4,$18
-	move	$6,$23
+	move	$6,$21
 	andi	$2,$2,0xf
 	sll	$2,$2,2
-	addu	$fp,$18,$2
+	addu	$22,$18,$2
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_pre_process_check
-	move	$5,$fp
+	move	$5,$22
 	.set	macro
 	.set	reorder
 
@@ -2908,17 +2908,18 @@
 	move	$4,$2
 	li	$2,6			# 0x6
 	bne	$5,$2,$L472
-	lhu	$7,6($18)
-	lui	$4,%hi($LC0)
-	lw	$19,12($18)
-	lw	$21,16($18)
-	lhu	$8,0($fp)
-	lhu	$12,2($fp)
-	lw	$3,24($23)
+	lhu	$3,0($22)
+	lhu	$16,6($18)
+	lw	$20,12($18)
+	lw	$fp,16($18)
+	sw	$3,24($sp)
+	lhu	$2,2($22)
+	sw	$2,28($sp)
+	lw	$3,24($21)
 	.set	noreorder
 	.set	nomacro
-	bne	$20,$5,$L477
-	andi	$6,$7,0xffff
+	bne	$19,$5,$L477
+	lui	$4,%hi($LC0)
 	.set	macro
 	.set	reorder
 
@@ -2946,7 +2947,7 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$6,0x3fff
+	andi	$2,$16,0x3fff
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L483
@@ -2954,19 +2955,18 @@
 	.set	macro
 	.set	reorder
 
-	xori	$2,$6,0x2000
+	xori	$2,$16,0x2000
 	sltu	$3,$2,1
 $L483:
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L649
-	andi	$2,$7,0x3fff
+	bne	$3,$2,$L484
+	li	$2,65536			# 0x10000
 	.set	macro
 	.set	reorder
 
-	lw	$3,12($fp)
-	li	$2,65536			# 0x10000
+	lw	$3,12($22)
 	and	$2,$3,$2
 	.set	noreorder
 	.set	nomacro
@@ -2975,14 +2975,14 @@
 	.set	macro
 	.set	reorder
 
-	move	$4,$19
-	move	$5,$8
-	move	$6,$21
-	move	$7,$12
+	lw	$5,24($sp)
+	move	$4,$20
+	lw	$7,28($sp)
+	move	$6,$fp
 	.set	noreorder
 	.set	nomacro
 	jal	mark_path_invalid
-	sw	$20,16($sp)
+	sw	$19,16($sp)
 	.set	macro
 	.set	reorder
 
@@ -3002,13 +3002,28 @@
 	.set	macro
 	.set	reorder
 
+$L484:
+	lw	$2,12($22)
+	li	$3,1048576			# 0x100000
+	and	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L649
-	andi	$2,$7,0x3fff
+	beq	$2,$0,$L488
+	li	$2,40			# 0x28
 	.set	macro
 	.set	reorder
 
+	lhu	$3,2($18)
+	bne	$3,$2,$L488
+	move	$4,$21
+	.set	noreorder
+	.set	nomacro
+	jal	skb_trim
+	li	$5,40			# 0x28
+	.set	macro
+	.set	reorder
+
+	j	$L488
 $L477:
 	addiu	$2,$4,%lo($LC0)
 	move	$5,$3
@@ -3034,60 +3049,61 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$7,0x3fff
-$L649:
+$L488:
+	lhu	$2,6($18)
+	andi	$2,$2,0x3fff
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L651
-	srl	$3,$21,16
+	srl	$3,$fp,16
 	.set	macro
 	.set	reorder
 
 	li	$2,8192			# 0x2000
 	.set	noreorder
 	.set	nomacro
-	bne	$6,$2,$L491
-	andi	$2,$6,0x2000
+	bne	$16,$2,$L492
+	andi	$2,$16,0x2000
 	.set	macro
 	.set	reorder
 
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	j	$L492
-	sw	$2,28($sp)
+	j	$L493
+	sw	$2,36($sp)
 	.set	macro
 	.set	reorder
 
-$L491:
+$L492:
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L652
-	xor	$3,$19,$21
+	bne	$2,$0,$L493
+	andi	$3,$16,0x1fff
 	.set	macro
 	.set	reorder
 
-	lw	$4,32($sp)
-	andi	$3,$6,0x1fff
+	lw	$4,40($sp)
 	li	$2,1			# 0x1
 	movn	$4,$2,$3		#conditional move
-	sw	$4,32($sp)
-$L492:
-	xor	$3,$19,$21
-$L652:
+	sw	$4,40($sp)
+$L493:
+	lw	$8,12($18)
+	andi	$6,$19,0x00ff
+	lw	$7,16($18)
+	lhu	$5,4($18)
+	xor	$3,$8,$7
+	srl	$2,$3,16
+	xor	$2,$2,$5
+	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
-	lhu	$7,4($18)
-	srl	$4,$3,16
-	lw	$5,%lo(max_udp_frag_entry)($2)
-	andi	$6,$20,0x00ff
-	xor	$4,$4,$7
-	xor	$3,$3,$4
-	addiu	$5,$5,-1
+	lw	$4,%lo(max_udp_frag_entry)($2)
 	srl	$2,$3,8
 	xor	$2,$2,$6
 	xor	$3,$3,$2
+	addiu	$4,$4,-1
 	lui	$2,%hi(udp_cache_table)
-	and	$3,$3,$5
+	and	$3,$3,$4
 	lw	$4,%lo(udp_cache_table)($2)
 	sll	$2,$3,1
 	addu	$2,$2,$3
@@ -3097,79 +3113,83 @@
 	lw	$4,0($2)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L501
-	move	$22,$0
+	beq	$4,$0,$L502
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$3,1			# 0x1
-$L500:
+$L501:
 	lhu	$2,2($4)
-	bne	$2,$7,$L497
+	bne	$2,$5,$L498
 	lw	$2,4($4)
-	bne	$2,$19,$L497
+	bne	$2,$8,$L498
 	lw	$2,8($4)
-	bne	$2,$21,$L497
+	bne	$2,$7,$L498
 	lbu	$2,1($4)
-	bne	$2,$6,$L497
+	bne	$2,$6,$L498
 	lbu	$2,0($4)
-	beq	$2,$3,$L631
-$L497:
+	beq	$2,$3,$L632
+$L498:
 	lw	$4,40($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$4,$0,$L500
-	move	$22,$0
+	bne	$4,$0,$L501
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
-	j	$L501
-$L631:
+	j	$L502
+$L632:
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L501
-	move	$22,$4
+	beq	$4,$0,$L502
+	move	$23,$4
 	.set	macro
 	.set	reorder
 
-	lw	$5,28($sp)
-	lhu	$8,12($4)
-	lhu	$12,14($4)
+	lhu	$5,12($4)
+	lw	$3,36($sp)
+	sw	$5,24($sp)
+	lhu	$2,14($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$0,$L651
-	srl	$3,$21,16
+	bne	$3,$0,$L491
+	sw	$2,28($sp)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L651
-	sw	$0,24($sp)
+	j	$L491
+	sw	$0,32($sp)
 	.set	macro
 	.set	reorder
 
-$L501:
-	lw	$2,28($sp)
+$L502:
+	lw	$5,36($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L472
+	beq	$5,$0,$L472
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	srl	$3,$21,16
+$L491:
+	srl	$3,$fp,16
 $L651:
-	srl	$2,$19,8
-	sw	$3,36($sp)
-	xor	$2,$2,$19
-	xor	$3,$3,$21
+	srl	$2,$20,8
+	lw	$4,24($sp)
+	xor	$2,$2,$20
+	sw	$3,44($sp)
+	xor	$3,$3,$fp
 	xor	$2,$2,$3
-	srl	$3,$8,4
+	srl	$3,$4,4
+	lw	$5,28($sp)
 	xor	$2,$2,$3
 	lui	$3,%hi(path_table_list_max)
-	xor	$2,$2,$12
-	xor	$2,$2,$20
+	xor	$2,$2,$5
+	xor	$2,$2,$19
 	lw	$4,%lo(path_table_list_max)($3)
 	srl	$3,$2,12
 	xor	$2,$2,$3
@@ -3183,24 +3203,26 @@
 	sll	$2,$2,2
 	addu	$2,$2,$3
 	lw	$16,0($2)
-$L636:
+$L637:
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L630
+	beq	$16,$0,$L631
 	move	$4,$18
 	.set	macro
 	.set	reorder
 
 	lw	$2,12($16)
-	bne	$2,$8,$L508
+	lw	$3,24($sp)
+	bne	$2,$3,$L509
 	lw	$2,8($16)
-	bne	$2,$12,$L508
+	lw	$4,28($sp)
+	bne	$2,$4,$L509
 	lw	$2,16($16)
-	bne	$2,$19,$L508
+	bne	$2,$20,$L509
 	lw	$2,20($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$21,$L508
+	bne	$2,$fp,$L509
 	li	$2,255			# 0xff
 	.set	macro
 	.set	reorder
@@ -3208,7 +3230,7 @@
 	lbu	$3,0($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L508
+	bne	$3,$2,$L509
 	li	$2,2			# 0x2
 	.set	macro
 	.set	reorder
@@ -3216,7 +3238,7 @@
 	lw	$3,4($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L653
+	bne	$3,$2,$L652
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
@@ -3224,28 +3246,26 @@
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L510
+	beq	$19,$2,$L511
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
 
-$L653:
+$L652:
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L508
+	bne	$3,$2,$L509
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L508
-$L510:
+	bne	$19,$2,$L509
+$L511:
 	lw	$5,32($16)
-	move	$4,$23
+	move	$4,$21
 	lbu	$7,1($18)
-	move	$6,$19
-	lw	$2,24($23)
-	sw	$8,40($sp)
-	sw	$12,44($sp)
+	move	$6,$20
+	lw	$2,24($21)
 	.set	noreorder
 	.set	nomacro
 	jal	ip_route_input
@@ -3253,8 +3273,6 @@
 	.set	macro
 	.set	reorder
 
-	lw	$8,40($sp)
-	lw	$12,44($sp)
 	.set	noreorder
 	.set	nomacro
 	bne	$2,$0,$L472
@@ -3262,39 +3280,39 @@
 	.set	macro
 	.set	reorder
 
-	lw	$3,28($23)
+	lw	$3,28($21)
 	lw	$2,48($3)
-	bne	$2,$0,$L515
+	bne	$2,$0,$L516
 	lw	$2,44($3)
-	beq	$2,$0,$L643
-$L515:
+	beq	$2,$0,$L644
+$L516:
 	lw	$2,72($3)
-	lw	$3,84($23)
+	lw	$3,84($21)
 	sltu	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L643
+	bne	$2,$0,$L644
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L519
-	addiu	$17,$fp,16
+	beq	$19,$2,$L520
+	addiu	$17,$22,16
 	.set	macro
 	.set	reorder
 
-	lhu	$3,6($fp)
-	addiu	$2,$fp,6
+	lhu	$3,6($22)
+	addiu	$2,$22,6
 	move	$17,$0
 	movn	$17,$2,$3		#conditional move  
-$L519:
-	lw	$4,28($sp)
+$L520:
+	lw	$5,36($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L522
-	xor	$3,$19,$21
+	beq	$5,$0,$L523
+	xor	$3,$20,$fp
 	.set	macro
 	.set	reorder
 
@@ -3302,36 +3320,38 @@
 	lhu	$11,4($18)
 	srl	$4,$3,16
 	lw	$5,%lo(max_udp_frag_entry)($2)
-	andi	$9,$20,0x00ff
+	andi	$9,$19,0x00ff
 	xor	$4,$4,$11
 	lui	$6,%hi(udp_cache_list_free)
 	xor	$3,$3,$4
-	andi	$10,$8,0xffff
+	addiu	$5,$5,-1
+	lw	$4,24($sp)
 	srl	$2,$3,8
-	addiu	$5,$5,-1
 	xor	$2,$2,$9
-	andi	$7,$12,0xffff
+	andi	$10,$4,0xffff
+	xor	$3,$3,$2
+	lw	$4,28($sp)
+	and	$12,$3,$5
 	lw	$8,%lo(udp_cache_list_free)($6)
-	xor	$3,$3,$2
 	.set	noreorder
 	.set	nomacro
-	bne	$8,$0,$L525
-	and	$12,$3,$5
+	bne	$8,$0,$L526
+	andi	$7,$4,0xffff
 	.set	macro
 	.set	reorder
 
-$L643:
-	lw	$4,28($23)
+$L644:
+	lw	$4,28($21)
 	jal	dst_release
 	move	$4,$0
 	.set	noreorder
 	.set	nomacro
 	j	$L472
-	sw	$0,28($23)
+	sw	$0,28($21)
 	.set	macro
 	.set	reorder
 
-$L525:
+$L526:
 	lw	$4,48($8)
 	li	$2,1
 	sh	$11,2($8)
@@ -3339,26 +3359,26 @@
 	sh	$10,12($8)
 	sh	$7,14($8)
 	sb	$2,0($8)
-	sw	$19,4($8)
-	sw	$21,8($8)
+	sw	$20,4($8)
+	sw	$fp,8($8)
 	lw	$3,52($8)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L528
+	beq	$4,$0,$L529
 	addiu	$2,$6,%lo(udp_cache_list_free)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L529
+	j	$L530
 	sw	$3,52($4)
 	.set	macro
 	.set	reorder
 
-$L528:
+$L529:
 	sw	$3,4($2)
-$L529:
+$L530:
 	lw	$4,52($8)
 	addiu	$6,$6,%lo(udp_cache_list_free)
 	lw	$2,48($8)
@@ -3406,58 +3426,58 @@
 	.set	noreorder
 	.set	nomacro
 	j	$L650
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
-$L522:
-	lw	$5,32($sp)
+$L523:
+	lw	$5,40($sp)
 	.set	noreorder
 	.set	nomacro
 	beq	$5,$0,$L650
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
 	jal	del_timer
-	addiu	$4,$22,16
+	addiu	$4,$23,16
 	.set	macro
 	.set	reorder
 
-	lw	$2,8($22)
-	lw	$3,4($22)
-	lhu	$4,2($22)
+	lw	$2,8($23)
+	lw	$3,4($23)
+	lhu	$4,2($23)
 	xor	$3,$3,$2
 	srl	$2,$3,16
 	xor	$2,$2,$4
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
-	lbu	$5,1($22)
+	lbu	$5,1($23)
 	srl	$4,$3,8
 	lw	$2,%lo(max_udp_frag_entry)($2)
 	xor	$4,$4,$5
-	lw	$6,40($22)
+	lw	$6,40($23)
 	xor	$3,$3,$4
 	addiu	$2,$2,-1
-	sb	$0,0($22)
-	lw	$4,44($22)
+	sb	$0,0($23)
+	lw	$4,44($23)
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L535
+	beq	$6,$0,$L536
 	and	$5,$3,$2
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L536
+	j	$L537
 	sw	$4,44($6)
 	.set	macro
 	.set	reorder
 
-$L535:
+$L536:
 	lui	$3,%hi(udp_cache_table)
 	sll	$2,$5,1
 	lw	$3,%lo(udp_cache_table)($3)
@@ -3466,13 +3486,13 @@
 	lw	$3,0($3)
 	addu	$2,$2,$3
 	sw	$4,4($2)
-$L536:
-	lw	$4,44($22)
+$L537:
+	lw	$4,44($23)
 	sll	$3,$5,1
-	lw	$2,40($22)
+	lw	$2,40($23)
 	addu	$3,$3,$5
 	sll	$3,$3,2
-	addiu	$5,$22,48
+	addiu	$5,$23,48
 	sw	$2,0($4)
 	lui	$2,%hi(udp_cache_table)
 	lw	$2,%lo(udp_cache_table)($2)
@@ -3483,22 +3503,22 @@
 	lw	$2,8($3)
 	addiu	$2,$2,-1
 	sw	$2,8($3)
-	sw	$0,48($22)
+	sw	$0,48($23)
 	lw	$2,4($4)
-	sw	$2,52($22)
+	sw	$2,52($23)
 	lw	$2,4($4)
-	sw	$22,0($2)
+	sw	$23,0($2)
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
 	sw	$2,8($4)
-	move	$4,$23
+	move	$4,$21
 $L650:
 	move	$5,$18
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_before_nat_check
-	move	$6,$20
+	move	$6,$19
 	.set	macro
 	.set	reorder
 
@@ -3510,37 +3530,37 @@
 	sltu	$2,$3,13
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L601
+	beq	$2,$0,$L602
 	sll	$2,$3,2
 	.set	macro
 	.set	reorder
 
-	lui	$3,%hi($L624)
-	addiu	$3,$3,%lo($L624)
+	lui	$3,%hi($L625)
+	addiu	$3,$3,%lo($L625)
 	addu	$2,$2,$3
 	lw	$2,0($2)
 	j	$2
 	.rdata
 	.align	2
-$L624:
-	.word	$L541
-	.word	$L543
-	.word	$L558
-	.word	$L558
-	.word	$L572
-	.word	$L601
-	.word	$L601
-	.word	$L601
-	.word	$L587
-	.word	$L601
-	.word	$L601
-	.word	$L601
-	.word	$L587
+$L625:
+	.word	$L542
+	.word	$L544
+	.word	$L559
+	.word	$L559
+	.word	$L573
+	.word	$L602
+	.word	$L602
+	.word	$L602
+	.word	$L588
+	.word	$L602
+	.word	$L602
+	.word	$L602
+	.word	$L588
 	.section	.text.enter_fast_path
-$L543:
+$L544:
 	lw	$3,24($16)
-	srl	$2,$19,16
-	andi	$4,$19,0xffff
+	srl	$2,$20,16
+	andi	$4,$20,0xffff
 	addu	$4,$4,$2
 	andi	$2,$3,0xffff
 	subu	$4,$4,$2
@@ -3550,7 +3570,7 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L545
+	bgez	$4,$L546
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3564,30 +3584,30 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L544
+	j	$L545
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L545:
+$L546:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L544:
-	lw	$2,24($sp)
+$L545:
+	lw	$2,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L562
+	beq	$2,$0,$L563
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L548
-	beq	$17,$0,$L562
+	bne	$19,$2,$L549
+	beq	$17,$0,$L563
 	lhu	$6,0($17)
-	beq	$6,$0,$L562
+	beq	$6,$0,$L563
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3599,12 +3619,12 @@
 	subu	$5,$5,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L644
+	j	$L645
 	addu	$5,$5,$6
 	.set	macro
 	.set	reorder
 
-$L548:
+$L549:
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3616,10 +3636,10 @@
 	lhu	$2,0($17)
 	subu	$5,$5,$3
 	addu	$5,$5,$2
-$L644:
+$L645:
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L555
+	bgez	$5,$L556
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3633,27 +3653,27 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L562
+	j	$L563
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L555:
+$L556:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L562
+	j	$L563
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L558:
+$L559:
 	lw	$3,24($16)
-	srl	$2,$19,16
-	andi	$4,$19,0xffff
+	srl	$2,$20,16
+	andi	$4,$20,0xffff
 	addu	$4,$4,$2
 	andi	$2,$3,0xffff
 	subu	$4,$4,$2
@@ -3663,7 +3683,7 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L560
+	bgez	$4,$L561
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3677,30 +3697,30 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L559
+	j	$L560
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L560:
+$L561:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L559:
-	lw	$3,24($sp)
+$L560:
+	lw	$3,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L562
+	beq	$3,$0,$L563
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L563
-	beq	$17,$0,$L568
+	bne	$19,$2,$L564
+	beq	$17,$0,$L569
 	lhu	$6,0($17)
-	beq	$6,$0,$L568
+	beq	$6,$0,$L569
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3709,19 +3729,19 @@
 	andi	$2,$3,0xffff
 	subu	$5,$5,$2
 	srl	$3,$3,16
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	subu	$5,$5,$3
 	lw	$2,28($16)
 	addu	$5,$5,$4
 	subu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L645
+	j	$L646
 	addu	$5,$5,$6
 	.set	macro
 	.set	reorder
 
-$L563:
+$L564:
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3730,17 +3750,17 @@
 	andi	$2,$3,0xffff
 	subu	$5,$5,$2
 	srl	$3,$3,16
-	lhu	$2,0($fp)
+	lhu	$2,0($22)
 	subu	$5,$5,$3
 	lw	$3,28($16)
 	addu	$5,$5,$2
 	lhu	$2,0($17)
 	subu	$5,$5,$3
 	addu	$5,$5,$2
-$L645:
+$L646:
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L570
+	bgez	$5,$L571
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3754,33 +3774,33 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L568
+	j	$L569
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L570:
+$L571:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,0($17)
-$L568:
+$L569:
 	lw	$2,28($16)
-	sh	$2,0($fp)
-$L562:
+	sh	$2,0($22)
+$L563:
 	lw	$2,24($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L541
+	j	$L542
 	sw	$2,12($18)
 	.set	macro
 	.set	reorder
 
-$L572:
+$L573:
 	lw	$2,32($16)
-	andi	$6,$21,0xffff
-	lw	$5,36($sp)
+	andi	$6,$fp,0xffff
+	lw	$5,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$4,$6,$5
@@ -3790,7 +3810,7 @@
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L574
+	bgez	$4,$L575
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3804,45 +3824,45 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L573
+	j	$L574
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L574:
+$L575:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L573:
-	lw	$2,24($sp)
+$L574:
+	lw	$2,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L642
+	beq	$2,$0,$L643
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L577
-	beq	$17,$0,$L642
+	bne	$19,$2,$L578
+	beq	$17,$0,$L643
 	lhu	$4,0($17)
-	beq	$4,$0,$L642
-	lw	$3,36($sp)
+	beq	$4,$0,$L643
+	lw	$3,44($sp)
 	lw	$2,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L646
+	j	$L647
 	addu	$6,$6,$3
 	.set	macro
 	.set	reorder
 
-$L577:
-	lw	$4,36($sp)
+$L578:
+	lw	$4,44($sp)
 	lw	$2,32($16)
 	addu	$6,$6,$4
 	lhu	$4,0($17)
-$L646:
+$L647:
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
@@ -3850,7 +3870,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L584
+	bgez	$6,$L585
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3864,27 +3884,27 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L642
+	j	$L643
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L584:
+$L585:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L642
+	j	$L643
 	sh	$6,0($17)
 	.set	macro
 	.set	reorder
 
-$L587:
+$L588:
 	lw	$2,32($16)
-	andi	$6,$21,0xffff
-	lw	$5,36($sp)
+	andi	$6,$fp,0xffff
+	lw	$5,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$4,$6,$5
@@ -3894,7 +3914,7 @@
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L589
+	bgez	$4,$L590
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3908,33 +3928,33 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L588
+	j	$L589
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L589:
+$L590:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L588:
-	lw	$2,24($sp)
+$L589:
+	lw	$2,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L642
+	beq	$2,$0,$L643
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L592
-	beq	$17,$0,$L597
+	bne	$19,$2,$L593
+	beq	$17,$0,$L598
 	lhu	$5,0($17)
-	beq	$5,$0,$L597
+	beq	$5,$0,$L598
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	lhu	$4,2($fp)
+	lw	$3,44($sp)
+	lhu	$4,2($22)
 	addu	$6,$6,$3
 	andi	$3,$2,0xffff
 	subu	$6,$6,$3
@@ -3945,29 +3965,29 @@
 	subu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L647
+	j	$L648
 	addu	$6,$6,$5
 	.set	macro
 	.set	reorder
 
-$L592:
+$L593:
 	lw	$2,32($16)
-	lw	$4,36($sp)
+	lw	$4,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$6,$6,$4
 	subu	$6,$6,$3
-	lhu	$4,2($fp)
+	lhu	$4,2($22)
 	subu	$6,$6,$2
 	lw	$3,36($16)
 	addu	$6,$6,$4
 	lhu	$2,0($17)
 	subu	$6,$6,$3
 	addu	$6,$6,$2
-$L647:
+$L648:
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L599
+	bgez	$6,$L600
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3981,30 +4001,30 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L597
+	j	$L598
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L599:
+$L600:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L597:
+$L598:
 	lw	$2,36($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L642
-	sh	$2,2($fp)
+	j	$L643
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
-$L601:
+$L602:
 	lw	$2,24($16)
-	srl	$6,$19,16
-	andi	$4,$19,0xffff
+	srl	$6,$20,16
+	andi	$4,$20,0xffff
 	andi	$3,$2,0xffff
 	addu	$5,$4,$6
 	subu	$5,$5,$3
@@ -4014,7 +4034,7 @@
 	addu	$5,$5,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L603
+	bgez	$5,$L604
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4028,21 +4048,21 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L602
+	j	$L603
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L603:
+$L604:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L602:
+$L603:
 	lw	$2,32($16)
-	andi	$7,$21,0xffff
-	lw	$3,36($sp)
+	andi	$7,$fp,0xffff
+	lw	$3,44($sp)
 	addu	$5,$7,$3
 	andi	$3,$2,0xffff
 	subu	$5,$5,$3
@@ -4052,7 +4072,7 @@
 	addu	$5,$5,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L606
+	bgez	$5,$L607
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4066,38 +4086,38 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L605
+	j	$L606
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L606:
+$L607:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L605:
-	lw	$5,24($sp)
+$L606:
+	lw	$5,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L608
+	beq	$5,$0,$L609
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L609
-	beq	$17,$0,$L617
+	bne	$19,$2,$L610
+	beq	$17,$0,$L618
 	lhu	$5,0($17)
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L617
+	beq	$5,$0,$L618
 	addu	$6,$4,$6
 	.set	macro
 	.set	reorder
 
 	lw	$2,24($16)
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
@@ -4108,7 +4128,7 @@
 	addu	$6,$6,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L612
+	bgez	$6,$L613
 	sra	$3,$6,16
 	.set	macro
 	.set	reorder
@@ -4122,31 +4142,31 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L611
+	j	$L612
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L612:
+$L613:
 	andi	$2,$6,0xffff
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L611:
-	lw	$3,36($sp)
+$L612:
+	lw	$3,44($sp)
 	lw	$2,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L648
+	j	$L649
 	addu	$6,$7,$3
 	.set	macro
 	.set	reorder
 
-$L609:
+$L610:
 	lw	$2,24($16)
 	addu	$6,$4,$6
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
@@ -4158,7 +4178,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L619
+	bgez	$6,$L620
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4172,26 +4192,26 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L618
+	j	$L619
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L619:
+$L620:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L618:
-	lw	$4,36($sp)
+$L619:
+	lw	$4,44($sp)
 	lw	$2,32($16)
 	addu	$6,$7,$4
-$L648:
+$L649:
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
-	lhu	$4,2($fp)
+	lhu	$4,2($22)
 	subu	$6,$6,$2
 	lw	$3,36($16)
 	addu	$6,$6,$4
@@ -4200,7 +4220,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L622
+	bgez	$6,$L623
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4214,51 +4234,51 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L617
+	j	$L618
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L622:
+$L623:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L617:
+$L618:
 	lw	$2,28($16)
-	sh	$2,0($fp)
+	sh	$2,0($22)
 	lw	$2,36($16)
-	sh	$2,2($fp)
-$L608:
+	sh	$2,2($22)
+$L609:
 	lw	$2,24($16)
 	sw	$2,12($18)
-$L642:
+$L643:
 	lw	$2,32($16)
 	sw	$2,16($18)
-$L541:
-	lw	$3,104($23)
+$L542:
+	lw	$3,104($21)
 	li	$2,-805371904			# 0xcfff0000
 	ori	$2,$2,0xffff
 	and	$3,$3,$2
-	lw	$2,28($23)
-	sw	$3,104($23)
+	lw	$2,28($21)
+	sw	$3,104($21)
 	lw	$2,12($2)
-	sw	$2,24($23)
+	sw	$2,24($21)
 	lw	$5,48($16)
 	lw	$6,52($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fastpath_set_qos_mark
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	lui	$2,%hi(jiffies)
 	lw	$2,%lo(jiffies)($2)
 	move	$4,$18
-	move	$5,$fp
-	move	$6,$23
+	move	$5,$22
+	move	$6,$21
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_post_process_xmit_check
@@ -4277,7 +4297,7 @@
 	.set	noreorder
 	.set	nomacro
 	jal	ip_finish_output3
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
@@ -4288,14 +4308,14 @@
 	.set	macro
 	.set	reorder
 
-$L508:
+$L509:
 	lw	$16,64($16)
-	j	$L636
-$L630:
-	lw	$2,24($23)
-	move	$5,$fp
-	move	$6,$23
-	sw	$2,140($23)
+	j	$L637
+$L631:
+	lw	$2,24($21)
+	move	$5,$22
+	move	$6,$21
+	sw	$2,140($21)
 	lw	$31,84($sp)
 	lw	$fp,80($sp)
 	lw	$23,76($sp)
@@ -4357,26 +4377,26 @@
 	sw	$31,20($sp)
 	move	$16,$5
 	lw	$2,%lo(path_list_inuse)($2)
-$L667:
-	beq	$2,$0,$L664
+$L666:
+	beq	$2,$0,$L663
 	move	$6,$0
 
 	lw	$2,72($2)
-	j	$L667
+	j	$L666
 	addiu	$7,$7,1
 
-$L664:
+$L663:
 	lui	$2,%hi(napt_list_inuse)
 	lw	$2,%lo(napt_list_inuse)($2)
-$L668:
-	beq	$2,$0,$L666
+$L667:
+	beq	$2,$0,$L665
 	lui	$5,%hi($LC1)
 
 	lw	$2,44($2)
-	j	$L668
+	j	$L667
 	addiu	$6,$6,1
 
-$L666:
+$L665:
 	addu	$4,$4,$16
 	jal	sprintf
 	addiu	$5,$5,%lo($LC1)
@@ -4403,8 +4423,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L674:
-$L715:
+$L673:
+$L714:
 	addiu	$sp,$sp,-64
 	lui	$2,%hi(malloc_sizes+4)
 	sw	$21,52($sp)
@@ -4424,11 +4444,11 @@
 
 	li	$3,-1			# 0xffffffff
 	move	$17,$2
-	beq	$2,$0,$L669
+	beq	$2,$0,$L668
 	sw	$2,%lo(table_napt)($16)
 
-$L725:
-$L766:
+$L724:
+$L765:
 	lui	$2,%hi(napt_list_inuse)
 	lui	$20,%hi(napt_list_free)
 	sll	$4,$18,1
@@ -4450,22 +4470,22 @@
 	sw	$2,0($17)
 	lw	$2,%lo(table_napt)($16)
 	lw	$2,0($2)
-	beq	$2,$0,$L669
+	beq	$2,$0,$L668
 	li	$3,-1			# 0xffffffff
 
-	j	$L769
+	j	$L768
 	move	$16,$0
 
-$L833:
-	j	$L669
+$L832:
+	j	$L668
 	li	$3,-2			# 0xfffffffe
 
-$L769:
-	blez	$18,$L830
+$L768:
+	blez	$18,$L829
 	nop
 
 	move	$4,$0
-$L774:
+$L773:
 	lw	$2,%lo(table_napt)($19)
 	addiu	$16,$16,1
 	slt	$3,$16,$18
@@ -4480,16 +4500,16 @@
 	lw	$2,0($2)
 	addu	$2,$4,$2
 	addiu	$4,$4,12
-	bne	$3,$0,$L774
+	bne	$3,$0,$L773
 	sw	$2,4($2)
 
-$L830:
-	blez	$21,$L832
+$L829:
+	blez	$21,$L831
 	move	$16,$0
 
-$L828:
-$L782:
-$L823:
+$L827:
+$L781:
+$L822:
 	lui	$2,%hi(malloc_sizes+12)
 	li	$5,32			# 0x20
 	lw	$4,%lo(malloc_sizes+12)($2)
@@ -4499,7 +4519,7 @@
 	addiu	$4,$20,%lo(napt_list_free)
 	move	$3,$2
 	addiu	$5,$2,44
-	beq	$2,$0,$L833
+	beq	$2,$0,$L832
 	slt	$6,$16,$21
 
 	sw	$0,44($2)
@@ -4510,12 +4530,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L828
+	bne	$6,$0,$L827
 	sw	$2,8($4)
 
-$L832:
+$L831:
 	move	$3,$0
-$L669:
+$L668:
 	lw	$31,56($sp)
 	move	$2,$3
 	lw	$21,52($sp)
@@ -4543,8 +4563,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L839:
-$L880:
+$L838:
+$L879:
 	addiu	$sp,$sp,-64
 	lui	$2,%hi(malloc_sizes+4)
 	sw	$21,52($sp)
@@ -4564,11 +4584,11 @@
 
 	li	$3,-1			# 0xffffffff
 	move	$17,$2
-	beq	$2,$0,$L834
+	beq	$2,$0,$L833
 	sw	$2,%lo(table_path)($16)
 
-$L890:
-$L931:
+$L889:
+$L930:
 	lui	$2,%hi(path_list_inuse)
 	lui	$20,%hi(path_list_free)
 	sll	$4,$18,1
@@ -4590,22 +4610,22 @@
 	sw	$2,0($17)
 	lw	$2,%lo(table_path)($16)
 	lw	$2,0($2)
-	beq	$2,$0,$L834
+	beq	$2,$0,$L833
 	li	$3,-1			# 0xffffffff
 
-	j	$L934
+	j	$L933
 	move	$16,$0
 
-$L998:
-	j	$L834
+$L997:
+	j	$L833
 	li	$3,-2			# 0xfffffffe
 
-$L934:
-	blez	$18,$L995
+$L933:
+	blez	$18,$L994
 	nop
 
 	move	$4,$0
-$L939:
+$L938:
 	lw	$2,%lo(table_path)($19)
 	addiu	$16,$16,1
 	slt	$3,$16,$18
@@ -4620,16 +4640,16 @@
 	lw	$2,0($2)
 	addu	$2,$4,$2
 	addiu	$4,$4,12
-	bne	$3,$0,$L939
+	bne	$3,$0,$L938
 	sw	$2,4($2)
 
-$L995:
-	blez	$21,$L997
+$L994:
+	blez	$21,$L996
 	move	$16,$0
 
-$L993:
-$L947:
-$L988:
+$L992:
+$L946:
+$L987:
 	lui	$2,%hi(malloc_sizes+20)
 	li	$5,32			# 0x20
 	lw	$4,%lo(malloc_sizes+20)($2)
@@ -4639,7 +4659,7 @@
 	addiu	$4,$20,%lo(path_list_free)
 	move	$3,$2
 	addiu	$5,$2,72
-	beq	$2,$0,$L998
+	beq	$2,$0,$L997
 	slt	$6,$16,$21
 
 	sw	$0,72($2)
@@ -4650,12 +4670,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L993
+	bne	$6,$0,$L992
 	sw	$2,8($4)
 
-$L997:
+$L996:
 	move	$3,$0
-$L834:
+$L833:
 	lw	$31,56($sp)
 	move	$2,$3
 	lw	$21,52($sp)
Index: fastpath/98/fast_l2tp_core.S
===================================================================
--- fastpath/98/fast_l2tp_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/98/fast_l2tp_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -515,13 +515,8 @@
 	beq	$2,$0,$L32
 	nop
 
-	lw	$3,16($17)
-	lw	$2,16($18)
-	bne	$3,$2,$L32
-	nop
-
-	lw	$3,12($18)
-	lw	$2,12($17)
+	lw	$3,16($18)
+	lw	$2,16($17)
 	bne	$2,$3,$L32
 	nop
 
Index: fastpath/96C/fastpath_core.S
===================================================================
--- fastpath/96C/fastpath_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/96C/fastpath_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -652,7 +652,7 @@
 	.set	noreorder
 	.set	nomacro
 	jal	filter_addconnect
-	sw	$5,72($sp)
+	sw	$5,76($sp)
 	.set	macro
 	.set	reorder
 
@@ -675,16 +675,16 @@
 
 	lui	$8,%hi(table_napt)
 	lw	$3,%lo(table_napt)($8)
+	sw	$2,72($sp)
 	sll	$9,$2,1
-	move	$fp,$2
 	lw	$3,0($3)
 	addu	$2,$9,$2
 	sll	$2,$2,2
 	addu	$2,$2,$3
 	lw	$4,0($2)
 	#nop
-$L336:
-	beq	$4,$0,$L334
+$L344:
+	beq	$4,$0,$L342
 	lw	$2,4($4)
 	#nop
 	bne	$2,$22,$L210
@@ -709,28 +709,22 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$16,$L326
+	beq	$2,$16,$L334
 	move	$2,$0
 	.set	macro
 	.set	reorder
 
 $L210:
 	lw	$4,36($4)
-	j	$L336
-$L334:
+	j	$L344
+$L342:
 #APP
-	raw_local_irq_save	$2
+	raw_local_irq_save	$20
 #NO_APP
 	lui	$4,%hi(napt_list_free)
 	lw	$7,%lo(napt_list_free)($4)
 	#nop
-	.set	noreorder
-	.set	nomacro
 	beq	$7,$0,$L214
-	sw	$2,76($sp)
-	.set	macro
-	.set	reorder
-
 	lw	$2,0($17)
 	lw	$6,44($7)
 	lw	$5,48($7)
@@ -784,14 +778,15 @@
 	sw	$2,8($4)
 	sw	$0,44($7)
 	lw	$2,4($3)
-	addu	$4,$9,$fp
-	sll	$4,$4,2
+	lw	$6,72($sp)
 	sw	$2,48($7)
 	lw	$2,4($3)
-	addiu	$6,$7,36
+	addu	$4,$9,$6
+	sll	$4,$4,2
 	sw	$7,0($2)
 	lw	$2,8($3)
 	sw	$5,4($3)
+	addiu	$6,$7,36
 	addiu	$2,$2,1
 	sw	$2,8($3)
 	sw	$0,36($7)
@@ -841,25 +836,39 @@
 	.set	noreorder
 	.set	nomacro
 	jal	rtl865x_getWanDev
-	move	$21,$2
+	move	$23,$2
 	.set	macro
 	.set	reorder
 
-	lw	$20,156($18)
-	move	$22,$2
+	lhu	$7,106($18)
+	lw	$21,156($18)
+	move	$fp,$2
+	sw	$7,100($sp)
+	lbu	$2,0($21)
+	lw	$3,76($sp)
+	andi	$2,$2,0xf
+	sll	$2,$2,2
+	addu	$22,$21,$2
+	li	$2,6			# 0x6
+	.set	noreorder
+	.set	nomacro
+	bne	$3,$2,$L222
+	li	$3,458752			# 0x70000
+	.set	macro
+	.set	reorder
+
+	lw	$2,12($22)
+	#nop
+	and	$2,$2,$3
+	bne	$2,$0,$L214
+$L222:
 	lw	$5,160($18)
-	lbu	$2,0($20)
-	lhu	$3,106($18)
 	addiu	$4,$sp,24
-	andi	$2,$2,0xf
-	addiu	$5,$5,6
 	li	$6,6			# 0x6
-	sll	$2,$2,2
-	addu	$23,$20,$2
 	.set	noreorder
 	.set	nomacro
 	jal	memcpy
-	sw	$3,100($sp)
+	addiu	$5,$5,6
 	.set	macro
 	.set	reorder
 
@@ -872,18 +881,18 @@
 	.set	macro
 	.set	reorder
 
-	lw	$5,12($20)
+	lw	$4,12($21)
 	#nop
-	sw	$5,80($sp)
-	lhu	$2,0($23)
+	sw	$4,80($sp)
+	lhu	$5,0($22)
 	#nop
-	sw	$2,88($sp)
-	lw	$3,16($20)
+	sw	$5,88($sp)
+	lw	$6,16($21)
 	#nop
-	sw	$3,84($sp)
-	lhu	$5,2($23)
+	sw	$6,84($sp)
+	lhu	$7,2($22)
 	#nop
-	sw	$5,92($sp)
+	sw	$7,92($sp)
 	lw	$2,28($18)
 	#nop
 	sw	$2,96($sp)
@@ -893,28 +902,30 @@
 	lw	$4,8($17)
 	srl	$2,$5,8
 	srl	$3,$6,16
+	xor	$3,$3,$6
 	xor	$2,$2,$5
-	xor	$3,$3,$6
 	lw	$5,24($17)
 	xor	$2,$2,$3
 	srl	$4,$4,4
 	xor	$2,$2,$4
 	xor	$2,$2,$5
-	lw	$5,72($sp)
+	lw	$5,76($sp)
 	lui	$3,%hi(path_table_list_max)
 	lw	$4,%lo(path_table_list_max)($3)
-	lui	$3,%hi(path_list_free)
 	xor	$2,$2,$5
-	lw	$16,%lo(path_list_free)($3)
-	lw	$5,144($18)
 	srl	$3,$2,12
 	xor	$2,$2,$3
 	addiu	$4,$4,-1
-	and	$fp,$4,$2
+	and	$4,$4,$2
+	lui	$6,%hi(path_list_free)
+	sw	$4,72($sp)
+	lw	$7,144($18)
+	lw	$16,%lo(path_list_free)($6)
+	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L227
-	sw	$5,104($sp)
+	beq	$16,$0,$L235
+	sw	$7,104($sp)
 	.set	macro
 	.set	reorder
 
@@ -959,48 +970,48 @@
 	sb	$2,0($16)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$3,$L228
+	beq	$4,$3,$L236
 	sb	$0,1($16)
 	.set	macro
 	.set	reorder
 
 	li	$2,1			# 0x1
 	sb	$2,1($16)
-$L228:
+$L236:
 	lw	$3,12($16)
 	lw	$2,28($16)
 	#nop
-	beq	$3,$2,$L229
+	beq	$3,$2,$L237
 	lbu	$2,1($16)
 	#nop
 	ori	$2,$2,0x2
 	sb	$2,1($16)
-$L229:
+$L237:
 	sw	$0,48($16)
 	sw	$0,52($16)
 	lw	$2,4($17)
 	addiu	$19,$sp,40
 	move	$4,$19
-	sw	$2,12($20)
+	sw	$2,12($21)
 	lw	$2,8($17)
 	move	$5,$0
 	li	$6,14			# 0xe
-	sh	$2,0($23)
+	sh	$2,0($22)
 	lw	$2,20($17)
 	#nop
-	sw	$2,16($20)
+	sw	$2,16($21)
 	lw	$2,24($17)
 	.set	noreorder
 	.set	nomacro
 	jal	memset
-	sh	$2,2($23)
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$0,$L230
-	move	$5,$21
+	beq	$23,$0,$L238
+	move	$5,$23
 	.set	macro
 	.set	reorder
 
@@ -1014,7 +1025,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L230
+	bne	$2,$0,$L238
 	addiu	$5,$sp,56
 	.set	macro
 	.set	reorder
@@ -1028,21 +1039,21 @@
 	.set	macro
 	.set	reorder
 
-	bne	$2,$0,$L231
+	bne	$2,$0,$L239
 	lw	$3,160($18)
 	#nop
-	beq	$3,$0,$L231
+	beq	$3,$0,$L239
 	lbu	$2,12($3)
 	lbu	$3,13($3)
 	sll	$2,$2,8
 	or	$3,$3,$2
 	li	$2,2048			# 0x800
-	beq	$3,$2,$L231
+	beq	$3,$2,$L239
 	lw	$2,176($18)
 	#nop
 	addiu	$2,$2,-22
 	sw	$2,160($18)
-$L231:
+$L239:
 	lw	$4,160($18)
 	move	$5,$19
 	li	$6,6			# 0x6
@@ -1054,7 +1065,7 @@
 	.set	reorder
 
 	lw	$4,160($18)
-	addiu	$5,$21,320
+	addiu	$5,$23,320
 	.set	noreorder
 	.set	nomacro
 	jal	memcpy
@@ -1062,13 +1073,13 @@
 	.set	macro
 	.set	reorder
 
-$L230:
+$L238:
 	sw	$0,144($18)
 	lw	$3,100($sp)
 	li	$2,2048			# 0x800
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L240
+	bne	$3,$2,$L248
 	lui	$2,%hi(nf_hooks+128)
 	.set	macro
 	.set	reorder
@@ -1077,7 +1088,7 @@
 	addiu	$2,$2,%lo(nf_hooks+128)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L240
+	beq	$3,$2,$L248
 	lui	$2,%hi(init_net+236)
 	.set	macro
 	.set	reorder
@@ -1085,8 +1096,8 @@
 	lw	$2,%lo(init_net+236)($2)
 	move	$4,$18
 	move	$5,$0
-	move	$6,$21
-	move	$7,$22
+	move	$6,$23
+	move	$7,$fp
 	.set	noreorder
 	.set	nomacro
 	jal	ipt_do_table
@@ -1094,7 +1105,7 @@
 	.set	macro
 	.set	reorder
 
-$L240:
+$L248:
 	lw	$2,144($18)
 	addiu	$19,$sp,40
 	move	$4,$19
@@ -1102,25 +1113,25 @@
 	lw	$2,12($17)
 	move	$5,$0
 	li	$6,14			# 0xe
-	sw	$2,12($20)
+	sw	$2,12($21)
 	lw	$2,16($17)
 	#nop
-	sh	$2,0($23)
+	sh	$2,0($22)
 	lw	$2,20($17)
 	#nop
-	sw	$2,16($20)
+	sw	$2,16($21)
 	lw	$2,24($17)
 	.set	noreorder
 	.set	nomacro
 	jal	memset
-	sh	$2,2($23)
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$22,$0,$L245
-	move	$5,$22
+	beq	$fp,$0,$L253
+	move	$5,$fp
 	.set	macro
 	.set	reorder
 
@@ -1134,7 +1145,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L245
+	bne	$2,$0,$L253
 	addiu	$5,$sp,56
 	.set	macro
 	.set	reorder
@@ -1148,21 +1159,21 @@
 	.set	macro
 	.set	reorder
 
-	bne	$2,$0,$L246
+	bne	$2,$0,$L254
 	lw	$3,160($18)
 	#nop
-	beq	$3,$0,$L246
+	beq	$3,$0,$L254
 	lbu	$2,12($3)
 	lbu	$3,13($3)
 	sll	$2,$2,8
 	or	$3,$3,$2
 	li	$2,2048			# 0x800
-	beq	$3,$2,$L246
+	beq	$3,$2,$L254
 	lw	$2,176($18)
 	#nop
 	addiu	$2,$2,-22
 	sw	$2,160($18)
-$L246:
+$L254:
 	lw	$4,160($18)
 	move	$5,$19
 	.set	noreorder
@@ -1173,7 +1184,7 @@
 	.set	reorder
 
 	lw	$4,160($18)
-	addiu	$5,$22,320
+	addiu	$5,$fp,320
 	li	$6,6			# 0x6
 	.set	noreorder
 	.set	nomacro
@@ -1182,13 +1193,13 @@
 	.set	macro
 	.set	reorder
 
-$L245:
+$L253:
 	sw	$0,144($18)
-	lw	$5,100($sp)
+	lw	$4,100($sp)
 	li	$2,2048			# 0x800
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$2,$L255
+	bne	$4,$2,$L263
 	lui	$2,%hi(nf_hooks+160)
 	.set	macro
 	.set	reorder
@@ -1197,7 +1208,7 @@
 	addiu	$2,$2,%lo(nf_hooks+160)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L255
+	beq	$3,$2,$L263
 	lui	$2,%hi(init_net+236)
 	.set	macro
 	.set	reorder
@@ -1205,8 +1216,8 @@
 	lw	$2,%lo(init_net+236)($2)
 	move	$4,$18
 	li	$5,4			# 0x4
-	move	$6,$21
-	move	$7,$22
+	move	$6,$23
+	move	$7,$fp
 	.set	noreorder
 	.set	nomacro
 	jal	ipt_do_table
@@ -1214,60 +1225,60 @@
 	.set	macro
 	.set	reorder
 
-$L255:
+$L263:
 	lw	$2,144($18)
 	#nop
 	sw	$2,52($16)
-	lw	$3,72($sp)
+	lw	$5,76($sp)
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L260
+	bne	$5,$2,$L268
 	lui	$2,%hi(nf_ct_udp_timeout_stream)
 	.set	macro
 	.set	reorder
 
-	lw	$5,160($sp)
+	lw	$6,160($sp)
 	#nop
-	lbu	$4,176($5)
+	lbu	$4,176($6)
 	jal	tcp_get_timeouts_by_state
 	.set	noreorder
 	.set	nomacro
-	j	$L341
+	j	$L348
 	sw	$2,60($16)
 	.set	macro
 	.set	reorder
 
-$L260:
+$L268:
 	lw	$2,%lo(nf_ct_udp_timeout_stream)($2)
 	#nop
 	sw	$2,60($16)
-$L341:
-	lw	$2,160($sp)
+$L348:
+	lw	$7,160($sp)
+	lui	$2,%hi(jiffies)
 	lw	$3,72($16)
+	sw	$7,56($16)
+	lw	$2,%lo(jiffies)($2)
 	lw	$4,76($16)
-	sw	$2,56($16)
-	lui	$2,%hi(jiffies)
-	lw	$2,%lo(jiffies)($2)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L263
+	beq	$3,$0,$L271
 	sw	$2,40($16)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L264
+	j	$L272
 	sw	$4,76($3)
 	.set	macro
 	.set	reorder
 
-$L263:
+$L271:
 	lui	$3,%hi(path_list_free)
 	addiu	$2,$3,%lo(path_list_free)
 	sw	$4,4($2)
-$L264:
+$L272:
 	lw	$4,76($16)
 	lw	$2,72($16)
 	lui	$3,%hi(path_list_free)
@@ -1284,19 +1295,19 @@
 	lui	$5,%hi(table_path)
 	sw	$2,76($16)
 	lw	$2,4($4)
-	sll	$3,$fp,1
-	addu	$3,$3,$fp
+	lw	$7,72($sp)
 	sw	$16,0($2)
 	lw	$2,8($4)
 	sw	$6,4($4)
-	sll	$3,$3,2
+	sll	$3,$7,1
 	addiu	$2,$2,1
 	sw	$2,8($4)
 	sw	$0,64($16)
 	lw	$2,%lo(table_path)($5)
+	addu	$3,$3,$7
+	sll	$3,$3,2
+	lw	$2,0($2)
 	addiu	$4,$16,64
-	lw	$2,0($2)
-	#nop
 	addu	$2,$3,$2
 	lw	$2,4($2)
 	#nop
@@ -1324,32 +1335,33 @@
 	#nop
 	addiu	$2,$2,1
 	sw	$2,8($3)
-$L227:
+$L235:
 	lw	$5,20($17)
 	lw	$6,12($17)
 	lw	$4,24($17)
 	srl	$2,$5,8
 	srl	$3,$6,16
+	xor	$3,$3,$6
 	xor	$2,$2,$5
-	xor	$3,$3,$6
 	lw	$5,16($17)
 	xor	$2,$2,$3
 	srl	$4,$4,4
 	xor	$2,$2,$4
-	lw	$3,72($sp)
 	xor	$2,$2,$5
-	lui	$5,%hi(path_table_list_max)
-	lw	$4,%lo(path_table_list_max)($5)
-	lui	$5,%hi(path_list_free)
-	xor	$2,$2,$3
-	lw	$16,%lo(path_list_free)($5)
+	lw	$5,76($sp)
+	lui	$3,%hi(path_table_list_max)
+	lw	$4,%lo(path_table_list_max)($3)
+	xor	$2,$2,$5
+	lui	$6,%hi(path_list_free)
 	srl	$3,$2,12
+	lw	$16,%lo(path_list_free)($6)
 	xor	$2,$2,$3
 	addiu	$4,$4,-1
+	and	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L268
-	and	$fp,$4,$2
+	beq	$16,$0,$L276
+	sw	$4,72($sp)
 	.set	macro
 	.set	reorder
 
@@ -1394,48 +1406,48 @@
 	sb	$2,0($16)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$3,$L269
+	beq	$4,$3,$L277
 	sb	$0,1($16)
 	.set	macro
 	.set	reorder
 
 	li	$2,4			# 0x4
 	sb	$2,1($16)
-$L269:
+$L277:
 	lw	$3,8($16)
 	lw	$2,36($16)
 	#nop
-	beq	$3,$2,$L270
+	beq	$3,$2,$L278
 	lbu	$2,1($16)
 	#nop
 	ori	$2,$2,0x8
 	sb	$2,1($16)
-$L270:
+$L278:
 	sw	$0,48($16)
 	sw	$0,52($16)
 	lw	$2,20($17)
 	addiu	$19,$sp,40
 	move	$4,$19
-	sw	$2,12($20)
+	sw	$2,12($21)
 	lw	$2,24($17)
 	move	$5,$0
 	li	$6,14			# 0xe
-	sh	$2,0($23)
+	sh	$2,0($22)
 	lw	$2,12($17)
 	#nop
-	sw	$2,16($20)
+	sw	$2,16($21)
 	lw	$2,16($17)
 	.set	noreorder
 	.set	nomacro
 	jal	memset
-	sh	$2,2($23)
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$22,$0,$L271
-	move	$5,$22
+	beq	$fp,$0,$L279
+	move	$5,$fp
 	.set	macro
 	.set	reorder
 
@@ -1449,7 +1461,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L271
+	bne	$2,$0,$L279
 	addiu	$5,$sp,56
 	.set	macro
 	.set	reorder
@@ -1463,21 +1475,21 @@
 	.set	macro
 	.set	reorder
 
-	bne	$2,$0,$L272
+	bne	$2,$0,$L280
 	lw	$3,160($18)
 	#nop
-	beq	$3,$0,$L272
+	beq	$3,$0,$L280
 	lbu	$2,12($3)
 	lbu	$3,13($3)
 	sll	$2,$2,8
 	or	$3,$3,$2
 	li	$2,2048			# 0x800
-	beq	$3,$2,$L272
+	beq	$3,$2,$L280
 	lw	$2,176($18)
 	#nop
 	addiu	$2,$2,-22
 	sw	$2,160($18)
-$L272:
+$L280:
 	lw	$4,160($18)
 	move	$5,$19
 	li	$6,6			# 0x6
@@ -1489,7 +1501,7 @@
 	.set	reorder
 
 	lw	$4,160($18)
-	addiu	$5,$22,320
+	addiu	$5,$fp,320
 	.set	noreorder
 	.set	nomacro
 	jal	memcpy
@@ -1497,13 +1509,13 @@
 	.set	macro
 	.set	reorder
 
-$L271:
+$L279:
 	sw	$0,144($18)
-	lw	$3,100($sp)
+	lw	$7,100($sp)
 	li	$2,2048			# 0x800
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L281
+	bne	$7,$2,$L289
 	lui	$2,%hi(nf_hooks+128)
 	.set	macro
 	.set	reorder
@@ -1512,7 +1524,7 @@
 	addiu	$2,$2,%lo(nf_hooks+128)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L281
+	beq	$3,$2,$L289
 	lui	$2,%hi(init_net+236)
 	.set	macro
 	.set	reorder
@@ -1520,8 +1532,8 @@
 	lw	$2,%lo(init_net+236)($2)
 	move	$4,$18
 	move	$5,$0
-	move	$6,$22
-	move	$7,$21
+	move	$6,$fp
+	move	$7,$23
 	.set	noreorder
 	.set	nomacro
 	jal	ipt_do_table
@@ -1529,7 +1541,7 @@
 	.set	macro
 	.set	reorder
 
-$L281:
+$L289:
 	lw	$2,144($18)
 	addiu	$19,$sp,40
 	move	$4,$19
@@ -1537,25 +1549,25 @@
 	lw	$2,20($17)
 	move	$5,$0
 	li	$6,14			# 0xe
-	sw	$2,12($20)
+	sw	$2,12($21)
 	lw	$2,24($17)
 	#nop
-	sh	$2,0($23)
+	sh	$2,0($22)
 	lw	$2,4($17)
 	#nop
-	sw	$2,16($20)
+	sw	$2,16($21)
 	lw	$2,8($17)
 	.set	noreorder
 	.set	nomacro
 	jal	memset
-	sh	$2,2($23)
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$0,$L286
-	move	$5,$21
+	beq	$23,$0,$L294
+	move	$5,$23
 	.set	macro
 	.set	reorder
 
@@ -1569,7 +1581,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L286
+	bne	$2,$0,$L294
 	addiu	$5,$sp,56
 	.set	macro
 	.set	reorder
@@ -1583,21 +1595,21 @@
 	.set	macro
 	.set	reorder
 
-	bne	$2,$0,$L287
+	bne	$2,$0,$L295
 	lw	$3,160($18)
 	#nop
-	beq	$3,$0,$L287
+	beq	$3,$0,$L295
 	lbu	$2,12($3)
 	lbu	$3,13($3)
 	sll	$2,$2,8
 	or	$3,$3,$2
 	li	$2,2048			# 0x800
-	beq	$3,$2,$L287
+	beq	$3,$2,$L295
 	lw	$2,176($18)
 	#nop
 	addiu	$2,$2,-22
 	sw	$2,160($18)
-$L287:
+$L295:
 	lw	$4,160($18)
 	move	$5,$19
 	.set	noreorder
@@ -1608,7 +1620,7 @@
 	.set	reorder
 
 	lw	$4,160($18)
-	addiu	$5,$21,320
+	addiu	$5,$23,320
 	li	$6,6			# 0x6
 	.set	noreorder
 	.set	nomacro
@@ -1617,13 +1629,13 @@
 	.set	macro
 	.set	reorder
 
-$L286:
+$L294:
 	sw	$0,144($18)
-	lw	$5,100($sp)
+	lw	$3,100($sp)
 	li	$2,2048			# 0x800
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$2,$L296
+	bne	$3,$2,$L304
 	lui	$2,%hi(nf_hooks+160)
 	.set	macro
 	.set	reorder
@@ -1632,7 +1644,7 @@
 	addiu	$2,$2,%lo(nf_hooks+160)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L296
+	beq	$3,$2,$L304
 	lui	$2,%hi(init_net+236)
 	.set	macro
 	.set	reorder
@@ -1640,8 +1652,8 @@
 	lw	$2,%lo(init_net+236)($2)
 	move	$4,$18
 	li	$5,4			# 0x4
-	move	$6,$22
-	move	$7,$21
+	move	$6,$fp
+	move	$7,$23
 	.set	noreorder
 	.set	nomacro
 	jal	ipt_do_table
@@ -1649,15 +1661,15 @@
 	.set	macro
 	.set	reorder
 
-$L296:
+$L304:
 	lw	$2,144($18)
 	#nop
 	sw	$2,52($16)
-	lw	$3,72($sp)
+	lw	$4,76($sp)
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L301
+	bne	$4,$2,$L309
 	lui	$2,%hi(nf_ct_udp_timeout_stream)
 	.set	macro
 	.set	reorder
@@ -1668,41 +1680,41 @@
 	jal	tcp_get_timeouts_by_state
 	.set	noreorder
 	.set	nomacro
-	j	$L342
+	j	$L349
 	sw	$2,60($16)
 	.set	macro
 	.set	reorder
 
-$L301:
+$L309:
 	lw	$2,%lo(nf_ct_udp_timeout_stream)($2)
 	#nop
 	sw	$2,60($16)
-$L342:
-	lw	$2,160($sp)
+$L349:
+	lw	$6,160($sp)
+	lui	$2,%hi(jiffies)
 	lw	$3,72($16)
+	sw	$6,56($16)
+	lw	$2,%lo(jiffies)($2)
 	lw	$4,76($16)
-	sw	$2,56($16)
-	lui	$2,%hi(jiffies)
-	lw	$2,%lo(jiffies)($2)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L304
+	beq	$3,$0,$L312
 	sw	$2,40($16)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L305
+	j	$L313
 	sw	$4,76($3)
 	.set	macro
 	.set	reorder
 
-$L304:
-	lui	$3,%hi(path_list_free)
-	addiu	$2,$3,%lo(path_list_free)
+$L312:
+	lui	$7,%hi(path_list_free)
+	addiu	$2,$7,%lo(path_list_free)
 	sw	$4,4($2)
-$L305:
+$L313:
 	lw	$4,76($16)
 	lw	$2,72($16)
 	lui	$3,%hi(path_list_free)
@@ -1719,19 +1731,19 @@
 	lui	$5,%hi(table_path)
 	sw	$2,76($16)
 	lw	$2,4($4)
-	sll	$3,$fp,1
-	addu	$3,$3,$fp
+	lw	$7,72($sp)
 	sw	$16,0($2)
 	lw	$2,8($4)
 	sw	$6,4($4)
-	sll	$3,$3,2
+	sll	$3,$7,1
 	addiu	$2,$2,1
 	sw	$2,8($4)
 	sw	$0,64($16)
 	lw	$2,%lo(table_path)($5)
+	addu	$3,$3,$7
+	sll	$3,$3,2
+	lw	$2,0($2)
 	addiu	$4,$16,64
-	lw	$2,0($2)
-	#nop
 	addu	$2,$3,$2
 	lw	$2,4($2)
 	#nop
@@ -1759,7 +1771,7 @@
 	#nop
 	addiu	$2,$2,1
 	sw	$2,8($3)
-$L268:
+$L276:
 	lw	$4,160($18)
 	addiu	$5,$sp,24
 	li	$6,6			# 0x6
@@ -1779,70 +1791,54 @@
 	.set	macro
 	.set	reorder
 
-	lw	$5,104($sp)
+	lw	$2,104($sp)
 	#nop
-	sw	$5,144($18)
-	lw	$2,80($sp)
+	sw	$2,144($18)
+	lw	$3,80($sp)
 	#nop
-	sw	$2,12($20)
-	lw	$3,88($sp)
+	sw	$3,12($21)
+	lw	$4,88($sp)
 	#nop
-	sh	$3,0($23)
+	sh	$4,0($22)
 	lw	$5,84($sp)
 	#nop
-	sw	$5,16($20)
-	lw	$2,92($sp)
+	sw	$5,16($21)
+	lw	$6,92($sp)
 	#nop
-	sh	$2,2($23)
-	lw	$3,96($sp)
+	sh	$6,2($22)
+	lw	$7,96($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$0,$L312
-	sw	$3,28($18)
+	beq	$23,$0,$L320
+	sw	$7,28($18)
 	.set	macro
 	.set	reorder
 
 #APP
 	raw_local_irq_save	$3
 #NO_APP
-	lw	$2,452($21)
+	lw	$2,452($23)
 	#nop
 	addiu	$2,$2,-1
-	sw	$2,452($21)
+	sw	$2,452($23)
 #APP
 	raw_local_irq_restore	$3
 #NO_APP
-$L312:
-	beq	$22,$0,$L316
+$L320:
+	beq	$fp,$0,$L324
 #APP
 	raw_local_irq_save	$3
 #NO_APP
-	lw	$2,452($22)
+	lw	$2,452($fp)
 	#nop
 	addiu	$2,$2,-1
-	sw	$2,452($22)
+	sw	$2,452($fp)
 #APP
 	raw_local_irq_restore	$3
 #NO_APP
-$L316:
-	lw	$5,76($sp)
-	#nop
-	xori	$2,$5,0x1
-	andi	$2,$2,0x1
-	beq	$2,$0,$L321
-	.set	noreorder
-	.set	nomacro
-	j	$L340
-	move	$2,$5
-	.set	macro
-	.set	reorder
-
-$L321:
-	lw	$2,76($sp)
-	#nop
-$L340:
+$L324:
 #APP
-	raw_local_irq_restore	$2
+	raw_local_irq_restore	$20
 #NO_APP
 	.set	noreorder
 	.set	nomacro
@@ -1852,27 +1848,11 @@
 	.set	reorder
 
 $L214:
-	lw	$3,76($sp)
-	#nop
-	xori	$2,$3,0x1
-	andi	$2,$2,0x1
-	beq	$2,$0,$L328
-	.set	noreorder
-	.set	nomacro
-	j	$L339
-	move	$2,$3
-	.set	macro
-	.set	reorder
-
-$L328:
-	lw	$2,76($sp)
-	#nop
-$L339:
 #APP
-	raw_local_irq_restore	$2
+	raw_local_irq_restore	$20
 #NO_APP
 	li	$2,-1			# 0xffffffffffffffff
-$L326:
+$L334:
 $L204:
 	lw	$31,148($sp)
 	lw	$fp,144($sp)
@@ -1952,7 +1932,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L398
+	beq	$6,$0,$L405
 	lui	$2,%hi(napt_list_inuse)
 	.set	macro
 	.set	reorder
@@ -1961,55 +1941,55 @@
 	lui	$2,%hi(napt_list_free)
 	addiu	$8,$2,%lo(napt_list_free)
 	lui	$24,%hi(path_list_inuse)
-$L390:
+$L397:
 	lw	$2,4($6)
 	#nop
-	bne	$2,$22,$L349
+	bne	$2,$22,$L356
 	lw	$2,8($6)
 	#nop
-	bne	$2,$21,$L349
+	bne	$2,$21,$L356
 	lw	$2,12($6)
 	#nop
-	bne	$2,$20,$L349
+	bne	$2,$20,$L356
 	lw	$3,16($6)
 	lw	$2,12($16)
 	#nop
-	bne	$3,$2,$L349
+	bne	$3,$2,$L356
 	lw	$3,20($6)
 	lw	$2,16($16)
 	#nop
-	bne	$3,$2,$L349
+	bne	$3,$2,$L356
 	lw	$2,24($6)
 	#nop
-	bne	$2,$19,$L349
+	bne	$2,$19,$L356
 	lw	$2,28($6)
 	#nop
-	bne	$2,$18,$L349
+	bne	$2,$18,$L356
 	lw	$2,36($6)
 	sb	$0,0($6)
 	lw	$4,40($6)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L352
+	beq	$2,$0,$L359
 	addu	$3,$5,$7
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L353
+	j	$L360
 	sw	$4,40($2)
 	.set	macro
 	.set	reorder
 
-$L352:
+$L359:
 	lw	$2,%lo(table_napt)($10)
 	sll	$3,$3,2
 	lw	$2,0($2)
 	#nop
 	addu	$3,$3,$2
 	sw	$4,4($3)
-$L353:
+$L360:
 	lw	$2,36($6)
 	lw	$4,40($6)
 	sll	$3,$7,1
@@ -2027,17 +2007,17 @@
 	sw	$2,8($3)
 	lw	$2,44($6)
 	lw	$3,48($6)
-	beq	$2,$0,$L355
+	beq	$2,$0,$L362
 	.set	noreorder
 	.set	nomacro
-	j	$L356
+	j	$L363
 	sw	$3,48($2)
 	.set	macro
 	.set	reorder
 
-$L355:
+$L362:
 	sw	$3,4($9)
-$L356:
+$L363:
 	lw	$3,48($6)
 	lw	$2,44($6)
 	addiu	$4,$6,44
@@ -2086,7 +2066,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L360
+	beq	$6,$0,$L367
 	move	$5,$2
 	.set	macro
 	.set	reorder
@@ -2097,53 +2077,53 @@
 	addiu	$10,$24,%lo(path_list_inuse)
 	li	$14,1			# 0x1
 	move	$15,$13
-$L370:
+$L377:
 	lw	$3,4($6)
 	lw	$2,0($16)
 	#nop
-	bne	$3,$2,$L361
+	bne	$3,$2,$L368
 	lbu	$2,2($6)
 	#nop
-	bne	$2,$14,$L361
+	bne	$2,$14,$L368
 	lw	$2,16($6)
 	#nop
-	bne	$2,$9,$L361
+	bne	$2,$9,$L368
 	lw	$2,12($6)
 	#nop
-	bne	$2,$12,$L361
+	bne	$2,$12,$L368
 	lw	$3,24($6)
 	lw	$2,12($16)
 	#nop
-	bne	$3,$2,$L361
+	bne	$3,$2,$L368
 	lw	$3,28($6)
 	lw	$2,16($16)
 	#nop
-	bne	$3,$2,$L361
+	bne	$3,$2,$L368
 	lw	$2,20($6)
 	#nop
-	bne	$2,$8,$L361
+	bne	$2,$8,$L368
 	lw	$2,8($6)
 	#nop
-	bne	$2,$11,$L361
+	bne	$2,$11,$L368
 	lw	$2,64($6)
 	sb	$0,0($6)
 	lw	$3,68($6)
-	beq	$2,$0,$L364
+	beq	$2,$0,$L371
 	.set	noreorder
 	.set	nomacro
-	j	$L365
+	j	$L372
 	sw	$3,68($2)
 	.set	macro
 	.set	reorder
 
-$L364:
+$L371:
 	lw	$2,%lo(table_path)($13)
 	#nop
 	lw	$2,0($2)
 	#nop
 	addu	$2,$5,$2
 	sw	$3,4($2)
-$L365:
+$L372:
 	lw	$3,68($6)
 	lw	$2,64($6)
 	#nop
@@ -2159,17 +2139,17 @@
 	sw	$2,8($3)
 	lw	$3,72($6)
 	lw	$2,76($6)
-	beq	$3,$0,$L367
+	beq	$3,$0,$L374
 	.set	noreorder
 	.set	nomacro
-	j	$L368
+	j	$L375
 	sw	$2,76($3)
 	.set	macro
 	.set	reorder
 
-$L367:
+$L374:
 	sw	$2,4($10)
-$L368:
+$L375:
 	lw	$2,72($6)
 	lw	$3,76($6)
 	addiu	$4,$6,72
@@ -2190,16 +2170,16 @@
 	addiu	$2,$2,1
 	.set	noreorder
 	.set	nomacro
-	j	$L360
+	j	$L367
 	sw	$2,8($7)
 	.set	macro
 	.set	reorder
 
-$L361:
+$L368:
 	lw	$6,64($6)
 	#nop
-	bne	$6,$0,$L370
-$L360:
+	bne	$6,$0,$L377
+$L367:
 	lw	$9,20($16)
 	lw	$8,12($16)
 	lw	$13,24($16)
@@ -2227,7 +2207,7 @@
 	addu	$3,$2,$3
 	lw	$6,0($3)
 	#nop
-	beq	$6,$0,$L373
+	beq	$6,$0,$L380
 	move	$5,$2
 	lui	$2,%hi(path_list_free)
 	addiu	$11,$24,%lo(path_list_inuse)
@@ -2235,53 +2215,53 @@
 	move	$4,$5
 	li	$14,2			# 0x2
 	move	$15,$10
-$L383:
+$L390:
 	lw	$3,4($6)
 	lw	$2,0($16)
 	#nop
-	bne	$3,$2,$L374
+	bne	$3,$2,$L381
 	lbu	$2,2($6)
 	#nop
-	bne	$2,$14,$L374
+	bne	$2,$14,$L381
 	lw	$2,20($6)
 	#nop
-	bne	$2,$8,$L374
+	bne	$2,$8,$L381
 	lw	$2,8($6)
 	#nop
-	bne	$2,$12,$L374
+	bne	$2,$12,$L381
 	lw	$2,24($6)
 	#nop
-	bne	$2,$9,$L374
+	bne	$2,$9,$L381
 	lw	$2,28($6)
 	#nop
-	bne	$2,$13,$L374
+	bne	$2,$13,$L381
 	lw	$3,32($6)
 	lw	$2,4($16)
 	#nop
-	bne	$3,$2,$L374
+	bne	$3,$2,$L381
 	lw	$3,36($6)
 	lw	$2,8($16)
 	#nop
-	bne	$3,$2,$L374
+	bne	$3,$2,$L381
 	lw	$2,64($6)
 	sb	$0,0($6)
 	lw	$3,68($6)
-	beq	$2,$0,$L377
+	beq	$2,$0,$L384
 	.set	noreorder
 	.set	nomacro
-	j	$L378
+	j	$L385
 	sw	$3,68($2)
 	.set	macro
 	.set	reorder
 
-$L377:
+$L384:
 	lw	$2,%lo(table_path)($10)
 	#nop
 	lw	$2,0($2)
 	#nop
 	addu	$2,$5,$2
 	sw	$3,4($2)
-$L378:
+$L385:
 	lw	$3,68($6)
 	lw	$2,64($6)
 	#nop
@@ -2297,17 +2277,17 @@
 	sw	$2,8($3)
 	lw	$3,72($6)
 	lw	$2,76($6)
-	beq	$3,$0,$L380
+	beq	$3,$0,$L387
 	.set	noreorder
 	.set	nomacro
-	j	$L381
+	j	$L388
 	sw	$2,76($3)
 	.set	macro
 	.set	reorder
 
-$L380:
+$L387:
 	sw	$2,4($11)
-$L381:
+$L388:
 	lw	$2,72($6)
 	lw	$3,76($6)
 	addiu	$4,$6,72
@@ -2328,36 +2308,36 @@
 	addiu	$2,$2,1
 	.set	noreorder
 	.set	nomacro
-	j	$L373
+	j	$L380
 	sw	$2,8($7)
 	.set	macro
 	.set	reorder
 
-$L374:
+$L381:
 	lw	$6,64($6)
 	#nop
-	bne	$6,$0,$L383
-$L373:
+	bne	$6,$0,$L390
+$L380:
 #APP
 	raw_local_irq_restore	$17
 #NO_APP
 	.set	noreorder
 	.set	nomacro
-	j	$L343
+	j	$L350
 	move	$2,$0
 	.set	macro
 	.set	reorder
 
-$L349:
+$L356:
 	lw	$6,36($6)
 	#nop
-	bne	$6,$0,$L390
-$L398:
+	bne	$6,$0,$L397
+$L405:
 #APP
 	raw_local_irq_restore	$17
 #NO_APP
 	li	$2,-4			# 0xfffffffffffffffc
-$L343:
+$L350:
 	lw	$31,56($sp)
 	lw	$23,52($sp)
 	lw	$22,48($sp)
@@ -2426,72 +2406,72 @@
 	lui	$2,%hi(jiffies)
 	move	$13,$5
 	lw	$14,%lo(jiffies)($2)
-	beq	$4,$0,$L406
+	beq	$4,$0,$L413
 	li	$2,-16777216			# 0xffffffffff000000
 
 	ori	$24,$2,0x100
 	ori	$5,$2,0xff00
 	subu	$6,$14,$13
-$L410:
+$L417:
 	lw	$2,4($4)
 	nop
-	bne	$2,$12,$L407
+	bne	$2,$12,$L414
 	nop
 
 	lw	$2,0($4)
 	nop
 	and	$2,$2,$5
-	bne	$2,$24,$L407
+	bne	$2,$24,$L414
 	nop
 
 	lw	$2,16($4)
 	nop
-	bne	$2,$9,$L407
+	bne	$2,$9,$L414
 	nop
 
 	lw	$2,12($4)
 	nop
-	bne	$2,$15,$L407
+	bne	$2,$15,$L414
 	nop
 
 	lw	$3,24($4)
 	lw	$2,12($7)
 	nop
-	bne	$3,$2,$L407
+	bne	$3,$2,$L414
 	nop
 
 	lw	$3,28($4)
 	lw	$2,16($7)
 	nop
-	bne	$3,$2,$L407
+	bne	$3,$2,$L414
 	nop
 
 	lw	$2,20($4)
 	nop
-	bne	$2,$8,$L407
+	bne	$2,$8,$L414
 	nop
 
 	lw	$2,8($4)
 	nop
-	bne	$2,$11,$L407
+	bne	$2,$11,$L414
 	nop
 
 	lw	$5,40($4)
 	nop
 	subu	$2,$6,$5
-	bgez	$2,$L406
+	bgez	$2,$L413
 	nop
 
-	j	$L420
+	j	$L427
 	nop
 
-$L407:
+$L414:
 	lw	$4,64($4)
 	nop
-	bne	$4,$0,$L410
+	bne	$4,$0,$L417
 	nop
 
-$L406:
+$L413:
 	lw	$8,20($7)
 	lw	$6,12($7)
 	lw	$12,24($7)
@@ -2518,79 +2498,79 @@
 	addu	$2,$2,$3
 	lw	$4,0($2)
 	nop
-	beq	$4,$0,$L413
+	beq	$4,$0,$L420
 	li	$2,-16777216			# 0xffffffffff000000
 
 	ori	$10,$2,0x200
 	subu	$9,$14,$13
 	ori	$5,$2,0xff00
-$L417:
+$L424:
 	lw	$3,4($4)
 	lw	$2,0($7)
 	nop
-	bne	$3,$2,$L414
+	bne	$3,$2,$L421
 	nop
 
 	lw	$2,0($4)
 	nop
 	and	$2,$2,$5
-	bne	$2,$10,$L414
+	bne	$2,$10,$L421
 	nop
 
 	lw	$2,20($4)
 	nop
-	bne	$2,$6,$L414
+	bne	$2,$6,$L421
 	nop
 
 	lw	$2,8($4)
 	nop
-	bne	$2,$11,$L414
+	bne	$2,$11,$L421
 	nop
 
 	lw	$2,24($4)
 	nop
-	bne	$2,$8,$L414
+	bne	$2,$8,$L421
 	nop
 
 	lw	$2,28($4)
 	nop
-	bne	$2,$12,$L414
+	bne	$2,$12,$L421
 	nop
 
 	lw	$3,32($4)
 	lw	$2,4($7)
 	nop
-	bne	$3,$2,$L414
+	bne	$3,$2,$L421
 	nop
 
 	lw	$3,36($4)
 	lw	$2,8($7)
 	nop
-	bne	$3,$2,$L414
+	bne	$3,$2,$L421
 	nop
 
 	lw	$5,40($4)
 	nop
 	subu	$2,$9,$5
-	bgez	$2,$L413
+	bgez	$2,$L420
 	nop
 
-$L420:
+$L427:
 	lw	$3,56($4)
 	addu	$2,$5,$13
 	li	$4,-1			# 0xffffffffffffffff
-	j	$L401
+	j	$L408
 	sw	$2,116($3)
 
-$L414:
+$L421:
 	lw	$4,64($4)
 	nop
-	bne	$4,$0,$L417
+	bne	$4,$0,$L424
 	nop
 
-$L413:
+$L420:
 	move	$4,$0
-$L401:
+$L408:
 	lw	$16,0($sp)
 	move	$2,$4
 	j	$31
@@ -2621,35 +2601,35 @@
 	lui	$2,%hi(jiffies)
 	lw	$18,%lo(jiffies)($2)
 	li	$2,17			# 0x11
-	bne	$3,$2,$L422
+	bne	$3,$2,$L429
 	move	$16,$4
 
 	lw	$2,100($4)
 	nop
 	andi	$2,$2,0x2
-	beq	$2,$0,$L423
+	beq	$2,$0,$L430
 	li	$11,1			# 0x1
 
 	lui	$2,%hi(nf_ct_udp_timeout_stream)
 	lw	$17,%lo(nf_ct_udp_timeout_stream)($2)
-	j	$L425
+	j	$L432
 	nop
 
-$L423:
+$L430:
 	lui	$2,%hi(nf_ct_udp_timeout)
 	lw	$17,%lo(nf_ct_udp_timeout)($2)
-	j	$L425
+	j	$L432
 	nop
 
-$L422:
+$L429:
 	li	$2,6			# 0x6
-	bne	$3,$2,$L421
+	bne	$3,$2,$L428
 	li	$2,-1			# 0xffffffffffffffff
 
 	lbu	$4,176($4)
 	nop
 	sltu	$2,$4,6
-	beq	$2,$0,$L421
+	beq	$2,$0,$L428
 	li	$2,-1			# 0xffffffffffffffff
 
 	jal	tcp_get_timeouts_by_state
@@ -2657,12 +2637,12 @@
 
 	move	$17,$2
 	li	$11,2			# 0x2
-$L425:
+$L432:
 	lw	$10,12($16)
 	lw	$8,80($16)
 	lw	$9,60($16)
 	lw	$7,32($16)
-	bne	$10,$8,$L428
+	bne	$10,$8,$L435
 	addiu	$4,$sp,16
 
 	lhu	$2,76($16)
@@ -2674,11 +2654,11 @@
 	sw	$2,24($sp)
 	sw	$7,28($sp)
 	sw	$3,32($sp)
-	j	$L436
+	j	$L443
 	sw	$8,36($sp)
 
-$L428:
-	bne	$7,$9,$L421
+$L435:
+	bne	$7,$9,$L428
 	li	$2,-1			# 0xffffffffffffffff
 
 	lhu	$2,28($16)
@@ -2692,22 +2672,22 @@
 	sw	$8,28($sp)
 	sw	$3,32($sp)
 	sw	$7,36($sp)
-$L436:
+$L443:
 	jal	rtk_idleNaptConnection
 	sw	$6,40($sp)
 
-	beq	$2,$0,$L433
+	beq	$2,$0,$L440
 	addu	$5,$18,$17
 
 	jal	rtl_check_for_acc
 	move	$4,$16
 
-	j	$L421
+	j	$L428
 	move	$2,$0
 
-$L433:
+$L440:
 	li	$2,-1			# 0xffffffffffffffff
-$L421:
+$L428:
 	lw	$31,60($sp)
 	lw	$18,56($sp)
 	lw	$17,52($sp)
@@ -2743,52 +2723,52 @@
 
 	move	$3,$2
 	li	$2,300			# 0x12c
-	beq	$3,$2,$L440
+	beq	$3,$2,$L447
 	lui	$2,%hi(jiffies)
 
 	sltu	$2,$3,301
-	beq	$2,$0,$L443
+	beq	$2,$0,$L450
 	li	$2,450			# 0x1c2
 
 	li	$2,150			# 0x96
-	beq	$3,$2,$L441
+	beq	$3,$2,$L448
 	lui	$2,%hi(jiffies)
 
-	j	$L438
+	j	$L445
 	nop
 
-$L443:
-	bne	$3,$2,$L438
+$L450:
+	bne	$3,$2,$L445
 	lui	$2,%hi(jiffies)
 
 	lw	$2,%lo(jiffies)($2)
-	j	$L438
+	j	$L445
 	sw	$2,24($16)
 
-$L440:
+$L447:
 	lw	$2,%lo(jiffies)($2)
-	j	$L448
+	j	$L455
 	addiu	$2,$2,-15000
 
-$L441:
+$L448:
 	lw	$2,%lo(jiffies)($2)
 	nop
 	addiu	$2,$2,-30000
-$L448:
+$L455:
 	sw	$2,24($16)
-$L438:
+$L445:
 	lbu	$2,1112($17)
 	nop
-	beq	$2,$0,$L445
+	beq	$2,$0,$L452
 	nop
 
 	lw	$5,1080($17)
-	j	$L447
+	j	$L454
 	nop
 
-$L445:
+$L452:
 	lw	$5,1088($17)
-$L447:
+$L454:
 	lw	$2,24($16)
 	lui	$3,%hi(jiffies)
 	lw	$3,%lo(jiffies)($3)
@@ -2846,63 +2826,63 @@
 	addu	$2,$2,$3
 	lw	$4,0($2)
 	nop
-	beq	$4,$0,$L472
+	beq	$4,$0,$L479
 	nop
 
 	li	$3,255			# 0xff
-$L457:
+$L464:
 	lw	$2,12($4)
 	nop
-	bne	$2,$10,$L453
+	bne	$2,$10,$L460
 	nop
 
 	lw	$2,8($4)
 	nop
-	bne	$2,$7,$L453
+	bne	$2,$7,$L460
 	nop
 
 	lw	$2,16($4)
 	nop
-	bne	$2,$11,$L453
+	bne	$2,$11,$L460
 	nop
 
 	lw	$2,20($4)
 	nop
-	bne	$2,$6,$L453
+	bne	$2,$6,$L460
 	nop
 
 	lbu	$2,0($4)
 	nop
-	bne	$2,$3,$L453
+	bne	$2,$3,$L460
 	li	$2,1			# 0x1
 
 	lbu	$3,2($4)
 	nop
-	beq	$3,$2,$L470
+	beq	$3,$2,$L477
 	sb	$0,0($4)
 
 	lw	$5,32($4)
 	lhu	$8,38($4)
-	j	$L452
+	j	$L459
 	nop
 
-$L453:
+$L460:
 	lw	$4,64($4)
 	nop
-	bne	$4,$0,$L457
+	bne	$4,$0,$L464
 	nop
 
-$L473:
+$L480:
 	j	$31
 	nop
 
-$L452:
-	beq	$5,$0,$L473
+$L459:
+	beq	$5,$0,$L480
 	li	$2,1			# 0x1
 
 	lbu	$3,2($4)
 	nop
-	bne	$3,$2,$L459
+	bne	$3,$2,$L466
 	srl	$3,$11,16
 
 	srl	$2,$6,8
@@ -2912,16 +2892,16 @@
 	xor	$2,$2,$3
 	srl	$3,$7,4
 	xor	$2,$2,$3
-	j	$L471
+	j	$L478
 	xor	$2,$2,$8
 
-$L470:
+$L477:
 	lw	$5,24($4)
 	lhu	$8,30($4)
-	j	$L452
+	j	$L459
 	nop
 
-$L459:
+$L466:
 	srl	$2,$5,8
 	xor	$3,$3,$11
 	xor	$2,$2,$5
@@ -2929,7 +2909,7 @@
 	srl	$3,$8,4
 	xor	$2,$2,$3
 	xor	$2,$2,$10
-$L471:
+$L478:
 	lw	$4,%lo(path_table_list_max)($12)
 	xor	$2,$2,$9
 	srl	$3,$2,12
@@ -2944,44 +2924,44 @@
 	addu	$3,$3,$2
 	lw	$4,0($3)
 	nop
-	beq	$4,$0,$L472
+	beq	$4,$0,$L479
 	nop
 
 	li	$3,255			# 0xff
-$L467:
+$L474:
 	lw	$2,24($4)
 	nop
-	bne	$2,$6,$L465
+	bne	$2,$6,$L472
 	nop
 
 	lw	$2,28($4)
 	nop
-	bne	$2,$7,$L465
+	bne	$2,$7,$L472
 	nop
 
 	lw	$2,32($4)
 	nop
-	bne	$2,$11,$L465
+	bne	$2,$11,$L472
 	nop
 
 	lw	$2,36($4)
 	nop
-	bne	$2,$10,$L465
+	bne	$2,$10,$L472
 	nop
 
 	lbu	$2,0($4)
 	nop
-	bne	$2,$3,$L465
+	bne	$2,$3,$L472
 	nop
 
 	sb	$0,0($4)
-$L465:
+$L472:
 	lw	$4,64($4)
 	nop
-	bne	$4,$0,$L467
+	bne	$4,$0,$L474
 	nop
 
-$L472:
+$L479:
 	j	$31
 	nop
 
@@ -3056,55 +3036,57 @@
 	sw	$16,48($sp)
 	lw	$18,156($4)
 	li	$2,1			# 0x1
-	sw	$2,24($sp)
-	lbu	$20,9($18)
+	sw	$2,32($sp)
+	lbu	$19,9($18)
 	li	$2,6			# 0x6
-	move	$23,$4
-	sw	$0,28($sp)
-	sw	$0,32($sp)
+	move	$21,$4
+	sw	$0,36($sp)
+	sw	$0,40($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L478
-	move	$21,$0
+	beq	$19,$2,$L485
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$2,17			# 0x11
 	.set	noreorder
 	.set	nomacro
-	bne	$20,$2,$L475
+	bne	$19,$2,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-$L478:
+$L485:
 	lbu	$2,0($18)
 	move	$4,$18
-	move	$6,$23
+	move	$6,$21
 	andi	$2,$2,0xf
 	sll	$2,$2,2
-	addu	$fp,$18,$2
+	addu	$22,$18,$2
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_pre_process_check
-	move	$5,$fp
+	move	$5,$22
 	.set	macro
 	.set	reorder
 
 	move	$5,$2
 	move	$4,$2
 	li	$2,6			# 0x6
-	bne	$5,$2,$L475
-	lhu	$7,6($18)
-	lw	$19,12($18)
-	lw	$22,16($18)
-	andi	$6,$7,0xffff
-	lhu	$11,0($fp)
-	lhu	$12,2($fp)
-	lw	$3,24($23)
+	bne	$5,$2,$L482
+	lhu	$3,0($22)
+	lhu	$16,6($18)
+	lw	$20,12($18)
+	lw	$fp,16($18)
+	sw	$3,24($sp)
+	lhu	$4,2($22)
+	#nop
+	sw	$4,28($sp)
+	lw	$3,24($21)
 	.set	noreorder
 	.set	nomacro
-	bne	$20,$5,$L480
+	bne	$19,$5,$L487
 	lui	$4,%hi($LC0)
 	.set	macro
 	.set	reorder
@@ -3129,75 +3111,91 @@
 #NO_APP
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L475
+	beq	$3,$0,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	andi	$2,$6,0x3fff
+	andi	$2,$16,0x3fff
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L486
+	beq	$2,$0,$L493
 	li	$3,1			# 0x1
 	.set	macro
 	.set	reorder
 
-	xori	$2,$6,0x2000
+	xori	$2,$16,0x2000
 	sltu	$3,$2,1
-$L486:
+$L493:
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L650
-	andi	$2,$7,0x3fff
+	bne	$3,$2,$L494
+	li	$2,65536			# 0x10000
 	.set	macro
 	.set	reorder
 
-	lw	$3,12($fp)
-	li	$2,65536			# 0x10000
+	lw	$3,12($22)
+	#nop
 	and	$2,$3,$2
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L488
+	beq	$2,$0,$L495
 	li	$2,393216			# 0x60000
 	.set	macro
 	.set	reorder
 
-	move	$4,$19
-	move	$5,$11
-	move	$6,$22
-	move	$7,$12
+	lw	$5,24($sp)
+	lw	$7,28($sp)
+	move	$4,$20
+	move	$6,$fp
 	.set	noreorder
 	.set	nomacro
 	jal	mark_path_invalid
-	sw	$20,16($sp)
+	sw	$19,16($sp)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L475
+	j	$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-$L488:
+$L495:
 	and	$2,$3,$2
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L475
+	bne	$2,$0,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
+$L494:
+	lw	$2,12($22)
+	li	$3,1048576			# 0x100000
+	and	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L650
-	andi	$2,$7,0x3fff
+	beq	$2,$0,$L498
+	li	$2,40			# 0x28
 	.set	macro
 	.set	reorder
 
-$L480:
+	lhu	$3,2($18)
+	#nop
+	bne	$3,$2,$L498
+	move	$4,$21
+	.set	noreorder
+	.set	nomacro
+	jal	skb_trim
+	li	$5,40			# 0x28
+	.set	macro
+	.set	reorder
+
+	j	$L498
+$L487:
 	addiu	$2,$4,%lo($LC0)
 	move	$5,$3
 #APP
@@ -3218,58 +3216,61 @@
 #NO_APP
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L475
+	beq	$3,$0,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	andi	$2,$7,0x3fff
-$L650:
+$L498:
+	lhu	$2,6($18)
+	#nop
+	andi	$2,$2,0x3fff
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L652
-	srl	$3,$22,16
+	beq	$2,$0,$L501
+	li	$2,8192			# 0x2000
 	.set	macro
 	.set	reorder
 
-	li	$2,8192			# 0x2000
 	.set	noreorder
 	.set	nomacro
-	bne	$6,$2,$L494
-	andi	$2,$6,0x2000
+	bne	$16,$2,$L502
+	andi	$2,$16,0x2000
 	.set	macro
 	.set	reorder
 
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	j	$L495
-	sw	$2,28($sp)
+	j	$L503
+	sw	$2,36($sp)
 	.set	macro
 	.set	reorder
 
-$L494:
+$L502:
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L495
-	andi	$3,$6,0x1fff
+	bne	$2,$0,$L503
+	andi	$3,$16,0x1fff
 	.set	macro
 	.set	reorder
 
-	lw	$4,32($sp)
+	lw	$4,40($sp)
 	li	$2,1			# 0x1
 	movn	$4,$2,$3		#RLX4181/RLX4281:conditional move
-	sw	$4,32($sp)
-$L495:
+	sw	$4,40($sp)
+$L503:
+	lw	$9,12($18)
+	lw	$8,16($18)
 	lhu	$7,4($18)
-	xor	$3,$19,$22
+	andi	$6,$19,0x00ff
+	xor	$3,$9,$8
 	srl	$2,$3,16
 	xor	$2,$2,$7
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$5,%lo(max_udp_frag_entry)($2)
 	srl	$4,$3,8
-	andi	$6,$20,0x00ff
 	lui	$2,%hi(udp_cache_table)
 	xor	$4,$4,$6
 	lw	$2,%lo(udp_cache_table)($2)
@@ -3285,87 +3286,90 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L504
-	move	$21,$0
+	beq	$4,$0,$L512
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$3,1			# 0x1
-$L503:
+$L511:
 	lhu	$2,2($4)
 	#nop
-	bne	$2,$7,$L500
+	bne	$2,$7,$L508
 	lw	$2,4($4)
 	#nop
-	bne	$2,$19,$L500
+	bne	$2,$9,$L508
 	lw	$2,8($4)
 	#nop
-	bne	$2,$22,$L500
+	bne	$2,$8,$L508
 	lbu	$2,1($4)
 	#nop
-	bne	$2,$6,$L500
+	bne	$2,$6,$L508
 	lbu	$2,0($4)
 	#nop
-	beq	$2,$3,$L634
-$L500:
+	beq	$2,$3,$L642
+$L508:
 	lw	$4,40($4)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$4,$0,$L503
-	move	$21,$0
+	bne	$4,$0,$L511
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
-	j	$L504
-$L634:
+	j	$L512
+$L642:
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L504
-	move	$21,$4
+	beq	$4,$0,$L512
+	move	$23,$4
 	.set	macro
 	.set	reorder
 
-	lw	$5,28($sp)
-	lhu	$11,12($4)
-	lhu	$12,14($4)
+	lhu	$5,12($4)
+	lw	$3,36($sp)
+	sw	$5,24($sp)
+	lhu	$2,14($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$0,$L652
-	srl	$3,$22,16
+	bne	$3,$0,$L501
+	sw	$2,28($sp)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L652
-	sw	$0,24($sp)
+	j	$L501
+	sw	$0,32($sp)
 	.set	macro
 	.set	reorder
 
-$L504:
-	lw	$2,28($sp)
+$L512:
+	lw	$5,36($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L475
+	beq	$5,$0,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	srl	$3,$22,16
-$L652:
-	srl	$2,$19,8
-	sw	$3,36($sp)
-	xor	$2,$2,$19
-	xor	$3,$3,$22
+$L501:
+	lw	$4,24($sp)
+	srl	$3,$fp,16
+	srl	$2,$20,8
+	sw	$3,44($sp)
+	lw	$5,28($sp)
+	xor	$3,$3,$fp
+	xor	$2,$2,$20
 	xor	$2,$2,$3
-	srl	$3,$11,4
+	srl	$3,$4,4
 	xor	$2,$2,$3
 	lui	$3,%hi(path_table_list_max)
+	xor	$2,$2,$5
 	lw	$4,%lo(path_table_list_max)($3)
-	xor	$2,$2,$12
-	xor	$2,$2,$20
+	xor	$2,$2,$19
 	lui	$3,%hi(table_path)
 	lw	$5,%lo(table_path)($3)
 	srl	$3,$2,12
@@ -3379,28 +3383,30 @@
 	addu	$2,$2,$3
 	lw	$16,0($2)
 	#nop
-$L639:
+$L647:
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L633
+	beq	$16,$0,$L641
 	move	$4,$18
 	.set	macro
 	.set	reorder
 
 	lw	$2,12($16)
+	lw	$3,24($sp)
 	#nop
-	bne	$2,$11,$L511
+	bne	$2,$3,$L519
 	lw	$2,8($16)
+	lw	$4,28($sp)
 	#nop
-	bne	$2,$12,$L511
+	bne	$2,$4,$L519
 	lw	$2,16($16)
 	#nop
-	bne	$2,$19,$L511
+	bne	$2,$20,$L519
 	lw	$2,20($16)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$22,$L511
+	bne	$2,$fp,$L519
 	li	$2,255			# 0xff
 	.set	macro
 	.set	reorder
@@ -3409,7 +3415,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L511
+	bne	$3,$2,$L519
 	li	$2,2			# 0x2
 	.set	macro
 	.set	reorder
@@ -3418,7 +3424,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L653
+	bne	$3,$2,$L659
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
@@ -3426,28 +3432,26 @@
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L513
+	beq	$19,$2,$L521
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
 
-$L653:
+$L659:
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L511
+	bne	$3,$2,$L519
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L511
-$L513:
+	bne	$19,$2,$L519
+$L521:
 	lw	$5,32($16)
 	lbu	$7,1($18)
-	lw	$2,24($23)
-	move	$4,$23
-	move	$6,$19
-	sw	$11,40($sp)
-	sw	$12,44($sp)
+	lw	$2,24($21)
+	move	$4,$21
+	move	$6,$20
 	.set	noreorder
 	.set	nomacro
 	jal	ip_route_input
@@ -3455,53 +3459,51 @@
 	.set	macro
 	.set	reorder
 
-	lw	$11,40($sp)
-	lw	$12,44($sp)
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L475
+	bne	$2,$0,$L482
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	lw	$3,28($23)
+	lw	$3,28($21)
 	#nop
 	lw	$2,48($3)
 	#nop
-	bne	$2,$0,$L518
+	bne	$2,$0,$L526
 	lw	$2,44($3)
 	#nop
-	beq	$2,$0,$L646
-$L518:
+	beq	$2,$0,$L654
+$L526:
 	lw	$2,72($3)
-	lw	$3,84($23)
+	lw	$3,84($21)
 	#nop
 	sltu	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L646
+	bne	$2,$0,$L654
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$20,$2,$L522
-	addiu	$17,$fp,16
+	beq	$19,$2,$L530
+	addiu	$17,$22,16
 	.set	macro
 	.set	reorder
 
-	lhu	$3,6($fp)
-	addiu	$2,$fp,6
+	lhu	$3,6($22)
+	addiu	$2,$22,6
 	move	$17,$0
 	movn	$17,$2,$3		#RLX4181/RLX4281:conditional move  
-$L522:
-	lw	$4,28($sp)
+$L530:
+	lw	$5,36($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L525
-	xor	$3,$19,$22
+	beq	$5,$0,$L533
+	xor	$3,$20,$fp
 	.set	macro
 	.set	reorder
 
@@ -3511,34 +3513,36 @@
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$4,%lo(max_udp_frag_entry)($2)
-	lui	$9,%hi(udp_cache_list_free)
+	andi	$5,$19,0x00ff
 	srl	$2,$3,8
-	andi	$5,$20,0x00ff
-	lw	$8,%lo(udp_cache_list_free)($9)
 	xor	$2,$2,$5
 	xor	$3,$3,$2
 	addiu	$4,$4,-1
+	lui	$9,%hi(udp_cache_list_free)
 	and	$10,$3,$4
-	andi	$7,$12,0xffff
+	lw	$2,24($sp)
+	lw	$4,28($sp)
+	lw	$8,%lo(udp_cache_list_free)($9)
+	andi	$3,$2,0xffff
 	.set	noreorder
 	.set	nomacro
-	bne	$8,$0,$L528
-	andi	$3,$11,0xffff
+	bne	$8,$0,$L536
+	andi	$7,$4,0xffff
 	.set	macro
 	.set	reorder
 
-$L646:
-	lw	$4,28($23)
+$L654:
+	lw	$4,28($21)
 	jal	dst_release
 	move	$4,$0
 	.set	noreorder
 	.set	nomacro
-	j	$L475
-	sw	$0,28($23)
+	j	$L482
+	sw	$0,28($21)
 	.set	macro
 	.set	reorder
 
-$L528:
+$L536:
 	lw	$4,48($8)
 	li	$2,1
 	sh	$3,12($8)
@@ -3546,26 +3550,26 @@
 	sb	$5,1($8)
 	sh	$7,14($8)
 	sb	$2,0($8)
-	sw	$19,4($8)
-	sw	$22,8($8)
+	sw	$20,4($8)
+	sw	$fp,8($8)
 	lw	$3,52($8)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L531
+	beq	$4,$0,$L539
 	addiu	$2,$9,%lo(udp_cache_list_free)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L532
+	j	$L540
 	sw	$3,52($4)
 	.set	macro
 	.set	reorder
 
-$L531:
+$L539:
 	sw	$3,4($2)
-$L532:
+$L540:
 	lw	$3,52($8)
 	lw	$2,48($8)
 	addiu	$4,$9,%lo(udp_cache_list_free)
@@ -3622,61 +3626,61 @@
 
 	.set	noreorder
 	.set	nomacro
-	j	$L651
-	move	$4,$23
+	j	$L658
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
-$L525:
-	lw	$5,32($sp)
+$L533:
+	lw	$5,40($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L651
-	move	$4,$23
+	beq	$5,$0,$L658
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
 	jal	del_timer
-	addiu	$4,$21,16
+	addiu	$4,$23,16
 	.set	macro
 	.set	reorder
 
-	lw	$2,8($21)
-	lw	$3,4($21)
-	lhu	$4,2($21)
-	lbu	$5,1($21)
+	lw	$2,8($23)
+	lw	$3,4($23)
+	lhu	$4,2($23)
+	lbu	$5,1($23)
 	xor	$3,$3,$2
 	srl	$2,$3,16
 	xor	$2,$2,$4
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$4,%lo(max_udp_frag_entry)($2)
-	lw	$6,40($21)
+	lw	$6,40($23)
 	srl	$2,$3,8
 	xor	$2,$2,$5
 	addiu	$4,$4,-1
 	xor	$3,$3,$2
 	and	$5,$3,$4
-	sb	$0,0($21)
-	lw	$4,44($21)
+	sb	$0,0($23)
+	lw	$4,44($23)
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L538
+	beq	$6,$0,$L546
 	lui	$2,%hi(udp_cache_table)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L539
+	j	$L547
 	sw	$4,44($6)
 	.set	macro
 	.set	reorder
 
-$L538:
+$L546:
 	lw	$3,%lo(udp_cache_table)($2)
 	sll	$2,$5,1
 	addu	$2,$2,$5
@@ -3684,9 +3688,9 @@
 	sll	$2,$2,2
 	addu	$2,$2,$3
 	sw	$4,4($2)
-$L539:
-	lw	$4,44($21)
-	lw	$2,40($21)
+$L547:
+	lw	$4,44($23)
+	lw	$2,40($23)
 	sll	$3,$5,1
 	addu	$3,$3,$5
 	sw	$2,0($4)
@@ -3696,74 +3700,74 @@
 	lui	$4,%hi(udp_cache_list_free)
 	lw	$2,0($2)
 	addiu	$4,$4,%lo(udp_cache_list_free)
-	addiu	$5,$21,48
+	addiu	$5,$23,48
 	addu	$3,$3,$2
 	lw	$2,8($3)
 	#nop
 	addiu	$2,$2,-1
 	sw	$2,8($3)
-	sw	$0,48($21)
+	sw	$0,48($23)
 	lw	$2,4($4)
 	#nop
-	sw	$2,52($21)
+	sw	$2,52($23)
 	lw	$2,4($4)
 	#nop
-	sw	$21,0($2)
+	sw	$23,0($2)
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
 	sw	$2,8($4)
-	move	$4,$23
-$L651:
+	move	$4,$21
+$L658:
 	move	$5,$18
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_before_nat_check
-	move	$6,$20
+	move	$6,$19
 	.set	macro
 	.set	reorder
 
 	move	$5,$2
 	move	$4,$2
 	li	$2,6			# 0x6
-	bne	$5,$2,$L475
+	bne	$5,$2,$L482
 	lbu	$3,1($16)
 	#nop
 	sltu	$2,$3,13
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L604
+	beq	$2,$0,$L612
 	sll	$2,$3,2
 	.set	macro
 	.set	reorder
 
-	lui	$3,%hi($L627)
-	addiu	$3,$3,%lo($L627)
+	lui	$3,%hi($L635)
+	addiu	$3,$3,%lo($L635)
 	addu	$2,$2,$3
 	lw	$2,0($2)
 	#nop
 	j	$2
 	.rdata
 	.align	2
-$L627:
-	.word	$L544
-	.word	$L546
-	.word	$L561
-	.word	$L561
-	.word	$L575
-	.word	$L604
-	.word	$L604
-	.word	$L604
-	.word	$L590
-	.word	$L604
-	.word	$L604
-	.word	$L604
-	.word	$L590
+$L635:
+	.word	$L552
+	.word	$L554
+	.word	$L569
+	.word	$L569
+	.word	$L583
+	.word	$L612
+	.word	$L612
+	.word	$L612
+	.word	$L598
+	.word	$L612
+	.word	$L612
+	.word	$L612
+	.word	$L598
 	.section	.text.enter_fast_path
-$L546:
+$L554:
 	lw	$2,24($16)
-	srl	$3,$19,16
-	andi	$6,$19,0xffff
+	srl	$3,$20,16
+	andi	$6,$20,0xffff
 	addu	$6,$6,$3
 	lhu	$4,10($18)
 	andi	$3,$2,0xffff
@@ -3773,7 +3777,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L548
+	bgez	$6,$L556
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3787,32 +3791,32 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L547
+	j	$L555
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L548:
+$L556:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L547:
-	lw	$2,24($sp)
+$L555:
+	lw	$2,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L565
+	beq	$2,$0,$L573
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L551
-	beq	$17,$0,$L565
+	bne	$19,$2,$L559
+	beq	$17,$0,$L573
 	lhu	$6,0($17)
 	#nop
-	beq	$6,$0,$L565
+	beq	$6,$0,$L573
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3825,7 +3829,7 @@
 	addu	$5,$5,$6
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L554
+	bgez	$5,$L562
 	sra	$3,$5,16
 	.set	macro
 	.set	reorder
@@ -3838,24 +3842,24 @@
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L640
+	j	$L648
 	nor	$2,$0,$5
 	.set	macro
 	.set	reorder
 
-$L554:
+$L562:
 	andi	$2,$5,0xffff
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L565
+	j	$L573
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L551:
+$L559:
 	lw	$4,12($18)
 	lw	$3,24($16)
 	lhu	$5,0($17)
@@ -3869,7 +3873,7 @@
 	addu	$4,$4,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L558
+	bgez	$4,$L566
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3881,30 +3885,30 @@
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	nor	$2,$0,$4
-$L640:
+$L648:
 	.set	noreorder
 	.set	nomacro
-	j	$L565
+	j	$L573
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L558:
+$L566:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L565
+	j	$L573
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L561:
+$L569:
 	lw	$2,24($16)
-	srl	$3,$19,16
-	andi	$6,$19,0xffff
+	srl	$3,$20,16
+	andi	$6,$20,0xffff
 	addu	$6,$6,$3
 	lhu	$4,10($18)
 	andi	$3,$2,0xffff
@@ -3914,7 +3918,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L563
+	bgez	$6,$L571
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3928,35 +3932,35 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L562
+	j	$L570
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L563:
+$L571:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L562:
-	lw	$3,24($sp)
+$L570:
+	lw	$3,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L565
+	beq	$3,$0,$L573
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L566
-	beq	$17,$0,$L571
+	bne	$19,$2,$L574
+	beq	$17,$0,$L579
 	lhu	$6,0($17)
 	#nop
-	beq	$6,$0,$L571
+	beq	$6,$0,$L579
 	lw	$4,12($18)
 	lw	$3,24($16)
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	srl	$2,$4,16
 	andi	$4,$4,0xffff
 	addu	$4,$4,$2
@@ -3970,7 +3974,7 @@
 	addu	$4,$4,$6
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L569
+	bgez	$4,$L577
 	sra	$3,$4,16
 	.set	macro
 	.set	reorder
@@ -3983,27 +3987,27 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L641
+	j	$L649
 	nor	$2,$0,$4
 	.set	macro
 	.set	reorder
 
-$L569:
+$L577:
 	andi	$2,$4,0xffff
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L571
+	j	$L579
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L566:
+$L574:
 	lw	$4,12($18)
 	lw	$3,24($16)
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	srl	$2,$4,16
 	andi	$6,$4,0xffff
 	addu	$6,$6,$2
@@ -4018,7 +4022,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L573
+	bgez	$6,$L581
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4030,37 +4034,37 @@
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	nor	$2,$0,$6
-$L641:
+$L649:
 	.set	noreorder
 	.set	nomacro
-	j	$L571
+	j	$L579
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L573:
+$L581:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L571:
+$L579:
 	lw	$2,28($16)
 	#nop
-	sh	$2,0($fp)
-$L565:
+	sh	$2,0($22)
+$L573:
 	lw	$2,24($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L544
+	j	$L552
 	sw	$2,12($18)
 	.set	macro
 	.set	reorder
 
-$L575:
+$L583:
 	lw	$2,32($16)
-	lw	$4,36($sp)
-	andi	$6,$22,0xffff
+	lw	$4,44($sp)
+	andi	$6,$fp,0xffff
 	andi	$3,$2,0xffff
 	addu	$5,$6,$4
 	lhu	$4,10($18)
@@ -4070,7 +4074,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L577
+	bgez	$5,$L585
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4084,47 +4088,47 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L576
+	j	$L584
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L577:
+$L585:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L576:
-	lw	$5,24($sp)
+$L584:
+	lw	$5,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L645
+	beq	$5,$0,$L653
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L580
-	beq	$17,$0,$L645
+	bne	$19,$2,$L588
+	beq	$17,$0,$L653
 	lhu	$4,0($17)
 	#nop
-	beq	$4,$0,$L645
-	lw	$3,36($sp)
+	beq	$4,$0,$L653
+	lw	$3,44($sp)
 	lw	$2,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L647
+	j	$L655
 	addu	$6,$6,$3
 	.set	macro
 	.set	reorder
 
-$L580:
-	lw	$4,36($sp)
+$L588:
+	lw	$4,44($sp)
 	lw	$2,32($16)
 	addu	$6,$6,$4
 	lhu	$4,0($17)
-$L647:
+$L655:
 	andi	$3,$2,0xffff
 	subu	$6,$6,$3
 	srl	$2,$2,16
@@ -4132,7 +4136,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L587
+	bgez	$6,$L595
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4146,27 +4150,27 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L645
+	j	$L653
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L587:
+$L595:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L645
+	j	$L653
 	sh	$6,0($17)
 	.set	macro
 	.set	reorder
 
-$L590:
+$L598:
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	andi	$6,$22,0xffff
+	lw	$3,44($sp)
+	andi	$6,$fp,0xffff
 	lhu	$4,10($18)
 	addu	$5,$6,$3
 	andi	$3,$2,0xffff
@@ -4176,7 +4180,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L592
+	bgez	$5,$L600
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4190,35 +4194,35 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L591
+	j	$L599
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L592:
+$L600:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L591:
-	lw	$4,24($sp)
+$L599:
+	lw	$4,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L645
+	beq	$4,$0,$L653
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L595
-	beq	$17,$0,$L600
+	bne	$19,$2,$L603
+	beq	$17,$0,$L608
 	lhu	$5,0($17)
 	#nop
-	beq	$5,$0,$L600
+	beq	$5,$0,$L608
 	lw	$3,32($16)
-	lw	$2,36($sp)
-	lhu	$4,2($fp)
+	lw	$2,44($sp)
+	lhu	$4,2($22)
 	addu	$6,$6,$2
 	andi	$2,$3,0xffff
 	subu	$6,$6,$2
@@ -4229,15 +4233,15 @@
 	subu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L648
+	j	$L656
 	addu	$6,$6,$5
 	.set	macro
 	.set	reorder
 
-$L595:
+$L603:
 	lw	$3,32($16)
-	lw	$4,36($sp)
-	lhu	$5,2($fp)
+	lw	$4,44($sp)
+	lhu	$5,2($22)
 	andi	$2,$3,0xffff
 	addu	$6,$6,$4
 	subu	$6,$6,$2
@@ -4248,10 +4252,10 @@
 	addu	$6,$6,$5
 	subu	$6,$6,$4
 	addu	$6,$6,$2
-$L648:
+$L656:
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L602
+	bgez	$6,$L610
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4265,30 +4269,30 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L600
+	j	$L608
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L602:
+$L610:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L600:
+$L608:
 	lw	$2,36($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L645
-	sh	$2,2($fp)
+	j	$L653
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
-$L604:
+$L612:
 	lw	$2,24($16)
-	srl	$7,$19,16
-	andi	$6,$19,0xffff
+	srl	$7,$20,16
+	andi	$6,$20,0xffff
 	andi	$3,$2,0xffff
 	addu	$5,$6,$7
 	lhu	$4,10($18)
@@ -4298,7 +4302,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L606
+	bgez	$5,$L614
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4312,21 +4316,21 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L605
+	j	$L613
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L606:
+$L614:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L605:
+$L613:
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	andi	$8,$22,0xffff
+	lw	$3,44($sp)
+	andi	$8,$fp,0xffff
 	lhu	$4,10($18)
 	addu	$5,$8,$3
 	andi	$3,$2,0xffff
@@ -4336,7 +4340,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L609
+	bgez	$5,$L617
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4350,35 +4354,35 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L608
+	j	$L616
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L609:
+$L617:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L608:
-	lw	$4,24($sp)
+$L616:
+	lw	$4,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L611
+	beq	$4,$0,$L619
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$20,$2,$L612
-	beq	$17,$0,$L620
+	bne	$19,$2,$L620
+	beq	$17,$0,$L628
 	lhu	$5,0($17)
 	#nop
-	beq	$5,$0,$L620
+	beq	$5,$0,$L628
 	lw	$3,24($16)
 	addu	$6,$6,$7
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$2,$3,0xffff
 	subu	$6,$6,$2
 	srl	$3,$3,16
@@ -4389,7 +4393,7 @@
 	addu	$6,$6,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L615
+	bgez	$6,$L623
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4403,31 +4407,31 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L614
+	j	$L622
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L615:
+$L623:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L614:
-	lw	$5,36($sp)
+$L622:
+	lw	$5,44($sp)
 	lw	$3,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L649
+	j	$L657
 	addu	$6,$8,$5
 	.set	macro
 	.set	reorder
 
-$L612:
+$L620:
 	lw	$3,24($16)
 	addu	$6,$6,$7
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	andi	$2,$3,0xffff
 	subu	$6,$6,$2
 	srl	$3,$3,16
@@ -4439,7 +4443,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L622
+	bgez	$6,$L630
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4453,24 +4457,24 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L621
+	j	$L629
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L622:
+$L630:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L621:
-	lw	$2,36($sp)
+$L629:
+	lw	$2,44($sp)
 	lw	$3,32($16)
 	addu	$6,$8,$2
-$L649:
+$L657:
 	andi	$2,$3,0xffff
-	lhu	$5,2($fp)
+	lhu	$5,2($22)
 	subu	$6,$6,$2
 	srl	$3,$3,16
 	lw	$4,36($16)
@@ -4481,7 +4485,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L625
+	bgez	$6,$L633
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4495,67 +4499,67 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L620
+	j	$L628
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L625:
+$L633:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L620:
+$L628:
 	lw	$2,28($16)
 	#nop
-	sh	$2,0($fp)
+	sh	$2,0($22)
 	lw	$2,36($16)
 	#nop
-	sh	$2,2($fp)
-$L611:
+	sh	$2,2($22)
+$L619:
 	lw	$2,24($16)
 	#nop
 	sw	$2,12($18)
-$L645:
+$L653:
 	lw	$2,32($16)
 	#nop
 	sw	$2,16($18)
-$L544:
-	lw	$3,104($23)
+$L552:
+	lw	$3,104($21)
 	li	$2,-805371904			# 0xffffffffcfff0000
-	lw	$4,28($23)
+	lw	$4,28($21)
 	ori	$2,$2,0xffff
 	and	$3,$3,$2
-	sw	$3,104($23)
+	sw	$3,104($21)
 	lw	$2,12($4)
 	#nop
-	sw	$2,24($23)
+	sw	$2,24($21)
 	lw	$5,48($16)
 	lw	$6,52($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fastpath_set_qos_mark
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	lui	$2,%hi(jiffies)
 	lw	$2,%lo(jiffies)($2)
 	move	$4,$18
-	move	$5,$fp
+	move	$5,$22
 	sw	$2,40($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_post_process_xmit_check
-	move	$6,$23
+	move	$6,$21
 	.set	macro
 	.set	reorder
 
 	li	$3,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$3,$L475
+	beq	$2,$3,$L482
 	li	$4,1			# 0x1
 	.set	macro
 	.set	reorder
@@ -4563,25 +4567,25 @@
 	.set	noreorder
 	.set	nomacro
 	jal	ip_finish_output3
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L475
+	j	$L482
 	li	$4,1			# 0x1
 	.set	macro
 	.set	reorder
 
-$L511:
+$L519:
 	lw	$16,64($16)
-	j	$L639
-$L633:
-	lw	$2,24($23)
-	move	$5,$fp
-	sw	$2,140($23)
-	move	$6,$23
+	j	$L647
+$L641:
+	lw	$2,24($21)
+	move	$5,$22
+	sw	$2,140($21)
+	move	$6,$21
 	lw	$31,84($sp)
 	lw	$fp,80($sp)
 	lw	$23,76($sp)
@@ -4599,7 +4603,7 @@
 	.set	macro
 	.set	reorder
 
-$L475:
+$L482:
 	lw	$31,84($sp)
 	lw	$fp,80($sp)
 	lw	$23,76($sp)
@@ -4643,27 +4647,27 @@
 	lw	$2,%lo(path_list_inuse)($2)
 	move	$16,$5
 	move	$7,$0
-$L667:
-	beq	$2,$0,$L664
+$L673:
+	beq	$2,$0,$L670
 	move	$6,$0
 
 	lw	$2,72($2)
-	j	$L667
+	j	$L673
 	addiu	$7,$7,1
 
-$L664:
+$L670:
 	lui	$2,%hi(napt_list_inuse)
 	lw	$2,%lo(napt_list_inuse)($2)
 	nop
-$L668:
-	beq	$2,$0,$L666
+$L674:
+	beq	$2,$0,$L672
 	lui	$5,%hi($LC1)
 
 	lw	$2,44($2)
-	j	$L668
+	j	$L674
 	addiu	$6,$6,1
 
-$L666:
+$L672:
 	addu	$4,$4,$16
 	jal	sprintf
 	addiu	$5,$5,%lo($LC1)
@@ -4690,8 +4694,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L674:
-$L715:
+$L680:
+$L721:
 	addiu	$sp,$sp,-56
 	sw	$20,48($sp)
 	sw	$18,40($sp)
@@ -4710,11 +4714,11 @@
 	lui	$2,%hi(table_napt)
 	sw	$16,%lo(table_napt)($2)
 	move	$18,$2
-	beq	$16,$0,$L669
+	beq	$16,$0,$L675
 	li	$3,-1			# 0xffffffffffffffff
 
-$L725:
-$L766:
+$L731:
+$L772:
 	lui	$2,%hi(napt_list_inuse)
 	lui	$19,%hi(napt_list_free)
 	sll	$4,$17,1
@@ -4738,22 +4742,22 @@
 	nop
 	lw	$2,0($2)
 	nop
-	beq	$2,$0,$L669
+	beq	$2,$0,$L675
 	li	$3,-1			# 0xffffffffffffffff
 
-	j	$L769
+	j	$L775
 	move	$16,$0
 
-$L833:
-	j	$L669
+$L839:
+	j	$L675
 	li	$3,-2			# 0xfffffffffffffffe
 
-$L769:
-	blez	$17,$L830
+$L775:
+	blez	$17,$L836
 	nop
 
 	move	$4,$0
-$L774:
+$L780:
 	lw	$2,%lo(table_napt)($18)
 	addiu	$16,$16,1
 	slt	$3,$16,$17
@@ -4773,16 +4777,16 @@
 	nop
 	addu	$2,$4,$2
 	sw	$2,4($2)
-	bne	$3,$0,$L774
+	bne	$3,$0,$L780
 	addiu	$4,$4,12
 
-$L830:
-	blez	$20,$L832
+$L836:
+	blez	$20,$L838
 	move	$16,$0
 
-$L828:
-$L782:
-$L823:
+$L834:
+$L788:
+$L829:
 	lui	$2,%hi(malloc_sizes+12)
 	lw	$4,%lo(malloc_sizes+12)($2)
 	li	$5,32			# 0x20
@@ -4792,7 +4796,7 @@
 	move	$3,$2
 	addiu	$4,$19,%lo(napt_list_free)
 	addiu	$5,$2,44
-	beq	$2,$0,$L833
+	beq	$2,$0,$L839
 	slt	$6,$16,$20
 
 	sw	$0,44($2)
@@ -4805,12 +4809,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L828
+	bne	$6,$0,$L834
 	sw	$2,8($4)
 
-$L832:
+$L838:
 	move	$3,$0
-$L669:
+$L675:
 	lw	$31,52($sp)
 	lw	$20,48($sp)
 	lw	$19,44($sp)
@@ -4837,8 +4841,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L839:
-$L880:
+$L845:
+$L886:
 	addiu	$sp,$sp,-56
 	sw	$20,48($sp)
 	sw	$18,40($sp)
@@ -4857,11 +4861,11 @@
 	lui	$2,%hi(table_path)
 	sw	$16,%lo(table_path)($2)
 	move	$18,$2
-	beq	$16,$0,$L834
+	beq	$16,$0,$L840
 	li	$3,-1			# 0xffffffffffffffff
 
-$L890:
-$L931:
+$L896:
+$L937:
 	lui	$2,%hi(path_list_inuse)
 	lui	$19,%hi(path_list_free)
 	sll	$4,$17,1
@@ -4885,22 +4889,22 @@
 	nop
 	lw	$2,0($2)
 	nop
-	beq	$2,$0,$L834
+	beq	$2,$0,$L840
 	li	$3,-1			# 0xffffffffffffffff
 
-	j	$L934
+	j	$L940
 	move	$16,$0
 
-$L998:
-	j	$L834
+$L1004:
+	j	$L840
 	li	$3,-2			# 0xfffffffffffffffe
 
-$L934:
-	blez	$17,$L995
+$L940:
+	blez	$17,$L1001
 	nop
 
 	move	$4,$0
-$L939:
+$L945:
 	lw	$2,%lo(table_path)($18)
 	addiu	$16,$16,1
 	slt	$3,$16,$17
@@ -4920,16 +4924,16 @@
 	nop
 	addu	$2,$4,$2
 	sw	$2,4($2)
-	bne	$3,$0,$L939
+	bne	$3,$0,$L945
 	addiu	$4,$4,12
 
-$L995:
-	blez	$20,$L997
+$L1001:
+	blez	$20,$L1003
 	move	$16,$0
 
-$L993:
-$L947:
-$L988:
+$L999:
+$L953:
+$L994:
 	lui	$2,%hi(malloc_sizes+20)
 	lw	$4,%lo(malloc_sizes+20)($2)
 	li	$5,32			# 0x20
@@ -4939,7 +4943,7 @@
 	move	$3,$2
 	addiu	$4,$19,%lo(path_list_free)
 	addiu	$5,$2,72
-	beq	$2,$0,$L998
+	beq	$2,$0,$L1004
 	slt	$6,$16,$20
 
 	sw	$0,72($2)
@@ -4952,12 +4956,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L993
+	bne	$6,$0,$L999
 	sw	$2,8($4)
 
-$L997:
+$L1003:
 	move	$3,$0
-$L834:
+$L840:
 	lw	$31,52($sp)
 	lw	$20,48($sp)
 	lw	$19,44($sp)
Index: fastpath/96C/filter.S
===================================================================
--- fastpath/96C/filter.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/96C/filter.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -1291,6 +1291,25 @@
 	.set	macro
 	.set	reorder
 	.end	filter_table_regist
+	.section	.text.Del_Pattern_ACL_For_ContentFilter,"ax",@progbits
+	.align	2
+	.globl	Del_Pattern_ACL_For_ContentFilter
+	.ent	Del_Pattern_ACL_For_ContentFilter
+	.type	Del_Pattern_ACL_For_ContentFilter, @function
+Del_Pattern_ACL_For_ContentFilter:
+	.set	nomips16
+	.frame	$sp,0,$31		# vars= 0, regs= 0/0, args= 0, gp= 0
+	.mask	0x00000000,0
+	.fmask	0x00000000,0
+	.set	noreorder
+	.set	nomacro
+	
+	j	$31
+	move	$2,$0
+
+	.set	macro
+	.set	reorder
+	.end	Del_Pattern_ACL_For_ContentFilter
 	.section	.text.filter_table_flush,"ax",@progbits
 	.align	2
 	.globl	filter_table_flush
Index: fastpath/96C/fast_l2tp_core.S
===================================================================
--- fastpath/96C/fast_l2tp_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/96C/fast_l2tp_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -542,15 +542,9 @@
 	beq	$2,$0,$L32
 	nop
 
-	lw	$3,16($17)
-	lw	$2,16($18)
+	lw	$3,16($18)
+	lw	$2,16($17)
 	nop
-	bne	$3,$2,$L32
-	nop
-
-	lw	$3,12($18)
-	lw	$2,12($17)
-	nop
 	bne	$2,$3,$L32
 	nop
 
Index: fastpath/fastpath_common.c
===================================================================
--- fastpath/fastpath_common.c	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/fastpath_common.c	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -67,12 +67,14 @@
 			for_each_net(net) {
 				nf_conntrack_flush(net, 0, 0);		//clean conntrack table		
 			}
-			#if defined(CONFIG_RTL_LAYERED_DRIVER_L4) && defined(CONFIG_RTL_8198)
+			#if defined(CONFIG_RTL_LAYERED_DRIVER_L4) 
+			#if defined(CONFIG_RTL_8198) || defined (CONFIG_RTL_8196CT)
 			rtl865x_nat_reinit();
 			/* the following 2 values MUST set behind reinit nat module	*/
 			rtl_nat_expire_interval_update(RTL865X_PROTOCOL_TCP, tcp_get_timeouts_by_state(TCP_CONNTRACK_ESTABLISHED));
 			rtl_nat_expire_interval_update(RTL865X_PROTOCOL_UDP, nf_ct_udp_timeout>nf_ct_udp_timeout_stream?nf_ct_udp_timeout:nf_ct_udp_timeout_stream);
 			#endif
+			#endif
 		}else{
 			sscanf(tmpbuf, "%d", &fast_nat_fw);
 			#if defined(CONFIG_RTL_NF_CONNTRACK_GARBAGE_NEW)
@@ -119,6 +121,16 @@
 	iph = ip_hdr(pskb);
 	tcphupuh = (struct tcphdr*)((__u32 *)iph + iph->ihl);
 
+#if 1
+	if(iph->protocol == IPPROTO_TCP)
+	{
+		if ((tcphupuh->syn) || (tcphupuh->fin) || (tcphupuh->rst))
+		{
+			return FAILED;
+		}
+	}
+#endif
+
 	//To bak origal protol mac
 	memcpy(oriSrcMac,eth_hdr(pskb)->h_source,ETH_ALEN);
 	memcpy(oriDstMac,eth_hdr(pskb)->h_dest,ETH_ALEN);
Index: fastpath/98_MP/fastpath_core.S
===================================================================
--- fastpath/98_MP/fastpath_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/98_MP/fastpath_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -2652,33 +2652,33 @@
 	addiu	$sp,$sp,-88
 	li	$2,1			# 0x1
 	sw	$23,76($sp)
-	move	$23,$4
-	sw	$22,72($sp)
+	move	$23,$0
+	sw	$21,68($sp)
 	sw	$31,84($sp)
 	sw	$fp,80($sp)
-	sw	$21,68($sp)
+	sw	$22,72($sp)
 	sw	$20,64($sp)
 	sw	$19,60($sp)
 	sw	$18,56($sp)
 	sw	$17,52($sp)
 	sw	$16,48($sp)
 	lw	$18,152($4)
-	sw	$2,24($sp)
+	sw	$2,32($sp)
 	li	$2,6			# 0x6
-	sw	$0,28($sp)
-	sw	$0,32($sp)
-	lbu	$21,9($18)
+	sw	$0,36($sp)
+	sw	$0,40($sp)
+	lbu	$20,9($18)
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L449
-	move	$22,$0
+	beq	$20,$2,$L449
+	move	$21,$4
 	.set	macro
 	.set	reorder
 
 	li	$2,17			# 0x11
 	.set	noreorder
 	.set	nomacro
-	bne	$21,$2,$L446
+	bne	$20,$2,$L446
 	move	$4,$0
 	.set	macro
 	.set	reorder
@@ -2686,14 +2686,14 @@
 $L449:
 	lbu	$2,0($18)
 	move	$4,$18
-	move	$6,$23
+	move	$6,$21
 	andi	$2,$2,0xf
 	sll	$2,$2,2
-	addu	$fp,$18,$2
+	addu	$22,$18,$2
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_pre_process_check
-	move	$5,$fp
+	move	$5,$22
 	.set	macro
 	.set	reorder
 
@@ -2701,32 +2701,33 @@
 	move	$4,$2
 	li	$2,6			# 0x6
 	bne	$5,$2,$L446
-	lhu	$7,6($18)
-	lui	$4,%hi($LC0)
+	lhu	$3,0($22)
+	lhu	$16,6($18)
 	lw	$19,12($18)
-	lw	$20,16($18)
-	lhu	$8,0($fp)
-	lhu	$11,2($fp)
-	lw	$3,24($23)
+	lw	$fp,16($18)
+	sw	$3,24($sp)
+	lhu	$7,2($22)
+	sw	$7,28($sp)
+	lw	$3,24($21)
 	.set	noreorder
 	.set	nomacro
-	bne	$21,$5,$L451
-	andi	$6,$7,0xffff
+	bne	$20,$5,$L451
+	lui	$4,%hi($LC0)
 	.set	macro
 	.set	reorder
 
 	addiu	$2,$4,%lo($LC0)
-	move	$5,$3
+	move	$8,$3
 #APP
 	.set	noreorder
 	.set	noat
-	lbu	$3,($5)
+	lbu	$3,($8)
 1:	lbu	$1,($2)
-	addiu	$5,1
+	addiu	$8,1
 	bne	$1,$3,2f
 	addiu	$2,1
 	bnez	$3,1b
-	lbu	$3,($5)
+	lbu	$3,($8)
 	move	$3,$1
 2:	subu	$3,$1
 3:	.set	at
@@ -2739,7 +2740,7 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$6,0x3fff
+	andi	$2,$16,0x3fff
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L457
@@ -2747,7 +2748,7 @@
 	.set	macro
 	.set	reorder
 
-	xori	$2,$6,0x2000
+	xori	$2,$16,0x2000
 	.set	noreorder
 	.set	nomacro
 	j	$L457
@@ -2755,7 +2756,7 @@
 	.set	macro
 	.set	reorder
 
-$L626:
+$L627:
 	lw	$5,24($4)
 	lhu	$7,30($4)
 	j	$L462
@@ -2763,13 +2764,12 @@
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L645
-	andi	$2,$7,0x3fff
+	bne	$3,$2,$L458
+	li	$2,65536			# 0x10000
 	.set	macro
 	.set	reorder
 
-	lw	$3,12($fp)
-	li	$2,65536			# 0x10000
+	lw	$3,12($22)
 	and	$2,$3,$2
 	.set	noreorder
 	.set	nomacro
@@ -2778,16 +2778,18 @@
 	.set	macro
 	.set	reorder
 
+	lw	$4,24($sp)
 	srl	$2,$19,8
-	srl	$3,$20,16
-	andi	$9,$8,0xffff
-	xor	$3,$3,$20
+	srl	$3,$fp,16
 	xor	$2,$2,$19
+	xor	$3,$3,$fp
+	andi	$9,$4,0xffff
+	lw	$5,28($sp)
 	srl	$4,$9,4
 	xor	$2,$2,$3
-	andi	$8,$11,0xffff
+	andi	$6,$20,0xffff
 	xor	$2,$2,$4
-	andi	$6,$21,0xffff
+	andi	$8,$5,0xffff
 	xor	$2,$2,$8
 	lui	$10,%hi(path_table_list_max)
 	xor	$2,$2,$6
@@ -2814,7 +2816,7 @@
 	lw	$2,16($4)
 	bne	$2,$19,$L463
 	lw	$2,20($4)
-	bne	$2,$20,$L463
+	bne	$2,$fp,$L463
 	lbu	$2,0($4)
 	.set	noreorder
 	.set	nomacro
@@ -2826,7 +2828,7 @@
 	lbu	$3,2($4)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L626
+	beq	$3,$2,$L627
 	sb	$0,0($4)
 	.set	macro
 	.set	reorder
@@ -2860,16 +2862,16 @@
 	.set	macro
 	.set	reorder
 
-	srl	$2,$20,8
+	srl	$2,$fp,8
 	srl	$3,$5,16
 	xor	$3,$3,$5
-	xor	$2,$2,$20
+	xor	$2,$2,$fp
 	xor	$2,$2,$3
 	srl	$3,$8,4
 	xor	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L632
+	j	$L633
 	xor	$2,$2,$7
 	.set	macro
 	.set	reorder
@@ -2882,7 +2884,7 @@
 	srl	$3,$7,4
 	xor	$2,$2,$3
 	xor	$2,$2,$9
-$L632:
+$L633:
 	xor	$2,$2,$6
 	lw	$3,%lo(path_table_list_max)($10)
 	srl	$4,$2,12
@@ -2900,7 +2902,7 @@
 	li	$3,255			# 0xff
 $L478:
 	lw	$2,24($4)
-	bne	$2,$20,$L476
+	bne	$2,$fp,$L476
 	lw	$2,28($4)
 	bne	$2,$8,$L476
 	lw	$2,32($4)
@@ -2930,26 +2932,41 @@
 	.set	macro
 	.set	reorder
 
+$L458:
+	lw	$2,12($22)
+	li	$3,1048576			# 0x100000
+	and	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L645
-	andi	$2,$7,0x3fff
+	beq	$2,$0,$L481
+	li	$2,40			# 0x28
 	.set	macro
 	.set	reorder
 
+	lhu	$3,2($18)
+	bne	$3,$2,$L481
+	move	$4,$21
+	.set	noreorder
+	.set	nomacro
+	jal	skb_trim
+	li	$5,40			# 0x28
+	.set	macro
+	.set	reorder
+
+	j	$L481
 $L451:
 	addiu	$2,$4,%lo($LC0)
-	move	$5,$3
+	move	$7,$3
 #APP
 	.set	noreorder
 	.set	noat
-	lbu	$3,($5)
+	lbu	$3,($7)
 1:	lbu	$1,($2)
-	addiu	$5,1
+	addiu	$7,1
 	bne	$1,$3,2f
 	addiu	$2,1
 	bnez	$3,1b
-	lbu	$3,($5)
+	lbu	$3,($7)
 	move	$3,$1
 2:	subu	$3,$1
 3:	.set	at
@@ -2962,60 +2979,61 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$7,0x3fff
-$L645:
+$L481:
+	lhu	$2,6($18)
+	andi	$2,$2,0x3fff
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L647
-	srl	$3,$20,16
+	srl	$3,$fp,16
 	.set	macro
 	.set	reorder
 
 	li	$2,8192			# 0x2000
 	.set	noreorder
 	.set	nomacro
-	bne	$6,$2,$L484
-	andi	$2,$6,0x2000
+	bne	$16,$2,$L485
+	andi	$2,$16,0x2000
 	.set	macro
 	.set	reorder
 
-	li	$2,1			# 0x1
+	li	$8,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	j	$L485
-	sw	$2,28($sp)
+	j	$L486
+	sw	$8,36($sp)
 	.set	macro
 	.set	reorder
 
-$L484:
+$L485:
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L648
-	xor	$3,$19,$20
+	bne	$2,$0,$L486
+	andi	$3,$16,0x1fff
 	.set	macro
 	.set	reorder
 
-	lw	$4,32($sp)
-	andi	$3,$6,0x1fff
+	lw	$4,40($sp)
 	li	$2,1			# 0x1
 	movn	$4,$2,$3		#conditional move
-	sw	$4,32($sp)
-$L485:
-	xor	$3,$19,$20
-$L648:
+	sw	$4,40($sp)
+$L486:
+	lw	$8,12($18)
+	andi	$6,$20,0x00ff
+	lw	$7,16($18)
+	lhu	$5,4($18)
+	xor	$3,$8,$7
+	srl	$2,$3,16
+	xor	$2,$2,$5
+	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
-	lhu	$7,4($18)
-	srl	$4,$3,16
-	lw	$5,%lo(max_udp_frag_entry)($2)
-	andi	$6,$21,0x00ff
-	xor	$4,$4,$7
-	xor	$3,$3,$4
-	addiu	$5,$5,-1
+	lw	$4,%lo(max_udp_frag_entry)($2)
 	srl	$2,$3,8
 	xor	$2,$2,$6
 	xor	$3,$3,$2
+	addiu	$4,$4,-1
 	lui	$2,%hi(udp_cache_table)
-	and	$3,$3,$5
+	and	$3,$3,$4
 	lw	$4,%lo(udp_cache_table)($2)
 	sll	$2,$3,1
 	addu	$2,$2,$3
@@ -3025,60 +3043,61 @@
 	lw	$4,0($2)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L494
-	move	$22,$0
+	beq	$4,$0,$L495
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$3,1			# 0x1
-$L493:
+$L494:
 	lhu	$2,2($4)
-	bne	$2,$7,$L490
+	bne	$2,$5,$L491
 	lw	$2,4($4)
-	bne	$2,$19,$L490
+	bne	$2,$8,$L491
 	lw	$2,8($4)
-	bne	$2,$20,$L490
+	bne	$2,$7,$L491
 	lbu	$2,1($4)
-	bne	$2,$6,$L490
+	bne	$2,$6,$L491
 	lbu	$2,0($4)
-	beq	$2,$3,$L627
-$L490:
+	beq	$2,$3,$L628
+$L491:
 	lw	$4,40($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$4,$0,$L493
-	move	$22,$0
+	bne	$4,$0,$L494
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
-	j	$L494
-$L627:
+	j	$L495
+$L628:
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L494
-	move	$22,$4
+	beq	$4,$0,$L495
+	move	$23,$4
 	.set	macro
 	.set	reorder
 
-	lw	$5,28($sp)
-	lhu	$8,12($4)
-	lhu	$11,14($4)
+	lhu	$5,12($4)
+	lw	$8,36($sp)
+	sw	$5,24($sp)
+	lhu	$7,14($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$0,$L647
-	srl	$3,$20,16
+	bne	$8,$0,$L484
+	sw	$7,28($sp)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L647
-	sw	$0,24($sp)
+	j	$L484
+	sw	$0,32($sp)
 	.set	macro
 	.set	reorder
 
-$L494:
-	lw	$2,28($sp)
+$L495:
+	lw	$2,36($sp)
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L446
@@ -3086,18 +3105,21 @@
 	.set	macro
 	.set	reorder
 
-	srl	$3,$20,16
+$L484:
+	srl	$3,$fp,16
 $L647:
 	srl	$2,$19,8
-	sw	$3,36($sp)
+	lw	$4,24($sp)
 	xor	$2,$2,$19
-	xor	$3,$3,$20
+	sw	$3,44($sp)
+	xor	$3,$3,$fp
 	xor	$2,$2,$3
-	srl	$3,$8,4
+	srl	$3,$4,4
+	lw	$5,28($sp)
 	xor	$2,$2,$3
 	lui	$3,%hi(path_table_list_max)
-	xor	$2,$2,$11
-	xor	$2,$2,$21
+	xor	$2,$2,$5
+	xor	$2,$2,$20
 	lw	$4,%lo(path_table_list_max)($3)
 	srl	$3,$2,12
 	xor	$2,$2,$3
@@ -3111,24 +3133,26 @@
 	sll	$2,$2,2
 	addu	$2,$2,$3
 	lw	$16,0($2)
-$L633:
+$L634:
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L625
+	beq	$16,$0,$L626
 	move	$4,$18
 	.set	macro
 	.set	reorder
 
 	lw	$2,12($16)
-	bne	$2,$8,$L501
+	lw	$7,24($sp)
+	bne	$2,$7,$L502
 	lw	$2,8($16)
-	bne	$2,$11,$L501
+	lw	$8,28($sp)
+	bne	$2,$8,$L502
 	lw	$2,16($16)
-	bne	$2,$19,$L501
+	bne	$2,$19,$L502
 	lw	$2,20($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$20,$L501
+	bne	$2,$fp,$L502
 	li	$2,255			# 0xff
 	.set	macro
 	.set	reorder
@@ -3136,7 +3160,7 @@
 	lbu	$3,0($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L501
+	bne	$3,$2,$L502
 	li	$2,2			# 0x2
 	.set	macro
 	.set	reorder
@@ -3144,7 +3168,7 @@
 	lw	$3,4($16)
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L649
+	bne	$3,$2,$L648
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
@@ -3152,28 +3176,26 @@
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L503
+	beq	$20,$2,$L504
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
 
-$L649:
+$L648:
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L501
+	bne	$3,$2,$L502
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L501
-$L503:
+	bne	$20,$2,$L502
+$L504:
 	lw	$5,32($16)
-	move	$4,$23
+	move	$4,$21
 	lbu	$7,1($18)
 	move	$6,$19
-	lw	$2,24($23)
-	sw	$8,40($sp)
-	sw	$11,44($sp)
+	lw	$2,24($21)
 	.set	noreorder
 	.set	nomacro
 	jal	ip_route_input
@@ -3181,8 +3203,6 @@
 	.set	macro
 	.set	reorder
 
-	lw	$8,40($sp)
-	lw	$11,44($sp)
 	.set	noreorder
 	.set	nomacro
 	bne	$2,$0,$L446
@@ -3190,76 +3210,78 @@
 	.set	macro
 	.set	reorder
 
-	lw	$3,28($23)
+	lw	$3,28($21)
 	lw	$2,48($3)
-	bne	$2,$0,$L508
+	bne	$2,$0,$L509
 	lw	$2,44($3)
-	beq	$2,$0,$L640
-$L508:
+	beq	$2,$0,$L641
+$L509:
 	lw	$2,72($3)
-	lw	$3,84($23)
+	lw	$3,84($21)
 	sltu	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L640
+	bne	$2,$0,$L641
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L512
-	addiu	$17,$fp,16
+	beq	$20,$2,$L513
+	addiu	$17,$22,16
 	.set	macro
 	.set	reorder
 
-	lhu	$3,6($fp)
-	addiu	$2,$fp,6
+	lhu	$3,6($22)
+	addiu	$2,$22,6
 	move	$17,$0
 	movn	$17,$2,$3		#conditional move  
-$L512:
-	lw	$4,28($sp)
+$L513:
+	lw	$2,36($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L515
-	xor	$3,$19,$20
+	beq	$2,$0,$L516
+	xor	$3,$19,$fp
 	.set	macro
 	.set	reorder
 
 	lui	$2,%hi(max_udp_frag_entry)
 	lhu	$10,4($18)
 	srl	$4,$3,16
-	lw	$5,%lo(max_udp_frag_entry)($2)
-	andi	$9,$21,0x00ff
+	lw	$7,24($sp)
+	andi	$9,$20,0x00ff
 	xor	$4,$4,$10
 	lui	$6,%hi(udp_cache_list_free)
 	xor	$3,$3,$4
-	andi	$4,$8,0xffff
+	andi	$4,$7,0xffff
+	lw	$8,28($sp)
+	lw	$5,%lo(max_udp_frag_entry)($2)
 	srl	$2,$3,8
-	addiu	$5,$5,-1
 	xor	$2,$2,$9
-	andi	$7,$11,0xffff
+	andi	$7,$8,0xffff
 	lw	$8,%lo(udp_cache_list_free)($6)
+	addiu	$5,$5,-1
 	xor	$3,$3,$2
 	.set	noreorder
 	.set	nomacro
-	bne	$8,$0,$L518
+	bne	$8,$0,$L519
 	and	$11,$3,$5
 	.set	macro
 	.set	reorder
 
-$L640:
-	lw	$4,28($23)
+$L641:
+	lw	$4,28($21)
 	jal	dst_release
 	move	$4,$0
 	.set	noreorder
 	.set	nomacro
 	j	$L446
-	sw	$0,28($23)
+	sw	$0,28($21)
 	.set	macro
 	.set	reorder
 
-$L518:
+$L519:
 	lw	$5,48($8)
 	li	$2,1
 	sh	$10,2($8)
@@ -3268,25 +3290,25 @@
 	sh	$7,14($8)
 	sb	$2,0($8)
 	sw	$19,4($8)
-	sw	$20,8($8)
+	sw	$fp,8($8)
 	lw	$3,52($8)
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L521
+	beq	$5,$0,$L522
 	addiu	$2,$6,%lo(udp_cache_list_free)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L522
+	j	$L523
 	sw	$3,52($5)
 	.set	macro
 	.set	reorder
 
-$L521:
+$L522:
 	sw	$3,4($2)
-$L522:
+$L523:
 	lw	$4,52($8)
 	addiu	$6,$6,%lo(udp_cache_list_free)
 	lw	$2,48($8)
@@ -3334,58 +3356,58 @@
 	.set	noreorder
 	.set	nomacro
 	j	$L646
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
-$L515:
-	lw	$5,32($sp)
+$L516:
+	lw	$2,40($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L646
-	move	$4,$23
+	beq	$2,$0,$L646
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
 	jal	del_timer
-	addiu	$4,$22,16
+	addiu	$4,$23,16
 	.set	macro
 	.set	reorder
 
-	lw	$2,8($22)
-	lw	$3,4($22)
-	lhu	$4,2($22)
+	lw	$2,8($23)
+	lw	$3,4($23)
+	lhu	$4,2($23)
 	xor	$3,$3,$2
 	srl	$2,$3,16
 	xor	$2,$2,$4
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
-	lbu	$5,1($22)
+	lbu	$5,1($23)
 	srl	$4,$3,8
 	lw	$2,%lo(max_udp_frag_entry)($2)
 	xor	$4,$4,$5
-	lw	$6,40($22)
+	lw	$6,40($23)
 	xor	$3,$3,$4
 	addiu	$2,$2,-1
-	sb	$0,0($22)
-	lw	$4,44($22)
+	sb	$0,0($23)
+	lw	$4,44($23)
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L528
+	beq	$6,$0,$L529
 	and	$5,$3,$2
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L529
+	j	$L530
 	sw	$4,44($6)
 	.set	macro
 	.set	reorder
 
-$L528:
+$L529:
 	lui	$3,%hi(udp_cache_table)
 	sll	$2,$5,1
 	lw	$3,%lo(udp_cache_table)($3)
@@ -3394,13 +3416,13 @@
 	lw	$3,0($3)
 	addu	$2,$2,$3
 	sw	$4,4($2)
-$L529:
-	lw	$4,44($22)
+$L530:
+	lw	$4,44($23)
 	sll	$3,$5,1
-	lw	$2,40($22)
+	lw	$2,40($23)
 	addu	$3,$3,$5
 	sll	$3,$3,2
-	addiu	$5,$22,48
+	addiu	$5,$23,48
 	sw	$2,0($4)
 	lui	$2,%hi(udp_cache_table)
 	lw	$2,%lo(udp_cache_table)($2)
@@ -3411,22 +3433,22 @@
 	lw	$2,8($3)
 	addiu	$2,$2,-1
 	sw	$2,8($3)
-	sw	$0,48($22)
+	sw	$0,48($23)
 	lw	$2,4($4)
-	sw	$2,52($22)
+	sw	$2,52($23)
 	lw	$2,4($4)
-	sw	$22,0($2)
+	sw	$23,0($2)
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
 	sw	$2,8($4)
-	move	$4,$23
+	move	$4,$21
 $L646:
 	move	$5,$18
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_before_nat_check
-	move	$6,$21
+	move	$6,$20
 	.set	macro
 	.set	reorder
 
@@ -3438,34 +3460,34 @@
 	sltu	$2,$3,13
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L594
+	beq	$2,$0,$L595
 	sll	$2,$3,2
 	.set	macro
 	.set	reorder
 
-	lui	$3,%hi($L617)
-	addiu	$3,$3,%lo($L617)
+	lui	$3,%hi($L618)
+	addiu	$3,$3,%lo($L618)
 	addu	$2,$2,$3
 	lw	$2,0($2)
 	j	$2
 	.rdata
 	.align	2
-$L617:
-	.word	$L534
-	.word	$L536
-	.word	$L551
-	.word	$L551
-	.word	$L565
-	.word	$L594
-	.word	$L594
-	.word	$L594
-	.word	$L580
-	.word	$L594
-	.word	$L594
-	.word	$L594
-	.word	$L580
+$L618:
+	.word	$L535
+	.word	$L537
+	.word	$L552
+	.word	$L552
+	.word	$L566
+	.word	$L595
+	.word	$L595
+	.word	$L595
+	.word	$L581
+	.word	$L595
+	.word	$L595
+	.word	$L595
+	.word	$L581
 	.section	.text.enter_fast_path
-$L536:
+$L537:
 	lw	$3,24($16)
 	srl	$2,$19,16
 	andi	$6,$19,0xffff
@@ -3478,7 +3500,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L538
+	bgez	$6,$L539
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3492,30 +3514,30 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L537
+	j	$L538
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L538:
+$L539:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L537:
-	lw	$2,24($sp)
+$L538:
+	lw	$3,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L555
+	beq	$3,$0,$L556
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L541
-	beq	$17,$0,$L555
+	bne	$20,$2,$L542
+	beq	$17,$0,$L556
 	lhu	$6,0($17)
-	beq	$6,$0,$L555
+	beq	$6,$0,$L556
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3527,12 +3549,12 @@
 	subu	$5,$5,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L641
+	j	$L642
 	addu	$5,$5,$6
 	.set	macro
 	.set	reorder
 
-$L541:
+$L542:
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3544,10 +3566,10 @@
 	lhu	$2,0($17)
 	subu	$5,$5,$3
 	addu	$5,$5,$2
-$L641:
+$L642:
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L548
+	bgez	$5,$L549
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3561,24 +3583,24 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L555
+	j	$L556
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L548:
+$L549:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L555
+	j	$L556
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L551:
+$L552:
 	lw	$3,24($16)
 	srl	$2,$19,16
 	andi	$6,$19,0xffff
@@ -3591,7 +3613,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L553
+	bgez	$6,$L554
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3605,30 +3627,30 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L552
+	j	$L553
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L553:
+$L554:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L552:
-	lw	$3,24($sp)
+$L553:
+	lw	$4,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L555
+	beq	$4,$0,$L556
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L556
-	beq	$17,$0,$L561
+	bne	$20,$2,$L557
+	beq	$17,$0,$L562
 	lhu	$6,0($17)
-	beq	$6,$0,$L561
+	beq	$6,$0,$L562
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3637,19 +3659,19 @@
 	andi	$2,$3,0xffff
 	subu	$5,$5,$2
 	srl	$3,$3,16
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	subu	$5,$5,$3
 	lw	$2,28($16)
 	addu	$5,$5,$4
 	subu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L642
+	j	$L643
 	addu	$5,$5,$6
 	.set	macro
 	.set	reorder
 
-$L556:
+$L557:
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3658,17 +3680,17 @@
 	andi	$2,$3,0xffff
 	subu	$5,$5,$2
 	srl	$3,$3,16
-	lhu	$2,0($fp)
+	lhu	$2,0($22)
 	subu	$5,$5,$3
 	lw	$3,28($16)
 	addu	$5,$5,$2
 	lhu	$2,0($17)
 	subu	$5,$5,$3
 	addu	$5,$5,$2
-$L642:
+$L643:
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L563
+	bgez	$5,$L564
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3682,33 +3704,33 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L561
+	j	$L562
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L563:
+$L564:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,0($17)
-$L561:
+$L562:
 	lw	$2,28($16)
-	sh	$2,0($fp)
-$L555:
+	sh	$2,0($22)
+$L556:
 	lw	$2,24($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L534
+	j	$L535
 	sw	$2,12($18)
 	.set	macro
 	.set	reorder
 
-$L565:
+$L566:
 	lw	$2,32($16)
-	andi	$6,$20,0xffff
-	lw	$5,36($sp)
+	andi	$6,$fp,0xffff
+	lw	$5,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$4,$6,$5
@@ -3718,7 +3740,7 @@
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L567
+	bgez	$4,$L568
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3732,41 +3754,41 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L566
+	j	$L567
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L567:
+$L568:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L566:
-	lw	$2,24($sp)
+$L567:
+	lw	$7,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L639
+	beq	$7,$0,$L640
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L570
-	beq	$17,$0,$L639
+	bne	$20,$2,$L571
+	beq	$17,$0,$L640
 	lhu	$5,0($17)
-	beq	$5,$0,$L639
+	beq	$5,$0,$L640
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	addu	$4,$6,$3
+	lw	$8,44($sp)
 	andi	$3,$2,0xffff
+	srl	$2,$2,16
+	addu	$4,$6,$8
 	subu	$4,$4,$3
-	srl	$2,$2,16
 	subu	$4,$4,$2
 	addu	$4,$4,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L573
+	bgez	$4,$L574
 	sra	$3,$4,16
 	.set	macro
 	.set	reorder
@@ -3779,36 +3801,36 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L636
+	j	$L637
 	nor	$2,$0,$4
 	.set	macro
 	.set	reorder
 
-$L573:
+$L574:
 	andi	$2,$4,0xffff
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L639
+	j	$L640
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L570:
+$L571:
 	lw	$2,32($16)
-	lw	$4,36($sp)
+	lw	$3,44($sp)
+	lhu	$4,0($17)
+	addu	$5,$6,$3
 	andi	$3,$2,0xffff
+	subu	$5,$5,$3
 	srl	$2,$2,16
-	addu	$5,$6,$4
-	subu	$5,$5,$3
-	lhu	$4,0($17)
 	subu	$5,$5,$2
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L577
+	bgez	$5,$L578
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3820,40 +3842,40 @@
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	nor	$2,$0,$5
-$L636:
+$L637:
 	.set	noreorder
 	.set	nomacro
-	j	$L639
+	j	$L640
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L577:
+$L578:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L639
+	j	$L640
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L580:
+$L581:
 	lw	$2,32($16)
-	andi	$5,$20,0xffff
-	lw	$3,36($sp)
-	addu	$4,$5,$3
+	andi	$5,$fp,0xffff
+	lw	$7,44($sp)
 	andi	$3,$2,0xffff
+	srl	$2,$2,16
+	addu	$4,$5,$7
 	subu	$4,$4,$3
-	srl	$2,$2,16
 	lhu	$3,10($18)
 	subu	$4,$4,$2
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L582
+	bgez	$4,$L583
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3867,33 +3889,33 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L581
+	j	$L582
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L582:
+$L583:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L581:
-	lw	$4,24($sp)
+$L582:
+	lw	$8,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L639
+	beq	$8,$0,$L640
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L585
-	beq	$17,$0,$L590
+	bne	$20,$2,$L586
+	beq	$17,$0,$L591
 	lhu	$6,0($17)
-	beq	$6,$0,$L590
+	beq	$6,$0,$L591
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	lhu	$4,2($fp)
+	lw	$3,44($sp)
+	lhu	$4,2($22)
 	addu	$5,$5,$3
 	andi	$3,$2,0xffff
 	subu	$5,$5,$3
@@ -3904,29 +3926,29 @@
 	subu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L643
+	j	$L644
 	addu	$5,$5,$6
 	.set	macro
 	.set	reorder
 
-$L585:
+$L586:
 	lw	$2,32($16)
-	lw	$4,36($sp)
+	lw	$4,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$5,$5,$4
 	subu	$5,$5,$3
-	lhu	$4,2($fp)
+	lhu	$4,2($22)
 	subu	$5,$5,$2
 	lw	$3,36($16)
 	addu	$5,$5,$4
 	lhu	$2,0($17)
 	subu	$5,$5,$3
 	addu	$5,$5,$2
-$L643:
+$L644:
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L592
+	bgez	$5,$L593
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -3940,27 +3962,27 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L590
+	j	$L591
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L592:
+$L593:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,0($17)
-$L590:
+$L591:
 	lw	$2,36($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L639
-	sh	$2,2($fp)
+	j	$L640
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
-$L594:
+$L595:
 	lw	$2,24($16)
 	srl	$7,$19,16
 	andi	$6,$19,0xffff
@@ -3973,7 +3995,7 @@
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L596
+	bgez	$4,$L597
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3987,21 +4009,21 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L595
+	j	$L596
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L596:
+$L597:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L595:
+$L596:
 	lw	$2,32($16)
-	andi	$8,$20,0xffff
-	lw	$5,36($sp)
+	andi	$8,$fp,0xffff
+	lw	$5,44($sp)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	addu	$4,$8,$5
@@ -4011,7 +4033,7 @@
 	addu	$4,$4,$3
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L599
+	bgez	$4,$L600
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -4025,38 +4047,38 @@
 	nor	$2,$0,$4
 	.set	noreorder
 	.set	nomacro
-	j	$L598
+	j	$L599
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L599:
+$L600:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	sh	$4,10($18)
-$L598:
-	lw	$2,24($sp)
+$L599:
+	lw	$2,32($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L601
+	beq	$2,$0,$L602
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L602
-	beq	$17,$0,$L610
+	bne	$20,$2,$L603
+	beq	$17,$0,$L611
 	lhu	$5,0($17)
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L610
+	beq	$5,$0,$L611
 	addu	$6,$6,$7
 	.set	macro
 	.set	reorder
 
 	lw	$2,24($16)
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
@@ -4067,7 +4089,7 @@
 	addu	$6,$6,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L605
+	bgez	$6,$L606
 	sra	$3,$6,16
 	.set	macro
 	.set	reorder
@@ -4081,31 +4103,31 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L604
+	j	$L605
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L605:
+$L606:
 	andi	$2,$6,0xffff
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L604:
-	lw	$3,36($sp)
+$L605:
+	lw	$3,44($sp)
 	lw	$2,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L644
+	j	$L645
 	addu	$5,$8,$3
 	.set	macro
 	.set	reorder
 
-$L602:
+$L603:
 	lw	$2,24($16)
 	addu	$6,$6,$7
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$6,$6,$3
@@ -4117,7 +4139,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L612
+	bgez	$6,$L613
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4131,26 +4153,26 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L611
+	j	$L612
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L612:
+$L613:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L611:
-	lw	$4,36($sp)
+$L612:
+	lw	$4,44($sp)
 	lw	$2,32($16)
 	addu	$5,$8,$4
-$L644:
+$L645:
 	andi	$3,$2,0xffff
 	srl	$2,$2,16
 	subu	$5,$5,$3
-	lhu	$4,2($fp)
+	lhu	$4,2($22)
 	subu	$5,$5,$2
 	lw	$3,36($16)
 	addu	$5,$5,$4
@@ -4159,7 +4181,7 @@
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L615
+	bgez	$5,$L616
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4173,51 +4195,51 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L610
+	j	$L611
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L615:
+$L616:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,0($17)
-$L610:
+$L611:
 	lw	$2,28($16)
-	sh	$2,0($fp)
+	sh	$2,0($22)
 	lw	$2,36($16)
-	sh	$2,2($fp)
-$L601:
+	sh	$2,2($22)
+$L602:
 	lw	$2,24($16)
 	sw	$2,12($18)
-$L639:
+$L640:
 	lw	$2,32($16)
 	sw	$2,16($18)
-$L534:
-	lw	$3,104($23)
+$L535:
+	lw	$3,104($21)
 	li	$2,-805371904			# 0xcfff0000
 	ori	$2,$2,0xffff
 	and	$3,$3,$2
-	lw	$2,28($23)
-	sw	$3,104($23)
+	lw	$2,28($21)
+	sw	$3,104($21)
 	lw	$2,12($2)
-	sw	$2,24($23)
+	sw	$2,24($21)
 	lw	$5,48($16)
 	lw	$6,52($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fastpath_set_qos_mark
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	lui	$2,%hi(jiffies)
 	lw	$2,%lo(jiffies)($2)
 	move	$4,$18
-	move	$5,$fp
-	move	$6,$23
+	move	$5,$22
+	move	$6,$21
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_post_process_xmit_check
@@ -4236,7 +4258,7 @@
 	.set	noreorder
 	.set	nomacro
 	jal	ip_finish_output3
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
@@ -4247,14 +4269,14 @@
 	.set	macro
 	.set	reorder
 
-$L501:
+$L502:
 	lw	$16,64($16)
-	j	$L633
-$L625:
-	lw	$2,24($23)
-	move	$5,$fp
-	move	$6,$23
-	sw	$2,136($23)
+	j	$L634
+$L626:
+	lw	$2,24($21)
+	move	$5,$22
+	move	$6,$21
+	sw	$2,136($21)
 	lw	$31,84($sp)
 	lw	$fp,80($sp)
 	lw	$23,76($sp)
@@ -4316,26 +4338,26 @@
 	sw	$31,20($sp)
 	move	$16,$5
 	lw	$2,%lo(path_list_inuse)($2)
-$L663:
-	beq	$2,$0,$L660
+$L662:
+	beq	$2,$0,$L659
 	move	$6,$0
 
 	lw	$2,72($2)
-	j	$L663
+	j	$L662
 	addiu	$7,$7,1
 
-$L660:
+$L659:
 	lui	$2,%hi(napt_list_inuse)
 	lw	$2,%lo(napt_list_inuse)($2)
-$L664:
-	beq	$2,$0,$L662
+$L663:
+	beq	$2,$0,$L661
 	lui	$5,%hi($LC1)
 
 	lw	$2,44($2)
-	j	$L664
+	j	$L663
 	addiu	$6,$6,1
 
-$L662:
+$L661:
 	addu	$4,$4,$16
 	jal	sprintf
 	addiu	$5,$5,%lo($LC1)
@@ -4362,8 +4384,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L670:
-$L711:
+$L669:
+$L710:
 	addiu	$sp,$sp,-64
 	lui	$2,%hi(malloc_sizes+4)
 	sw	$21,52($sp)
@@ -4383,11 +4405,11 @@
 
 	li	$3,-1			# 0xffffffff
 	move	$17,$2
-	beq	$2,$0,$L665
+	beq	$2,$0,$L664
 	sw	$2,%lo(table_napt)($16)
 
-$L721:
-$L762:
+$L720:
+$L761:
 	lui	$2,%hi(napt_list_inuse)
 	lui	$20,%hi(napt_list_free)
 	sll	$4,$18,1
@@ -4409,22 +4431,22 @@
 	sw	$2,0($17)
 	lw	$2,%lo(table_napt)($16)
 	lw	$2,0($2)
-	beq	$2,$0,$L665
+	beq	$2,$0,$L664
 	li	$3,-1			# 0xffffffff
 
-	j	$L765
+	j	$L764
 	move	$16,$0
 
-$L829:
-	j	$L665
+$L828:
+	j	$L664
 	li	$3,-2			# 0xfffffffe
 
-$L765:
-	blez	$18,$L826
+$L764:
+	blez	$18,$L825
 	nop
 
 	move	$4,$0
-$L770:
+$L769:
 	lw	$2,%lo(table_napt)($19)
 	addiu	$16,$16,1
 	slt	$3,$16,$18
@@ -4439,16 +4461,16 @@
 	lw	$2,0($2)
 	addu	$2,$4,$2
 	addiu	$4,$4,12
-	bne	$3,$0,$L770
+	bne	$3,$0,$L769
 	sw	$2,4($2)
 
-$L826:
-	blez	$21,$L828
+$L825:
+	blez	$21,$L827
 	move	$16,$0
 
-$L824:
-$L778:
-$L819:
+$L823:
+$L777:
+$L818:
 	lui	$2,%hi(malloc_sizes+12)
 	li	$5,32			# 0x20
 	lw	$4,%lo(malloc_sizes+12)($2)
@@ -4458,7 +4480,7 @@
 	addiu	$4,$20,%lo(napt_list_free)
 	move	$3,$2
 	addiu	$5,$2,44
-	beq	$2,$0,$L829
+	beq	$2,$0,$L828
 	slt	$6,$16,$21
 
 	sw	$0,44($2)
@@ -4469,12 +4491,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L824
+	bne	$6,$0,$L823
 	sw	$2,8($4)
 
-$L828:
+$L827:
 	move	$3,$0
-$L665:
+$L664:
 	lw	$31,56($sp)
 	move	$2,$3
 	lw	$21,52($sp)
@@ -4502,8 +4524,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L835:
-$L876:
+$L834:
+$L875:
 	addiu	$sp,$sp,-64
 	lui	$2,%hi(malloc_sizes+4)
 	sw	$21,52($sp)
@@ -4523,11 +4545,11 @@
 
 	li	$3,-1			# 0xffffffff
 	move	$17,$2
-	beq	$2,$0,$L830
+	beq	$2,$0,$L829
 	sw	$2,%lo(table_path)($16)
 
-$L886:
-$L927:
+$L885:
+$L926:
 	lui	$2,%hi(path_list_inuse)
 	lui	$20,%hi(path_list_free)
 	sll	$4,$18,1
@@ -4549,22 +4571,22 @@
 	sw	$2,0($17)
 	lw	$2,%lo(table_path)($16)
 	lw	$2,0($2)
-	beq	$2,$0,$L830
+	beq	$2,$0,$L829
 	li	$3,-1			# 0xffffffff
 
-	j	$L930
+	j	$L929
 	move	$16,$0
 
-$L994:
-	j	$L830
+$L993:
+	j	$L829
 	li	$3,-2			# 0xfffffffe
 
-$L930:
-	blez	$18,$L991
+$L929:
+	blez	$18,$L990
 	nop
 
 	move	$4,$0
-$L935:
+$L934:
 	lw	$2,%lo(table_path)($19)
 	addiu	$16,$16,1
 	slt	$3,$16,$18
@@ -4579,16 +4601,16 @@
 	lw	$2,0($2)
 	addu	$2,$4,$2
 	addiu	$4,$4,12
-	bne	$3,$0,$L935
+	bne	$3,$0,$L934
 	sw	$2,4($2)
 
-$L991:
-	blez	$21,$L993
+$L990:
+	blez	$21,$L992
 	move	$16,$0
 
-$L989:
-$L943:
-$L984:
+$L988:
+$L942:
+$L983:
 	lui	$2,%hi(malloc_sizes+20)
 	li	$5,32			# 0x20
 	lw	$4,%lo(malloc_sizes+20)($2)
@@ -4598,7 +4620,7 @@
 	addiu	$4,$20,%lo(path_list_free)
 	move	$3,$2
 	addiu	$5,$2,72
-	beq	$2,$0,$L994
+	beq	$2,$0,$L993
 	slt	$6,$16,$21
 
 	sw	$0,72($2)
@@ -4609,12 +4631,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L989
+	bne	$6,$0,$L988
 	sw	$2,8($4)
 
-$L993:
+$L992:
 	move	$3,$0
-$L830:
+$L829:
 	lw	$31,56($sp)
 	move	$2,$3
 	lw	$21,52($sp)
Index: fastpath/96C_MP/fastpath_core.S
===================================================================
--- fastpath/96C_MP/fastpath_core.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/96C_MP/fastpath_core.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -2822,10 +2822,10 @@
 	.fmask	0x00000000,0
 	addiu	$sp,$sp,-88
 	sw	$23,76($sp)
-	sw	$22,72($sp)
+	sw	$21,68($sp)
 	sw	$31,84($sp)
 	sw	$fp,80($sp)
-	sw	$21,68($sp)
+	sw	$22,72($sp)
 	sw	$20,64($sp)
 	sw	$19,60($sp)
 	sw	$18,56($sp)
@@ -2833,23 +2833,23 @@
 	sw	$16,48($sp)
 	lw	$18,152($4)
 	li	$2,1			# 0x1
-	sw	$2,24($sp)
-	lbu	$21,9($18)
+	sw	$2,32($sp)
+	lbu	$20,9($18)
 	li	$2,6			# 0x6
-	move	$23,$4
-	sw	$0,28($sp)
-	sw	$0,32($sp)
+	move	$21,$4
+	sw	$0,36($sp)
+	sw	$0,40($sp)
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L462
-	move	$22,$0
+	beq	$20,$2,$L462
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$2,17			# 0x11
 	.set	noreorder
 	.set	nomacro
-	bne	$21,$2,$L459
+	bne	$20,$2,$L459
 	move	$4,$0
 	.set	macro
 	.set	reorder
@@ -2857,14 +2857,14 @@
 $L462:
 	lbu	$2,0($18)
 	move	$4,$18
-	move	$6,$23
+	move	$6,$21
 	andi	$2,$2,0xf
 	sll	$2,$2,2
-	addu	$fp,$18,$2
+	addu	$22,$18,$2
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_pre_process_check
-	move	$5,$fp
+	move	$5,$22
 	.set	macro
 	.set	reorder
 
@@ -2872,16 +2872,18 @@
 	move	$4,$2
 	li	$2,6			# 0x6
 	bne	$5,$2,$L459
-	lhu	$7,6($18)
+	lhu	$3,0($22)
+	lhu	$16,6($18)
 	lw	$19,12($18)
-	lw	$20,16($18)
-	andi	$6,$7,0xffff
-	lhu	$10,0($fp)
-	lhu	$11,2($fp)
-	lw	$3,24($23)
+	lw	$fp,16($18)
+	sw	$3,24($sp)
+	lhu	$4,2($22)
+	#nop
+	sw	$4,28($sp)
+	lw	$3,24($21)
 	.set	noreorder
 	.set	nomacro
-	bne	$21,$5,$L464
+	bne	$20,$5,$L464
 	lui	$4,%hi($LC0)
 	.set	macro
 	.set	reorder
@@ -2911,7 +2913,7 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$6,0x3fff
+	andi	$2,$16,0x3fff
 	.set	noreorder
 	.set	nomacro
 	beq	$2,$0,$L470
@@ -2919,7 +2921,7 @@
 	.set	macro
 	.set	reorder
 
-	xori	$2,$6,0x2000
+	xori	$2,$16,0x2000
 	.set	noreorder
 	.set	nomacro
 	j	$L470
@@ -2927,7 +2929,7 @@
 	.set	macro
 	.set	reorder
 
-$L639:
+$L640:
 	lw	$5,24($4)
 	lhu	$7,30($4)
 	j	$L475
@@ -2935,13 +2937,13 @@
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L655
-	andi	$2,$7,0x3fff
+	bne	$3,$2,$L471
+	li	$2,65536			# 0x10000
 	.set	macro
 	.set	reorder
 
-	lw	$3,12($fp)
-	li	$2,65536			# 0x10000
+	lw	$3,12($22)
+	#nop
 	and	$2,$3,$2
 	.set	noreorder
 	.set	nomacro
@@ -2950,17 +2952,19 @@
 	.set	macro
 	.set	reorder
 
+	lw	$4,24($sp)
+	lw	$5,28($sp)
 	srl	$2,$19,8
-	srl	$3,$20,16
-	andi	$9,$10,0xffff
-	xor	$3,$3,$20
+	srl	$3,$fp,16
+	andi	$9,$4,0xffff
+	xor	$3,$3,$fp
 	xor	$2,$2,$19
 	xor	$2,$2,$3
 	srl	$3,$9,4
 	xor	$2,$2,$3
-	andi	$8,$11,0xffff
+	andi	$8,$5,0xffff
 	lui	$10,%hi(path_table_list_max)
-	andi	$6,$21,0xffff
+	andi	$6,$20,0xffff
 	xor	$2,$2,$8
 	lw	$3,%lo(path_table_list_max)($10)
 	xor	$2,$2,$6
@@ -2991,7 +2995,7 @@
 	bne	$2,$19,$L476
 	lw	$2,20($4)
 	#nop
-	bne	$2,$20,$L476
+	bne	$2,$fp,$L476
 	lbu	$2,0($4)
 	#nop
 	.set	noreorder
@@ -3005,7 +3009,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L639
+	beq	$3,$2,$L640
 	sb	$0,0($4)
 	.set	macro
 	.set	reorder
@@ -3041,16 +3045,16 @@
 	.set	macro
 	.set	reorder
 
-	srl	$2,$20,8
+	srl	$2,$fp,8
 	srl	$3,$5,16
 	xor	$3,$3,$5
-	xor	$2,$2,$20
+	xor	$2,$2,$fp
 	xor	$2,$2,$3
 	srl	$3,$8,4
 	xor	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L645
+	j	$L646
 	xor	$2,$2,$7
 	.set	macro
 	.set	reorder
@@ -3063,7 +3067,7 @@
 	srl	$3,$7,4
 	xor	$2,$2,$3
 	xor	$2,$2,$9
-$L645:
+$L646:
 	lw	$4,%lo(path_table_list_max)($10)
 	xor	$2,$2,$6
 	srl	$3,$2,12
@@ -3083,7 +3087,7 @@
 $L491:
 	lw	$2,24($4)
 	#nop
-	bne	$2,$20,$L489
+	bne	$2,$fp,$L489
 	lw	$2,28($4)
 	#nop
 	bne	$2,$8,$L489
@@ -3118,13 +3122,29 @@
 	.set	macro
 	.set	reorder
 
+$L471:
+	lw	$2,12($22)
+	li	$3,1048576			# 0x100000
+	and	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	j	$L655
-	andi	$2,$7,0x3fff
+	beq	$2,$0,$L494
+	li	$2,40			# 0x28
 	.set	macro
 	.set	reorder
 
+	lhu	$3,2($18)
+	#nop
+	bne	$3,$2,$L494
+	move	$4,$21
+	.set	noreorder
+	.set	nomacro
+	jal	skb_trim
+	li	$5,40			# 0x28
+	.set	macro
+	.set	reorder
+
+	j	$L494
 $L464:
 	addiu	$2,$4,%lo($LC0)
 	move	$5,$3
@@ -3151,53 +3171,56 @@
 	.set	macro
 	.set	reorder
 
-	andi	$2,$7,0x3fff
-$L655:
+$L494:
+	lhu	$2,6($18)
+	#nop
+	andi	$2,$2,0x3fff
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L657
-	srl	$3,$20,16
+	beq	$2,$0,$L497
+	li	$2,8192			# 0x2000
 	.set	macro
 	.set	reorder
 
-	li	$2,8192			# 0x2000
 	.set	noreorder
 	.set	nomacro
-	bne	$6,$2,$L497
-	andi	$2,$6,0x2000
+	bne	$16,$2,$L498
+	andi	$2,$16,0x2000
 	.set	macro
 	.set	reorder
 
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	j	$L498
-	sw	$2,28($sp)
+	j	$L499
+	sw	$2,36($sp)
 	.set	macro
 	.set	reorder
 
-$L497:
+$L498:
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L498
-	andi	$3,$6,0x1fff
+	bne	$2,$0,$L499
+	andi	$3,$16,0x1fff
 	.set	macro
 	.set	reorder
 
-	lw	$4,32($sp)
+	lw	$4,40($sp)
 	li	$2,1			# 0x1
 	movn	$4,$2,$3		#RLX4181/RLX4281:conditional move
-	sw	$4,32($sp)
-$L498:
+	sw	$4,40($sp)
+$L499:
+	lw	$9,12($18)
+	lw	$8,16($18)
 	lhu	$7,4($18)
-	xor	$3,$19,$20
+	andi	$6,$20,0x00ff
+	xor	$3,$9,$8
 	srl	$2,$3,16
 	xor	$2,$2,$7
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$5,%lo(max_udp_frag_entry)($2)
 	srl	$4,$3,8
-	andi	$6,$21,0x00ff
 	lui	$2,%hi(udp_cache_table)
 	xor	$4,$4,$6
 	lw	$2,%lo(udp_cache_table)($2)
@@ -3213,87 +3236,90 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L507
-	move	$22,$0
+	beq	$4,$0,$L508
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
 	li	$3,1			# 0x1
-$L506:
+$L507:
 	lhu	$2,2($4)
 	#nop
-	bne	$2,$7,$L503
+	bne	$2,$7,$L504
 	lw	$2,4($4)
 	#nop
-	bne	$2,$19,$L503
+	bne	$2,$9,$L504
 	lw	$2,8($4)
 	#nop
-	bne	$2,$20,$L503
+	bne	$2,$8,$L504
 	lbu	$2,1($4)
 	#nop
-	bne	$2,$6,$L503
+	bne	$2,$6,$L504
 	lbu	$2,0($4)
 	#nop
-	beq	$2,$3,$L640
-$L503:
+	beq	$2,$3,$L641
+$L504:
 	lw	$4,40($4)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$4,$0,$L506
-	move	$22,$0
+	bne	$4,$0,$L507
+	move	$23,$0
 	.set	macro
 	.set	reorder
 
-	j	$L507
-$L640:
+	j	$L508
+$L641:
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L507
-	move	$22,$4
+	beq	$4,$0,$L508
+	move	$23,$4
 	.set	macro
 	.set	reorder
 
-	lw	$5,28($sp)
-	lhu	$10,12($4)
-	lhu	$11,14($4)
+	lhu	$5,12($4)
+	lw	$3,36($sp)
+	sw	$5,24($sp)
+	lhu	$2,14($4)
 	.set	noreorder
 	.set	nomacro
-	bne	$5,$0,$L657
-	srl	$3,$20,16
+	bne	$3,$0,$L497
+	sw	$2,28($sp)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L657
-	sw	$0,24($sp)
+	j	$L497
+	sw	$0,32($sp)
 	.set	macro
 	.set	reorder
 
-$L507:
-	lw	$2,28($sp)
+$L508:
+	lw	$5,36($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L459
+	beq	$5,$0,$L459
 	move	$4,$0
 	.set	macro
 	.set	reorder
 
-	srl	$3,$20,16
-$L657:
+$L497:
+	lw	$4,24($sp)
+	srl	$3,$fp,16
 	srl	$2,$19,8
-	sw	$3,36($sp)
+	sw	$3,44($sp)
+	lw	$5,28($sp)
+	xor	$3,$3,$fp
 	xor	$2,$2,$19
-	xor	$3,$3,$20
 	xor	$2,$2,$3
-	srl	$3,$10,4
+	srl	$3,$4,4
 	xor	$2,$2,$3
 	lui	$3,%hi(path_table_list_max)
+	xor	$2,$2,$5
 	lw	$4,%lo(path_table_list_max)($3)
-	xor	$2,$2,$11
-	xor	$2,$2,$21
+	xor	$2,$2,$20
 	lui	$3,%hi(table_path)
 	lw	$5,%lo(table_path)($3)
 	srl	$3,$2,12
@@ -3307,28 +3333,30 @@
 	addu	$2,$2,$3
 	lw	$16,0($2)
 	#nop
-$L646:
+$L647:
 	.set	noreorder
 	.set	nomacro
-	beq	$16,$0,$L638
+	beq	$16,$0,$L639
 	move	$4,$18
 	.set	macro
 	.set	reorder
 
 	lw	$2,12($16)
+	lw	$3,24($sp)
 	#nop
-	bne	$2,$10,$L514
+	bne	$2,$3,$L515
 	lw	$2,8($16)
+	lw	$4,28($sp)
 	#nop
-	bne	$2,$11,$L514
+	bne	$2,$4,$L515
 	lw	$2,16($16)
 	#nop
-	bne	$2,$19,$L514
+	bne	$2,$19,$L515
 	lw	$2,20($16)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$20,$L514
+	bne	$2,$fp,$L515
 	li	$2,255			# 0xff
 	.set	macro
 	.set	reorder
@@ -3337,7 +3365,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L514
+	bne	$3,$2,$L515
 	li	$2,2			# 0x2
 	.set	macro
 	.set	reorder
@@ -3346,7 +3374,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L658
+	bne	$3,$2,$L657
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
@@ -3354,28 +3382,26 @@
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L516
+	beq	$20,$2,$L517
 	li	$2,1			# 0x1
 	.set	macro
 	.set	reorder
 
-$L658:
+$L657:
 	.set	noreorder
 	.set	nomacro
-	bne	$3,$2,$L514
+	bne	$3,$2,$L515
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L514
-$L516:
+	bne	$20,$2,$L515
+$L517:
 	lw	$5,32($16)
 	lbu	$7,1($18)
-	lw	$2,24($23)
-	move	$4,$23
+	lw	$2,24($21)
+	move	$4,$21
 	move	$6,$19
-	sw	$10,40($sp)
-	sw	$11,44($sp)
 	.set	noreorder
 	.set	nomacro
 	jal	ip_route_input
@@ -3383,8 +3409,6 @@
 	.set	macro
 	.set	reorder
 
-	lw	$10,40($sp)
-	lw	$11,44($sp)
 	.set	noreorder
 	.set	nomacro
 	bne	$2,$0,$L459
@@ -3392,44 +3416,44 @@
 	.set	macro
 	.set	reorder
 
-	lw	$3,28($23)
+	lw	$3,28($21)
 	#nop
 	lw	$2,48($3)
 	#nop
-	bne	$2,$0,$L521
+	bne	$2,$0,$L522
 	lw	$2,44($3)
 	#nop
-	beq	$2,$0,$L653
-$L521:
+	beq	$2,$0,$L654
+$L522:
 	lw	$2,72($3)
-	lw	$3,84($23)
+	lw	$3,84($21)
 	#nop
 	sltu	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L653
+	bne	$2,$0,$L654
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$21,$2,$L525
-	addiu	$17,$fp,16
+	beq	$20,$2,$L526
+	addiu	$17,$22,16
 	.set	macro
 	.set	reorder
 
-	lhu	$3,6($fp)
-	addiu	$2,$fp,6
+	lhu	$3,6($22)
+	addiu	$2,$22,6
 	move	$17,$0
 	movn	$17,$2,$3		#RLX4181/RLX4281:conditional move  
-$L525:
-	lw	$4,28($sp)
+$L526:
+	lw	$5,36($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L528
-	xor	$3,$19,$20
+	beq	$5,$0,$L529
+	xor	$3,$19,$fp
 	.set	macro
 	.set	reorder
 
@@ -3439,34 +3463,36 @@
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$4,%lo(max_udp_frag_entry)($2)
-	lui	$8,%hi(udp_cache_list_free)
+	andi	$5,$20,0x00ff
 	srl	$2,$3,8
-	andi	$5,$21,0x00ff
-	lw	$7,%lo(udp_cache_list_free)($8)
 	xor	$2,$2,$5
 	xor	$3,$3,$2
 	addiu	$4,$4,-1
+	lui	$8,%hi(udp_cache_list_free)
 	and	$9,$3,$4
-	andi	$2,$11,0xffff
+	lw	$2,24($sp)
+	lw	$4,28($sp)
+	lw	$7,%lo(udp_cache_list_free)($8)
+	andi	$3,$2,0xffff
 	.set	noreorder
 	.set	nomacro
-	bne	$7,$0,$L531
-	andi	$3,$10,0xffff
+	bne	$7,$0,$L532
+	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
 
-$L653:
-	lw	$4,28($23)
+$L654:
+	lw	$4,28($21)
 	jal	dst_release
 	move	$4,$0
 	.set	noreorder
 	.set	nomacro
 	j	$L459
-	sw	$0,28($23)
+	sw	$0,28($21)
 	.set	macro
 	.set	reorder
 
-$L531:
+$L532:
 	lw	$4,48($7)
 	sh	$2,14($7)
 	li	$2,1
@@ -3475,25 +3501,25 @@
 	sb	$5,1($7)
 	sb	$2,0($7)
 	sw	$19,4($7)
-	sw	$20,8($7)
+	sw	$fp,8($7)
 	lw	$3,52($7)
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L534
+	beq	$4,$0,$L535
 	addiu	$2,$8,%lo(udp_cache_list_free)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L535
+	j	$L536
 	sw	$3,52($4)
 	.set	macro
 	.set	reorder
 
-$L534:
+$L535:
 	sw	$3,4($2)
-$L535:
+$L536:
 	lw	$3,52($7)
 	lw	$2,48($7)
 	addiu	$4,$8,%lo(udp_cache_list_free)
@@ -3551,60 +3577,60 @@
 	.set	noreorder
 	.set	nomacro
 	j	$L656
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
-$L528:
-	lw	$5,32($sp)
+$L529:
+	lw	$5,40($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
 	beq	$5,$0,$L656
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
 	jal	del_timer
-	addiu	$4,$22,16
+	addiu	$4,$23,16
 	.set	macro
 	.set	reorder
 
-	lw	$2,8($22)
-	lw	$3,4($22)
-	lhu	$4,2($22)
-	lbu	$5,1($22)
+	lw	$2,8($23)
+	lw	$3,4($23)
+	lhu	$4,2($23)
+	lbu	$5,1($23)
 	xor	$3,$3,$2
 	srl	$2,$3,16
 	xor	$2,$2,$4
 	xor	$3,$3,$2
 	lui	$2,%hi(max_udp_frag_entry)
 	lw	$4,%lo(max_udp_frag_entry)($2)
-	lw	$6,40($22)
+	lw	$6,40($23)
 	srl	$2,$3,8
 	xor	$2,$2,$5
 	addiu	$4,$4,-1
 	xor	$3,$3,$2
 	and	$5,$3,$4
-	sb	$0,0($22)
-	lw	$4,44($22)
+	sb	$0,0($23)
+	lw	$4,44($23)
 	.set	noreorder
 	.set	nomacro
-	beq	$6,$0,$L541
+	beq	$6,$0,$L542
 	lui	$2,%hi(udp_cache_table)
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	j	$L542
+	j	$L543
 	sw	$4,44($6)
 	.set	macro
 	.set	reorder
 
-$L541:
+$L542:
 	lw	$3,%lo(udp_cache_table)($2)
 	sll	$2,$5,1
 	addu	$2,$2,$5
@@ -3612,9 +3638,9 @@
 	sll	$2,$2,2
 	addu	$2,$2,$3
 	sw	$4,4($2)
-$L542:
-	lw	$4,44($22)
-	lw	$2,40($22)
+$L543:
+	lw	$4,44($23)
+	lw	$2,40($23)
 	sll	$3,$5,1
 	addu	$3,$3,$5
 	sw	$2,0($4)
@@ -3624,30 +3650,30 @@
 	lui	$4,%hi(udp_cache_list_free)
 	lw	$2,0($2)
 	addiu	$4,$4,%lo(udp_cache_list_free)
-	addiu	$5,$22,48
+	addiu	$5,$23,48
 	addu	$3,$3,$2
 	lw	$2,8($3)
 	#nop
 	addiu	$2,$2,-1
 	sw	$2,8($3)
-	sw	$0,48($22)
+	sw	$0,48($23)
 	lw	$2,4($4)
 	#nop
-	sw	$2,52($22)
+	sw	$2,52($23)
 	lw	$2,4($4)
 	#nop
-	sw	$22,0($2)
+	sw	$23,0($2)
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
 	sw	$2,8($4)
-	move	$4,$23
+	move	$4,$21
 $L656:
 	move	$5,$18
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_before_nat_check
-	move	$6,$21
+	move	$6,$20
 	.set	macro
 	.set	reorder
 
@@ -3660,35 +3686,35 @@
 	sltu	$2,$3,13
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L607
+	beq	$2,$0,$L608
 	sll	$2,$3,2
 	.set	macro
 	.set	reorder
 
-	lui	$3,%hi($L630)
-	addiu	$3,$3,%lo($L630)
+	lui	$3,%hi($L631)
+	addiu	$3,$3,%lo($L631)
 	addu	$2,$2,$3
 	lw	$2,0($2)
 	#nop
 	j	$2
 	.rdata
 	.align	2
-$L630:
-	.word	$L547
-	.word	$L549
-	.word	$L564
-	.word	$L564
-	.word	$L578
-	.word	$L607
-	.word	$L607
-	.word	$L607
-	.word	$L593
-	.word	$L607
-	.word	$L607
-	.word	$L607
-	.word	$L593
+$L631:
+	.word	$L548
+	.word	$L550
+	.word	$L565
+	.word	$L565
+	.word	$L579
+	.word	$L608
+	.word	$L608
+	.word	$L608
+	.word	$L594
+	.word	$L608
+	.word	$L608
+	.word	$L608
+	.word	$L594
 	.section	.text.enter_fast_path
-$L549:
+$L550:
 	lw	$2,24($16)
 	srl	$3,$19,16
 	andi	$6,$19,0xffff
@@ -3701,7 +3727,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L551
+	bgez	$6,$L552
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3715,32 +3741,32 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L550
+	j	$L551
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L551:
+$L552:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L550:
-	lw	$2,24($sp)
+$L551:
+	lw	$2,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L568
+	beq	$2,$0,$L569
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L554
-	beq	$17,$0,$L568
+	bne	$20,$2,$L555
+	beq	$17,$0,$L569
 	lhu	$6,0($17)
 	#nop
-	beq	$6,$0,$L568
+	beq	$6,$0,$L569
 	lw	$2,12($18)
 	lw	$3,24($16)
 	srl	$4,$2,16
@@ -3753,7 +3779,7 @@
 	addu	$5,$5,$6
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L557
+	bgez	$5,$L558
 	sra	$3,$5,16
 	.set	macro
 	.set	reorder
@@ -3766,24 +3792,24 @@
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L647
+	j	$L648
 	nor	$2,$0,$5
 	.set	macro
 	.set	reorder
 
-$L557:
+$L558:
 	andi	$2,$5,0xffff
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L568
+	j	$L569
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L554:
+$L555:
 	lw	$4,12($18)
 	lw	$3,24($16)
 	lhu	$5,0($17)
@@ -3797,7 +3823,7 @@
 	addu	$4,$4,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L561
+	bgez	$4,$L562
 	andi	$2,$4,0xffff
 	.set	macro
 	.set	reorder
@@ -3809,27 +3835,27 @@
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	nor	$2,$0,$4
-$L647:
+$L648:
 	.set	noreorder
 	.set	nomacro
-	j	$L568
+	j	$L569
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L561:
+$L562:
 	sra	$3,$4,16
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L568
+	j	$L569
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L564:
+$L565:
 	lw	$2,24($16)
 	srl	$3,$19,16
 	andi	$6,$19,0xffff
@@ -3842,7 +3868,7 @@
 	addu	$6,$6,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L566
+	bgez	$6,$L567
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3856,35 +3882,35 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L565
+	j	$L566
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L566:
+$L567:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,10($18)
-$L565:
-	lw	$3,24($sp)
+$L566:
+	lw	$3,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L568
+	beq	$3,$0,$L569
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L569
-	beq	$17,$0,$L574
+	bne	$20,$2,$L570
+	beq	$17,$0,$L575
 	lhu	$6,0($17)
 	#nop
-	beq	$6,$0,$L574
+	beq	$6,$0,$L575
 	lw	$4,12($18)
 	lw	$3,24($16)
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	srl	$2,$4,16
 	andi	$4,$4,0xffff
 	addu	$4,$4,$2
@@ -3898,7 +3924,7 @@
 	addu	$4,$4,$6
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L572
+	bgez	$4,$L573
 	sra	$3,$4,16
 	.set	macro
 	.set	reorder
@@ -3911,27 +3937,27 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L648
+	j	$L649
 	nor	$2,$0,$4
 	.set	macro
 	.set	reorder
 
-$L572:
+$L573:
 	andi	$2,$4,0xffff
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L574
+	j	$L575
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L569:
+$L570:
 	lw	$4,12($18)
 	lw	$3,24($16)
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	srl	$2,$4,16
 	andi	$6,$4,0xffff
 	addu	$6,$6,$2
@@ -3946,7 +3972,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L576
+	bgez	$6,$L577
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -3958,37 +3984,37 @@
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	nor	$2,$0,$6
-$L648:
+$L649:
 	.set	noreorder
 	.set	nomacro
-	j	$L574
+	j	$L575
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L576:
+$L577:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L574:
+$L575:
 	lw	$2,28($16)
 	#nop
-	sh	$2,0($fp)
-$L568:
+	sh	$2,0($22)
+$L569:
 	lw	$2,24($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L547
+	j	$L548
 	sw	$2,12($18)
 	.set	macro
 	.set	reorder
 
-$L578:
+$L579:
 	lw	$2,32($16)
-	lw	$4,36($sp)
-	andi	$6,$20,0xffff
+	lw	$4,44($sp)
+	andi	$6,$fp,0xffff
 	andi	$3,$2,0xffff
 	addu	$5,$6,$4
 	lhu	$4,10($18)
@@ -3998,7 +4024,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L580
+	bgez	$5,$L581
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4012,34 +4038,34 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L579
+	j	$L580
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L580:
+$L581:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L579:
-	lw	$5,24($sp)
+$L580:
+	lw	$5,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$5,$0,$L652
+	beq	$5,$0,$L653
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L583
-	beq	$17,$0,$L652
+	bne	$20,$2,$L584
+	beq	$17,$0,$L653
 	lhu	$5,0($17)
 	#nop
-	beq	$5,$0,$L652
+	beq	$5,$0,$L653
 	lw	$2,32($16)
-	lw	$3,36($sp)
+	lw	$3,44($sp)
 	#nop
 	addu	$4,$6,$3
 	andi	$3,$2,0xffff
@@ -4049,7 +4075,7 @@
 	addu	$4,$4,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$4,$L586
+	bgez	$4,$L587
 	sra	$3,$4,16
 	.set	macro
 	.set	reorder
@@ -4062,26 +4088,26 @@
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L649
+	j	$L650
 	nor	$2,$0,$4
 	.set	macro
 	.set	reorder
 
-$L586:
+$L587:
 	andi	$2,$4,0xffff
 	addu	$4,$3,$2
 	sra	$2,$4,16
 	addu	$4,$4,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L652
+	j	$L653
 	sh	$4,0($17)
 	.set	macro
 	.set	reorder
 
-$L583:
+$L584:
 	lw	$2,32($16)
-	lw	$4,36($sp)
+	lw	$4,44($sp)
 	andi	$3,$2,0xffff
 	addu	$5,$6,$4
 	lhu	$4,0($17)
@@ -4091,7 +4117,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L590
+	bgez	$5,$L591
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4103,30 +4129,30 @@
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	nor	$2,$0,$5
-$L649:
+$L650:
 	.set	noreorder
 	.set	nomacro
-	j	$L652
+	j	$L653
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L590:
+$L591:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L652
+	j	$L653
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L593:
+$L594:
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	andi	$6,$20,0xffff
+	lw	$3,44($sp)
+	andi	$6,$fp,0xffff
 	lhu	$4,10($18)
 	addu	$5,$6,$3
 	andi	$3,$2,0xffff
@@ -4136,7 +4162,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L595
+	bgez	$5,$L596
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4150,35 +4176,35 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L594
+	j	$L595
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L595:
+$L596:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L594:
-	lw	$4,24($sp)
+$L595:
+	lw	$4,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L652
+	beq	$4,$0,$L653
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L598
-	beq	$17,$0,$L603
+	bne	$20,$2,$L599
+	beq	$17,$0,$L604
 	lhu	$7,0($17)
 	#nop
-	beq	$7,$0,$L603
+	beq	$7,$0,$L604
 	lw	$3,32($16)
-	lw	$2,36($sp)
-	lhu	$4,2($fp)
+	lw	$2,44($sp)
+	lhu	$4,2($22)
 	addu	$5,$6,$2
 	andi	$2,$3,0xffff
 	subu	$5,$5,$2
@@ -4190,7 +4216,7 @@
 	addu	$5,$5,$7
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L601
+	bgez	$5,$L602
 	sra	$3,$5,16
 	.set	macro
 	.set	reorder
@@ -4203,27 +4229,27 @@
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L650
+	j	$L651
 	nor	$2,$0,$5
 	.set	macro
 	.set	reorder
 
-$L601:
+$L602:
 	andi	$2,$5,0xffff
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	.set	noreorder
 	.set	nomacro
-	j	$L603
+	j	$L604
 	sh	$5,0($17)
 	.set	macro
 	.set	reorder
 
-$L598:
+$L599:
 	lw	$3,32($16)
-	lw	$4,36($sp)
-	lhu	$5,2($fp)
+	lw	$4,44($sp)
+	lhu	$5,2($22)
 	andi	$2,$3,0xffff
 	addu	$6,$6,$4
 	subu	$6,$6,$2
@@ -4236,7 +4262,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L605
+	bgez	$6,$L606
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4248,30 +4274,30 @@
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	nor	$2,$0,$6
-$L650:
+$L651:
 	.set	noreorder
 	.set	nomacro
-	j	$L603
+	j	$L604
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L605:
+$L606:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L603:
+$L604:
 	lw	$2,36($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L652
-	sh	$2,2($fp)
+	j	$L653
+	sh	$2,2($22)
 	.set	macro
 	.set	reorder
 
-$L607:
+$L608:
 	lw	$2,24($16)
 	srl	$7,$19,16
 	andi	$6,$19,0xffff
@@ -4284,7 +4310,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L609
+	bgez	$5,$L610
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4298,21 +4324,21 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L608
+	j	$L609
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L609:
+$L610:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L608:
+$L609:
 	lw	$2,32($16)
-	lw	$3,36($sp)
-	andi	$8,$20,0xffff
+	lw	$3,44($sp)
+	andi	$8,$fp,0xffff
 	lhu	$4,10($18)
 	addu	$5,$8,$3
 	andi	$3,$2,0xffff
@@ -4322,7 +4348,7 @@
 	addu	$5,$5,$4
 	.set	noreorder
 	.set	nomacro
-	bgez	$5,$L612
+	bgez	$5,$L613
 	andi	$2,$5,0xffff
 	.set	macro
 	.set	reorder
@@ -4336,35 +4362,35 @@
 	nor	$2,$0,$5
 	.set	noreorder
 	.set	nomacro
-	j	$L611
+	j	$L612
 	sh	$2,10($18)
 	.set	macro
 	.set	reorder
 
-$L612:
+$L613:
 	sra	$3,$5,16
 	addu	$5,$3,$2
 	sra	$2,$5,16
 	addu	$5,$5,$2
 	sh	$5,10($18)
-$L611:
-	lw	$4,24($sp)
+$L612:
+	lw	$4,32($sp)
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$4,$0,$L614
+	beq	$4,$0,$L615
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$21,$2,$L615
-	beq	$17,$0,$L623
+	bne	$20,$2,$L616
+	beq	$17,$0,$L624
 	lhu	$5,0($17)
 	#nop
-	beq	$5,$0,$L623
+	beq	$5,$0,$L624
 	lw	$3,24($16)
 	addu	$6,$6,$7
-	lhu	$4,0($fp)
+	lhu	$4,0($22)
 	andi	$2,$3,0xffff
 	subu	$6,$6,$2
 	srl	$3,$3,16
@@ -4375,7 +4401,7 @@
 	addu	$6,$6,$5
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L618
+	bgez	$6,$L619
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4389,31 +4415,31 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L617
+	j	$L618
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L618:
+$L619:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L617:
-	lw	$5,36($sp)
+$L618:
+	lw	$5,44($sp)
 	lw	$3,32($16)
 	.set	noreorder
 	.set	nomacro
-	j	$L654
+	j	$L655
 	addu	$6,$8,$5
 	.set	macro
 	.set	reorder
 
-$L615:
+$L616:
 	lw	$3,24($16)
 	addu	$6,$6,$7
-	lhu	$5,0($fp)
+	lhu	$5,0($22)
 	andi	$2,$3,0xffff
 	subu	$6,$6,$2
 	srl	$3,$3,16
@@ -4425,7 +4451,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L625
+	bgez	$6,$L626
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4439,24 +4465,24 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L624
+	j	$L625
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L625:
+$L626:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L624:
-	lw	$2,36($sp)
+$L625:
+	lw	$2,44($sp)
 	lw	$3,32($16)
 	addu	$6,$8,$2
-$L654:
+$L655:
 	andi	$2,$3,0xffff
-	lhu	$5,2($fp)
+	lhu	$5,2($22)
 	subu	$6,$6,$2
 	srl	$3,$3,16
 	lw	$4,36($16)
@@ -4467,7 +4493,7 @@
 	addu	$6,$6,$2
 	.set	noreorder
 	.set	nomacro
-	bgez	$6,$L628
+	bgez	$6,$L629
 	andi	$2,$6,0xffff
 	.set	macro
 	.set	reorder
@@ -4481,60 +4507,60 @@
 	nor	$2,$0,$6
 	.set	noreorder
 	.set	nomacro
-	j	$L623
+	j	$L624
 	sh	$2,0($17)
 	.set	macro
 	.set	reorder
 
-$L628:
+$L629:
 	sra	$3,$6,16
 	addu	$6,$3,$2
 	sra	$2,$6,16
 	addu	$6,$6,$2
 	sh	$6,0($17)
-$L623:
+$L624:
 	lw	$2,28($16)
 	#nop
-	sh	$2,0($fp)
+	sh	$2,0($22)
 	lw	$2,36($16)
 	#nop
-	sh	$2,2($fp)
-$L614:
+	sh	$2,2($22)
+$L615:
 	lw	$2,24($16)
 	#nop
 	sw	$2,12($18)
-$L652:
+$L653:
 	lw	$2,32($16)
 	#nop
 	sw	$2,16($18)
-$L547:
-	lw	$3,104($23)
+$L548:
+	lw	$3,104($21)
 	li	$2,-805371904			# 0xffffffffcfff0000
-	lw	$4,28($23)
+	lw	$4,28($21)
 	ori	$2,$2,0xffff
 	and	$3,$3,$2
-	sw	$3,104($23)
+	sw	$3,104($21)
 	lw	$2,12($4)
 	#nop
-	sw	$2,24($23)
+	sw	$2,24($21)
 	lw	$5,48($16)
 	lw	$6,52($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fastpath_set_qos_mark
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
 	lui	$2,%hi(jiffies)
 	lw	$2,%lo(jiffies)($2)
 	move	$4,$18
-	move	$5,$fp
+	move	$5,$22
 	sw	$2,40($16)
 	.set	noreorder
 	.set	nomacro
 	jal	fast_path_post_process_xmit_check
-	move	$6,$23
+	move	$6,$21
 	.set	macro
 	.set	reorder
 
@@ -4549,7 +4575,7 @@
 	.set	noreorder
 	.set	nomacro
 	jal	ip_finish_output3
-	move	$4,$23
+	move	$4,$21
 	.set	macro
 	.set	reorder
 
@@ -4560,14 +4586,14 @@
 	.set	macro
 	.set	reorder
 
-$L514:
+$L515:
 	lw	$16,64($16)
-	j	$L646
-$L638:
-	lw	$2,24($23)
-	move	$5,$fp
-	sw	$2,136($23)
-	move	$6,$23
+	j	$L647
+$L639:
+	lw	$2,24($21)
+	move	$5,$22
+	sw	$2,136($21)
+	move	$6,$21
 	lw	$31,84($sp)
 	lw	$fp,80($sp)
 	lw	$23,76($sp)
@@ -4629,27 +4655,27 @@
 	lw	$2,%lo(path_list_inuse)($2)
 	move	$16,$5
 	move	$7,$0
-$L672:
-	beq	$2,$0,$L669
+$L671:
+	beq	$2,$0,$L668
 	move	$6,$0
 
 	lw	$2,72($2)
-	j	$L672
+	j	$L671
 	addiu	$7,$7,1
 
-$L669:
+$L668:
 	lui	$2,%hi(napt_list_inuse)
 	lw	$2,%lo(napt_list_inuse)($2)
 	nop
-$L673:
-	beq	$2,$0,$L671
+$L672:
+	beq	$2,$0,$L670
 	lui	$5,%hi($LC1)
 
 	lw	$2,44($2)
-	j	$L673
+	j	$L672
 	addiu	$6,$6,1
 
-$L671:
+$L670:
 	addu	$4,$4,$16
 	jal	sprintf
 	addiu	$5,$5,%lo($LC1)
@@ -4676,8 +4702,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L679:
-$L720:
+$L678:
+$L719:
 	addiu	$sp,$sp,-56
 	sw	$20,48($sp)
 	sw	$18,40($sp)
@@ -4696,11 +4722,11 @@
 	lui	$2,%hi(table_napt)
 	sw	$16,%lo(table_napt)($2)
 	move	$18,$2
-	beq	$16,$0,$L674
+	beq	$16,$0,$L673
 	li	$3,-1			# 0xffffffffffffffff
 
-$L730:
-$L771:
+$L729:
+$L770:
 	lui	$2,%hi(napt_list_inuse)
 	lui	$19,%hi(napt_list_free)
 	sll	$4,$17,1
@@ -4724,22 +4750,22 @@
 	nop
 	lw	$2,0($2)
 	nop
-	beq	$2,$0,$L674
+	beq	$2,$0,$L673
 	li	$3,-1			# 0xffffffffffffffff
 
-	j	$L774
+	j	$L773
 	move	$16,$0
 
-$L838:
-	j	$L674
+$L837:
+	j	$L673
 	li	$3,-2			# 0xfffffffffffffffe
 
-$L774:
-	blez	$17,$L835
+$L773:
+	blez	$17,$L834
 	nop
 
 	move	$4,$0
-$L779:
+$L778:
 	lw	$2,%lo(table_napt)($18)
 	addiu	$16,$16,1
 	slt	$3,$16,$17
@@ -4759,16 +4785,16 @@
 	nop
 	addu	$2,$4,$2
 	sw	$2,4($2)
-	bne	$3,$0,$L779
+	bne	$3,$0,$L778
 	addiu	$4,$4,12
 
-$L835:
-	blez	$20,$L837
+$L834:
+	blez	$20,$L836
 	move	$16,$0
 
-$L833:
-$L787:
-$L828:
+$L832:
+$L786:
+$L827:
 	lui	$2,%hi(malloc_sizes+12)
 	lw	$4,%lo(malloc_sizes+12)($2)
 	li	$5,32			# 0x20
@@ -4778,7 +4804,7 @@
 	move	$3,$2
 	addiu	$4,$19,%lo(napt_list_free)
 	addiu	$5,$2,44
-	beq	$2,$0,$L838
+	beq	$2,$0,$L837
 	slt	$6,$16,$20
 
 	sw	$0,44($2)
@@ -4791,12 +4817,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L833
+	bne	$6,$0,$L832
 	sw	$2,8($4)
 
-$L837:
+$L836:
 	move	$3,$0
-$L674:
+$L673:
 	lw	$31,52($sp)
 	lw	$20,48($sp)
 	lw	$19,44($sp)
@@ -4823,8 +4849,8 @@
 	.set	noreorder
 	.set	nomacro
 	
-$L844:
-$L885:
+$L843:
+$L884:
 	addiu	$sp,$sp,-56
 	sw	$20,48($sp)
 	sw	$18,40($sp)
@@ -4843,11 +4869,11 @@
 	lui	$2,%hi(table_path)
 	sw	$16,%lo(table_path)($2)
 	move	$18,$2
-	beq	$16,$0,$L839
+	beq	$16,$0,$L838
 	li	$3,-1			# 0xffffffffffffffff
 
-$L895:
-$L936:
+$L894:
+$L935:
 	lui	$2,%hi(path_list_inuse)
 	lui	$19,%hi(path_list_free)
 	sll	$4,$17,1
@@ -4871,22 +4897,22 @@
 	nop
 	lw	$2,0($2)
 	nop
-	beq	$2,$0,$L839
+	beq	$2,$0,$L838
 	li	$3,-1			# 0xffffffffffffffff
 
-	j	$L939
+	j	$L938
 	move	$16,$0
 
-$L1003:
-	j	$L839
+$L1002:
+	j	$L838
 	li	$3,-2			# 0xfffffffffffffffe
 
-$L939:
-	blez	$17,$L1000
+$L938:
+	blez	$17,$L999
 	nop
 
 	move	$4,$0
-$L944:
+$L943:
 	lw	$2,%lo(table_path)($18)
 	addiu	$16,$16,1
 	slt	$3,$16,$17
@@ -4906,16 +4932,16 @@
 	nop
 	addu	$2,$4,$2
 	sw	$2,4($2)
-	bne	$3,$0,$L944
+	bne	$3,$0,$L943
 	addiu	$4,$4,12
 
-$L1000:
-	blez	$20,$L1002
+$L999:
+	blez	$20,$L1001
 	move	$16,$0
 
-$L998:
-$L952:
-$L993:
+$L997:
+$L951:
+$L992:
 	lui	$2,%hi(malloc_sizes+20)
 	lw	$4,%lo(malloc_sizes+20)($2)
 	li	$5,32			# 0x20
@@ -4925,7 +4951,7 @@
 	move	$3,$2
 	addiu	$4,$19,%lo(path_list_free)
 	addiu	$5,$2,72
-	beq	$2,$0,$L1003
+	beq	$2,$0,$L1002
 	slt	$6,$16,$20
 
 	sw	$0,72($2)
@@ -4938,12 +4964,12 @@
 	lw	$2,8($4)
 	sw	$5,4($4)
 	addiu	$2,$2,1
-	bne	$6,$0,$L998
+	bne	$6,$0,$L997
 	sw	$2,8($4)
 
-$L1002:
+$L1001:
 	move	$3,$0
-$L839:
+$L838:
 	lw	$31,52($sp)
 	lw	$20,48($sp)
 	lw	$19,44($sp)
Index: fastpath/Makefile
===================================================================
--- fastpath/Makefile	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ fastpath/Makefile	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -4,7 +4,7 @@
 
 #EXTRA_CFLAGS += -I $(DIR_LINUX)/drivers/net/rtl819x
 EXTRA_CFLAGS += -I $(DIR_LINUX)/net
-EXTRA_CFLAGS += -D__KERNEL__ -save-temps
+EXTRA_CFLAGS += -D__KERNEL__
 #EXTRA_CFLAGS += -Wno-implicit -Werror
 
 ifeq ($(CONFIG_RTL_8198),y)
Index: features/98/rtl_nf_connGC.S
===================================================================
--- features/98/rtl_nf_connGC.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ features/98/rtl_nf_connGC.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -282,11 +282,11 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
+	sltu	$3,$3,129
 	bne	$3,$0,$L8
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 $L8:
 	lui	$2,%hi(nf_conntrack_max)
@@ -391,11 +391,11 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
+	sltu	$3,$3,129
 	bne	$3,$0,$L24
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 $L24:
 	lui	$2,%hi(nf_conntrack_max)
@@ -438,6 +438,12 @@
 	.set	macro
 	.set	reorder
 	.end	conntrack_dointvec_minmax
+	.rdata
+	.align	2
+	.type	__func__.0, @object
+	.size	__func__.0, 17
+__func__.0:
+	.ascii	"clean_from_lists\000"
 	.section	.text.clean_from_lists,"ax",@progbits
 	.align	2
 	.globl	clean_from_lists
@@ -501,7 +507,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L54
+	beq	$2,$0,$L66
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
@@ -509,68 +515,78 @@
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L52
+	beq	$3,$2,$L60
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
-	j	$L65
-$L54:
+	j	$L78
+$L66:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L50
-	lui	$2,%hi(prot_counters+8)
+	beq	$3,$2,$L54
+	lui	$3,%hi(prot_counters+8)
 	.set	macro
 	.set	reorder
 
 	j	$L47
 $L48:
-	lui	$2,%hi(prot_counters+4)
+	lui	$3,%hi(prot_counters+4)
+	lw	$2,%lo(prot_counters+4)($3)
+	beq	$2,$0,$L77
 #APP
 	   
 
-	1:	ll	    $3, %lo(prot_counters+4)($2)		# atomic_sub		
+	1:	ll	    $2, %lo(prot_counters+4)($3)		# atomic_sub		
        nop                                             
-	subu	$3, 1					
-	sc	    $3, %lo(prot_counters+4)($2)					
-	beqz	$3, 2f					
+	subu	$2, 1					
+	sc	    $2, %lo(prot_counters+4)($3)					
+	beqz	$2, 2f					
 	.subsection 2					
 2:	b	1b					
 	.previous					
 
 #NO_APP
-	j	$L64
-$L50:
+	j	$L76
+$L54:
+	lw	$2,%lo(prot_counters+8)($3)
+	beq	$2,$0,$L77
 #APP
 	   
 
-	1:	ll	    $3, %lo(prot_counters+8)($2)		# atomic_sub		
+	1:	ll	    $2, %lo(prot_counters+8)($3)		# atomic_sub		
        nop                                             
-	subu	$3, 1					
-	sc	    $3, %lo(prot_counters+8)($2)					
-	beqz	$3, 2f					
+	subu	$2, 1					
+	sc	    $2, %lo(prot_counters+8)($3)					
+	beqz	$2, 2f					
 	.subsection 2					
 2:	b	1b					
 	.previous					
 
 #NO_APP
-	j	$L64
-$L52:
-	lui	$2,%hi(prot_counters)
+	j	$L76
+$L60:
+	lui	$4,%hi(prot_counters)
+	lw	$2,%lo(prot_counters)($4)
+	bne	$2,$0,$L61
+$L77:
+	jal	net_ratelimit
+	j	$L47
+$L61:
 #APP
 	   
 
-	1:	ll	    $4, %lo(prot_counters)($2)		# atomic_sub		
+	1:	ll	    $2, %lo(prot_counters)($4)		# atomic_sub		
        nop                                             
-	subu	$4, $3					
-	sc	    $4, %lo(prot_counters)($2)					
-	beqz	$4, 2f					
+	subu	$2, $3					
+	sc	    $2, %lo(prot_counters)($4)					
+	beqz	$2, 2f					
 	.subsection 2					
 2:	b	1b					
 	.previous					
 
 #NO_APP
-$L64:
+$L76:
 #APP
 	   
 
@@ -578,16 +594,16 @@
 $L47:
 	lbu	$3,50($16)
 	li	$2,6			# 0x6
-$L65:
+$L78:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L56
+	beq	$3,$2,$L68
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$3,$2,$L63
-$L56:
+	bne	$3,$2,$L75
+$L68:
 	move	$4,$16
 	.set	noreorder
 	.set	nomacro
@@ -611,7 +627,7 @@
 	lw	$2,%lo(nf_conntrack_max)($2)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L66
+	beq	$2,$0,$L79
 	lui	$2,%hi(rtl_newGC_session_status_flags)
 	.set	macro
 	.set	reorder
@@ -622,7 +638,7 @@
 	slt	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L59
+	beq	$2,$0,$L71
 	lui	$4,%hi(rtl_newGC_session_status_flags)
 	.set	macro
 	.set	reorder
@@ -631,7 +647,7 @@
 	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$3,$L63
+	beq	$2,$3,$L75
 	lui	$2,%hi(jiffies)
 	.set	macro
 	.set	reorder
@@ -642,16 +658,16 @@
 	addiu	$2,$2,1
 	.set	noreorder
 	.set	nomacro
-	j	$L63
+	j	$L75
 	sw	$2,%lo(rtl_newGC_session_status_time)($3)
 	.set	macro
 	.set	reorder
 
-$L59:
+$L71:
 	lui	$2,%hi(rtl_newGC_session_status_flags)
-$L66:
+$L79:
 	sw	$0,%lo(rtl_newGC_session_status_flags)($2)
-$L63:
+$L75:
 	jal	local_bh_enable
 	move	$4,$16
 	lw	$31,24($sp)
@@ -684,7 +700,7 @@
 	lw	$3,200($4)
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L74
+	beq	$3,$0,$L87
 	move	$16,$4
 	.set	macro
 	.set	reorder
@@ -692,18 +708,18 @@
 	lbu	$2,8($3)
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L74
+	beq	$2,$0,$L87
 	addu	$3,$3,$2
 	.set	macro
 	.set	reorder
 
-	beq	$3,$0,$L74
+	beq	$3,$0,$L87
 	lw	$2,0($3)
-	beq	$2,$0,$L74
+	beq	$2,$0,$L87
 	lw	$2,64($2)
-	beq	$2,$0,$L74
+	beq	$2,$0,$L87
 	jal	$2
-$L74:
+$L87:
 	jal	local_bh_disable
 	move	$5,$17
 	lw	$3,488($17)
@@ -718,7 +734,7 @@
 	.set	reorder
 
 	jal	local_bh_enable
-	beq	$16,$0,$L67
+	beq	$16,$0,$L80
 #APP
 	   
 
@@ -737,7 +753,7 @@
 #NO_APP
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L67
+	bne	$2,$0,$L80
 	move	$4,$16
 	.set	macro
 	.set	reorder
@@ -752,7 +768,7 @@
 	.set	macro
 	.set	reorder
 
-$L67:
+$L80:
 	lw	$31,24($sp)
 	lw	$17,20($sp)
 	lw	$16,16($sp)
@@ -775,24 +791,25 @@
 	.mask	0x00000000,0
 	.fmask	0x00000000,0
 	lw	$2,156($4)
+	beq	$2,$0,$L107
 	lbu	$3,9($2)
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L96
+	beq	$3,$2,$L112
 	slt	$2,$3,7
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L113
+	beq	$2,$0,$L129
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
 	li	$2,1			# 0x1
-	beq	$3,$2,$L109
+	beq	$3,$2,$L125
 	.set	noreorder
 	.set	nomacro
 	j	$31
@@ -800,30 +817,30 @@
 	.set	macro
 	.set	reorder
 
-$L113:
+$L129:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L101
+	beq	$3,$2,$L117
 	move	$2,$0
 	.set	macro
 	.set	reorder
 
-	j	$L116
-$L96:
+	j	$L132
+$L112:
 	lbu	$3,176($5)
 	lui	$2,%hi(Tcp_State_Hash_Head)
 	addiu	$2,$2,%lo(Tcp_State_Hash_Head)
 	sll	$3,$3,3
 	addu	$3,$3,$2
 	lw	$4,4($3)
-	beq	$4,$0,$L97
+	beq	$4,$0,$L113
 	lw	$3,4($4)
 	addiu	$2,$5,204
 	sw	$4,204($5)
 	sw	$2,4($4)
 	sw	$2,0($3)
 	sw	$3,4($2)
-$L97:
+$L113:
 	lui	$2,%hi(prot_counters+4)
 #APP
 	   
@@ -840,25 +857,25 @@
 	.set	mips0					
 
 #NO_APP
-	j	$L115
-$L101:
+	j	$L131
+$L117:
 	lw	$2,100($5)
 	addiu	$4,$5,204
 	andi	$2,$2,0x2
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L102
+	beq	$2,$0,$L118
 	lui	$3,%hi(Udp_State_Hash_Head)
 	.set	macro
 	.set	reorder
 
 	addiu	$2,$3,%lo(Udp_State_Hash_Head)
 	lw	$2,12($2)
-	j	$L114
-$L102:
+	j	$L130
+$L118:
 	addiu	$2,$3,%lo(Udp_State_Hash_Head)
 	lw	$2,4($2)
-$L114:
+$L130:
 	lw	$3,4($2)
 	sw	$2,204($5)
 	sw	$4,4($2)
@@ -880,8 +897,8 @@
 	.set	mips0					
 
 #NO_APP
-	j	$L115
-$L109:
+	j	$L131
+$L125:
 	lui	$2,%hi(prot_counters)
 #APP
 	   
@@ -898,13 +915,14 @@
 	.set	mips0					
 
 #NO_APP
-$L115:
+$L131:
 #APP
 	   
 
 #NO_APP
+$L107:
 	move	$2,$0
-$L116:
+$L132:
 	j	$31
 	.end	rtl_connGC_addList
 	.section	.text.__nf_ct_refresh_acct_proto,"ax",@progbits
@@ -939,25 +957,25 @@
 	lw	$2,100($17)
 	srl	$2,$2,10
 	andi	$2,$2,0x1
-	bne	$2,$0,$L153
+	bne	$2,$0,$L169
 	nop
 
 	lw	$2,100($17)
 	srl	$2,$2,3
 	andi	$2,$2,0x1
-	bne	$2,$0,$L126
+	bne	$2,$0,$L142
 	li	$2,8			# 0x8
 
 	sw	$19,116($17)
-	j	$L129
+	j	$L145
 	sw	$2,24($sp)
 
-$L126:
+$L142:
 	addiu	$16,$17,108
 	jal	del_timer
 	move	$4,$16
 
-	beq	$2,$0,$L129
+	beq	$2,$0,$L145
 	lui	$2,%hi(jiffies)
 
 	move	$4,$16
@@ -969,16 +987,16 @@
 	li	$2,8			# 0x8
 	sw	$2,24($sp)
 	li	$2,6			# 0x6
-	beq	$18,$2,$L132
+	beq	$18,$2,$L148
 	li	$2,17			# 0x11
 
-	beq	$18,$2,$L137
+	beq	$18,$2,$L153
 	nop
 
-	j	$L129
+	j	$L145
 	nop
 
-$L132:
+$L148:
 	lw	$3,92($sp)
 	lui	$2,%hi(Tcp_State_Hash_Head)
 	addiu	$4,$17,204
@@ -994,26 +1012,26 @@
 	sw	$4,4($2)
 	sw	$2,204($17)
 	sw	$3,4($4)
-	j	$L129
+	j	$L145
 	sw	$4,0($3)
 
-$L137:
+$L153:
 	lw	$2,100($17)
 	lw	$6,204($17)
 	andi	$2,$2,0x2
-	beq	$2,$0,$L138
+	beq	$2,$0,$L154
 	addiu	$5,$17,204
 
 	lui	$3,%hi(udp_assured_list)
 	lw	$2,4($5)
-	j	$L152
+	j	$L168
 	addiu	$3,$3,%lo(udp_assured_list)
 
-$L138:
+$L154:
 	lui	$3,%hi(udp_unreply_list)
 	lw	$2,4($5)
 	addiu	$3,$3,%lo(udp_unreply_list)
-$L152:
+$L168:
 	sw	$2,4($6)
 	lw	$4,4($3)
 	sw	$6,0($2)
@@ -1021,7 +1039,7 @@
 	sw	$3,204($17)
 	sw	$4,4($5)
 	sw	$5,0($4)
-$L129:
+$L145:
 	lw	$7,80($sp)
 	addiu	$2,$sp,24
 	move	$4,$17
@@ -1030,7 +1048,7 @@
 	jal	__nf_ct_refresh_acct_proto_hooks
 	sw	$2,16($sp)
 
-$L153:
+$L169:
 	jal	local_bh_enable
 	nop
 
@@ -1047,105 +1065,130 @@
 	.set	macro
 	.set	reorder
 	.end	__nf_ct_refresh_acct_proto
-	.section	.text.drop_one_conntrack,"ax",@progbits
+	.section	.text.isReservedConntrack,"ax",@progbits
 	.align	2
-	.globl	drop_one_conntrack
-	.ent	drop_one_conntrack
-	.type	drop_one_conntrack, @function
-drop_one_conntrack:
+	.globl	isReservedConntrack
+	.ent	isReservedConntrack
+	.type	isReservedConntrack, @function
+isReservedConntrack:
 	.set	nomips16
-	.frame	$sp,64,$31		# vars= 0, regs= 9/0, args= 24, gp= 0
-	.mask	0x80ff0000,-8
+	.frame	$sp,0,$31		# vars= 0, regs= 0/0, args= 0, gp= 0
+	.mask	0x00000000,0
 	.fmask	0x00000000,0
 	.set	noreorder
 	.set	nomacro
 	
-	addiu	$sp,$sp,-64
-	sw	$31,56($sp)
-	sw	$23,52($sp)
-	sw	$22,48($sp)
-	sw	$21,44($sp)
-	sw	$20,40($sp)
-	sw	$19,36($sp)
-	sw	$18,32($sp)
-	sw	$17,28($sp)
-	sw	$16,24($sp)
-	lhu	$3,16($4)
-	sltu	$2,$3,1024
-	bne	$2,$0,$L154
+	lbu	$3,38($4)
 	li	$2,1			# 0x1
+	beq	$3,$2,$L170
+	li	$7,1			# 0x1
 
-	li	$6,8080			# 0x1f90
-	beq	$3,$6,$L154
+	lw	$6,20($4)
+	li	$8,-268435456			# 0xf0000000
+	li	$9,-536870912			# 0xe0000000
+	and	$2,$6,$8
+	lw	$3,0($4)
+	beq	$2,$9,$L181
+	li	$7,-1			# 0xffffffff
+
+	beq	$6,$7,$L181
 	nop
 
-	lhu	$3,36($4)
-	sltu	$2,$3,1024
-	bne	$2,$0,$L154
-	li	$2,1			# 0x1
+	beq	$3,$0,$L181
+	nop
 
-	beq	$3,$6,$L154
+	lw	$3,20($5)
+	lw	$6,0($5)
+	and	$2,$3,$8
+	beq	$2,$9,$L181
 	nop
 
-	lhu	$3,16($5)
-	sltu	$2,$3,1024
-	bne	$2,$0,$L154
-	li	$2,1			# 0x1
-
-	beq	$3,$6,$L154
+	beq	$3,$7,$L181
 	nop
 
-	lhu	$3,36($5)
-	sltu	$2,$3,1024
-	bne	$2,$0,$L154
-	li	$2,1			# 0x1
+	beq	$6,$0,$L181
+	li	$3,80			# 0x50
 
-	beq	$3,$6,$L154
-	li	$7,-268435456			# 0xf0000000
+	lhu	$2,16($4)
+	beq	$2,$3,$L181
+	li	$6,8080			# 0x1f90
 
-	lw	$3,20($4)
-	li	$8,-536870912			# 0xe0000000
-	and	$2,$3,$7
-	lw	$4,0($4)
-	beq	$2,$8,$L391
-	li	$6,-1			# 0xffffffff
+	beq	$2,$6,$L181
+	nop
 
-	beq	$3,$6,$L154
-	li	$2,1			# 0x1
+	lhu	$4,36($4)
+	beq	$4,$3,$L181
+	nop
 
-	beq	$4,$0,$L154
+	beq	$4,$6,$L181
 	nop
 
-	lw	$3,20($5)
-	lw	$5,0($5)
-	and	$2,$3,$7
-	beq	$2,$8,$L154
-	li	$2,1			# 0x1
+	lhu	$2,16($5)
+	beq	$2,$3,$L181
+	nop
 
-	beq	$3,$6,$L154
+	beq	$2,$6,$L181
 	nop
 
-	beq	$5,$0,$L154
-	lui	$3,%hi(prot_counters+4)
+	lhu	$5,36($5)
+	beq	$5,$3,$L198
+	li	$7,1			# 0x1
 
+	bne	$5,$6,$L170
+	move	$7,$0
+
+$L181:
+	li	$7,1			# 0x1
+$L170:
+$L198:
+	j	$31
+	move	$2,$7
+
+	.set	macro
+	.set	reorder
+	.end	isReservedConntrack
+	.section	.text.drop_one_conntrack,"ax",@progbits
+	.align	2
+	.globl	drop_one_conntrack
+	.ent	drop_one_conntrack
+	.type	drop_one_conntrack, @function
+drop_one_conntrack:
+	.set	nomips16
+	.frame	$sp,64,$31		# vars= 0, regs= 9/0, args= 24, gp= 0
+	.mask	0x80ff0000,-8
+	.fmask	0x00000000,0
+	.set	noreorder
+	.set	nomacro
+	
+	addiu	$sp,$sp,-64
 	lui	$2,%hi(_prot_limit+4)
+	sw	$31,56($sp)
+	lui	$3,%hi(prot_counters+4)
+	sw	$23,52($sp)
+	sw	$22,48($sp)
+	sw	$21,44($sp)
+	sw	$20,40($sp)
+	sw	$19,36($sp)
+	sw	$18,32($sp)
+	sw	$17,28($sp)
+	sw	$16,24($sp)
 	lw	$2,%lo(_prot_limit+4)($2)
 	lw	$3,%lo(prot_counters+4)($3)
 	slt	$2,$2,$3
-	beq	$2,$0,$L444
+	beq	$2,$0,$L549
 	lui	$2,%hi(_prot_limit+8)
 
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$3,%hi(drop_priority)
-$L446:
+$L551:
 	sll	$2,$19,2
 	addiu	$3,$3,%lo(drop_priority)
 	addu	$2,$2,$3
 	lbu	$3,0($2)
 	sltu	$2,$3,10
-	beq	$2,$0,$L183
+	beq	$2,$0,$L206
 	lui	$2,%hi(Tcp_State_Hash_Head)
 
 	sll	$3,$3,3
@@ -1153,11 +1196,11 @@
 	addu	$3,$3,$2
 	lw	$18,4($3)
 	lw	$4,0($18)
-	beq	$4,$18,$L183
+	beq	$4,$18,$L206
 	move	$17,$4
 
-$L434:
-	beq	$17,$18,$L183
+$L536:
+	beq	$17,$18,$L206
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1171,83 +1214,83 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L189
+	beq	$2,$11,$L212
 	and	$2,$3,$12
 
-	beq	$2,$11,$L189
+	beq	$2,$11,$L212
 	nop
 
-	bne	$4,$3,$L445
+	bne	$4,$3,$L550
 	sltu	$2,$10,1024
 
-	beq	$6,$5,$L189
+	beq	$6,$5,$L212
 	nop
 
-$L445:
-	bne	$2,$0,$L189
+$L550:
+	bne	$2,$0,$L212
 	sltu	$2,$7,1024
 
-	bne	$2,$0,$L189
+	bne	$2,$0,$L212
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L189
+	bne	$2,$0,$L212
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L189
+	bne	$2,$0,$L212
 	li	$2,8080			# 0x1f90
 
-	beq	$10,$2,$L189
+	beq	$10,$2,$L212
 	nop
 
-	beq	$7,$2,$L189
+	beq	$7,$2,$L212
 	nop
 
-	beq	$8,$2,$L189
+	beq	$8,$2,$L212
 	nop
 
-	beq	$9,$2,$L189
+	beq	$9,$2,$L212
 	nop
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	bne	$2,$0,$L409
+	bne	$2,$0,$L520
 	nop
 
-$L189:
+$L212:
 	lw	$17,0($17)
-	j	$L434
+	j	$L536
 	nop
 
-$L183:
+$L206:
 	addiu	$19,$19,1
 	sltu	$2,$19,10
-	bne	$2,$0,$L446
+	bne	$2,$0,$L551
 	lui	$3,%hi(drop_priority)
 
 	jal	local_bh_enable
 	nop
 
 	lui	$2,%hi(_prot_limit+8)
-$L444:
+$L549:
 	lui	$3,%hi(prot_counters+8)
 	lw	$2,%lo(_prot_limit+8)($2)
 	lw	$3,%lo(prot_counters+8)($3)
 	slt	$2,$2,$3
-	beq	$2,$0,$L213
+	beq	$2,$0,$L236
 	nop
 
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$3,%hi(drop_priority)
-$L448:
+$L553:
 	sll	$2,$19,2
 	addiu	$3,$3,%lo(drop_priority)
 	addu	$2,$2,$3
 	lbu	$3,0($2)
 	sltu	$2,$3,11
-	bne	$2,$0,$L219
+	bne	$2,$0,$L242
 	lui	$2,%hi(Udp_State_Hash_Head)
 
 	sll	$3,$3,3
@@ -1255,11 +1298,11 @@
 	addu	$3,$3,$2
 	lw	$18,-84($3)
 	lw	$4,0($18)
-	beq	$4,$18,$L219
+	beq	$4,$18,$L242
 	move	$17,$4
 
-$L435:
-	beq	$17,$18,$L219
+$L537:
+	beq	$17,$18,$L242
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1273,88 +1316,75 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L225
+	beq	$2,$11,$L248
 	and	$2,$3,$12
 
-	beq	$2,$11,$L225
+	beq	$2,$11,$L248
 	nop
 
-	bne	$4,$3,$L447
+	bne	$4,$3,$L552
 	sltu	$2,$10,1024
 
-	beq	$6,$5,$L225
+	beq	$6,$5,$L248
 	nop
 
-$L447:
-	bne	$2,$0,$L225
+$L552:
+	bne	$2,$0,$L248
 	sltu	$2,$7,1024
 
-	bne	$2,$0,$L225
+	bne	$2,$0,$L248
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L225
+	bne	$2,$0,$L248
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L225
+	bne	$2,$0,$L248
 	li	$2,8080			# 0x1f90
 
-	beq	$10,$2,$L225
+	beq	$10,$2,$L248
 	nop
 
-	beq	$7,$2,$L225
+	beq	$7,$2,$L248
 	nop
 
-	beq	$8,$2,$L225
+	beq	$8,$2,$L248
 	nop
 
-	beq	$9,$2,$L225
+	beq	$9,$2,$L248
 	nop
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	bne	$2,$0,$L409
+	bne	$2,$0,$L520
 	nop
 
-$L225:
+$L248:
 	lw	$17,0($17)
-	j	$L435
+	j	$L537
 	nop
 
-$L219:
+$L242:
 	addiu	$19,$19,1
 	sltu	$2,$19,10
-	bne	$2,$0,$L448
+	bne	$2,$0,$L553
 	lui	$3,%hi(drop_priority)
 
 	jal	local_bh_enable
 	nop
 
-	j	$L213
-	nop
-
-$L409:
-	jal	local_bh_enable
-	nop
-
-	jal	rtl_death_action
-	move	$4,$16
-
-	j	$L443
-	lui	$4,%hi(rtl_newGC_session_status_flags)
-
-$L213:
+$L236:
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$22,%hi(drop_priority)
-$L453:
+$L558:
 	sll	$21,$19,2
 	addiu	$2,$22,%lo(drop_priority)
 	addu	$2,$21,$2
 	lbu	$2,0($2)
 	sltu	$3,$2,10
-	beq	$3,$0,$L257
+	beq	$3,$0,$L280
 	sll	$4,$2,3
 
 	lui	$2,%hi(Tcp_State_Hash_Head)
@@ -1362,13 +1392,13 @@
 	addu	$2,$4,$2
 	lw	$18,4($2)
 	lw	$4,0($18)
-	beq	$4,$18,$L290
+	beq	$4,$18,$L313
 	li	$23,3			# 0x3
 
 	move	$17,$4
 	move	$20,$0
-$L436:
-	beq	$17,$18,$L290
+$L538:
+	beq	$17,$18,$L313
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1382,42 +1412,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L263
+	beq	$2,$11,$L286
 	addiu	$20,$20,1
 
 	and	$2,$3,$12
-	beq	$2,$11,$L263
+	beq	$2,$11,$L286
 	nop
 
-	bne	$4,$3,$L449
+	bne	$4,$3,$L554
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L263
+	beq	$6,$5,$L286
 	nop
 
-$L449:
-	bne	$2,$0,$L263
+$L554:
+	bne	$2,$0,$L286
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L263
+	bne	$2,$0,$L286
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L263
+	bne	$2,$0,$L286
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L263
+	bne	$2,$0,$L286
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L263
+	beq	$7,$2,$L286
 	nop
 
-	beq	$8,$2,$L263
+	beq	$8,$2,$L286
 	nop
 
-	beq	$9,$2,$L263
+	beq	$9,$2,$L286
 	nop
 
-	beq	$10,$2,$L263
+	beq	$10,$2,$L286
 	lui	$2,%hi(jiffies)
 
 	addiu	$3,$22,%lo(drop_priority)
@@ -1428,70 +1458,70 @@
 	subu	$2,$2,$4
 	srl	$2,$2,7
 	sltu	$3,$3,$2
-	bne	$3,$0,$L450
-	slt	$2,$20,1025
+	bne	$3,$0,$L555
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L450
-	slt	$2,$20,1025
+	beq	$2,$0,$L555
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks1
 	sw	$23,16($sp)
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L410
+	beq	$3,$2,$L510
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L437
+	beq	$3,$2,$L539
 	move	$5,$19
 
 	move	$4,$16
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L450:
-	beq	$2,$0,$L313
+	slt	$2,$20,129
+$L555:
+	beq	$2,$0,$L336
 	move	$3,$0
 
-$L263:
+$L286:
 	lw	$17,0($17)
-	j	$L436
+	j	$L538
 	nop
 
-$L410:
+$L510:
 	jal	local_bh_enable
 	nop
 
 	jal	rtl_death_action
 	move	$4,$16
 
-$L437:
-	j	$L313
+$L539:
+	j	$L336
 	li	$3,1			# 0x1
 
-$L257:
+$L280:
 	lui	$2,%hi(Udp_State_Hash_Head)
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addu	$2,$4,$2
 	lw	$18,-84($2)
 	lw	$4,0($18)
-	beq	$4,$18,$L290
+	beq	$4,$18,$L313
 	li	$23,12			# 0xc
 
 	move	$17,$4
 	move	$20,$0
-$L438:
-	beq	$17,$18,$L290
+$L540:
+	beq	$17,$18,$L313
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1505,42 +1535,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L294
+	beq	$2,$11,$L317
 	addiu	$20,$20,1
 
 	and	$2,$3,$12
-	beq	$2,$11,$L294
+	beq	$2,$11,$L317
 	nop
 
-	bne	$4,$3,$L451
+	bne	$4,$3,$L556
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L294
+	beq	$6,$5,$L317
 	nop
 
-$L451:
-	bne	$2,$0,$L294
+$L556:
+	bne	$2,$0,$L317
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L294
+	bne	$2,$0,$L317
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L294
+	bne	$2,$0,$L317
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L294
+	bne	$2,$0,$L317
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L294
+	beq	$7,$2,$L317
 	nop
 
-	beq	$8,$2,$L294
+	beq	$8,$2,$L317
 	nop
 
-	beq	$9,$2,$L294
+	beq	$9,$2,$L317
 	nop
 
-	beq	$10,$2,$L294
+	beq	$10,$2,$L317
 	lui	$2,%hi(jiffies)
 
 	addiu	$3,$22,%lo(drop_priority)
@@ -1551,55 +1581,55 @@
 	subu	$2,$2,$4
 	srl	$2,$2,7
 	sltu	$3,$3,$2
-	bne	$3,$0,$L452
-	slt	$2,$20,1025
+	bne	$3,$0,$L557
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L452
-	slt	$2,$20,1025
+	beq	$2,$0,$L557
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks1
 	sw	$23,16($sp)
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L410
+	beq	$3,$2,$L510
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L437
+	beq	$3,$2,$L539
 	move	$5,$19
 
 	move	$4,$16
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L452:
-	beq	$2,$0,$L313
+	slt	$2,$20,129
+$L557:
+	beq	$2,$0,$L336
 	move	$3,$0
 
-$L294:
+$L317:
 	lw	$17,0($17)
-	j	$L438
+	j	$L540
 	nop
 
-$L290:
+$L313:
 	move	$3,$0
-$L313:
+$L336:
 	li	$2,1			# 0x1
-	beq	$3,$2,$L250
+	beq	$3,$2,$L548
 	addiu	$19,$19,1
 
 	sltu	$2,$19,10
-	bne	$2,$0,$L453
+	bne	$2,$0,$L558
 	lui	$22,%hi(drop_priority)
 
 	jal	local_bh_enable
@@ -1608,13 +1638,13 @@
 	jal	local_bh_disable
 	lui	$22,%hi(drop_priority)
 
-$L458:
+$L563:
 	sll	$21,$19,2
 	addiu	$2,$22,%lo(drop_priority)
 	addu	$2,$21,$2
 	lbu	$2,0($2)
 	sltu	$3,$2,10
-	beq	$3,$0,$L327
+	beq	$3,$0,$L350
 	sll	$4,$2,3
 
 	lui	$2,%hi(Tcp_State_Hash_Head)
@@ -1622,13 +1652,13 @@
 	addu	$2,$4,$2
 	lw	$18,4($2)
 	lw	$4,0($18)
-	beq	$4,$18,$L360
+	beq	$4,$18,$L383
 	li	$23,3			# 0x3
 
 	move	$17,$4
 	move	$20,$0
-$L439:
-	beq	$17,$18,$L360
+$L541:
+	beq	$17,$18,$L383
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1642,42 +1672,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L333
+	beq	$2,$11,$L356
 	addiu	$20,$20,1
 
 	and	$2,$3,$12
-	beq	$2,$11,$L333
+	beq	$2,$11,$L356
 	nop
 
-	bne	$4,$3,$L454
+	bne	$4,$3,$L559
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L333
+	beq	$6,$5,$L356
 	nop
 
-$L454:
-	bne	$2,$0,$L333
+$L559:
+	bne	$2,$0,$L356
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L333
+	bne	$2,$0,$L356
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L333
+	bne	$2,$0,$L356
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L333
+	bne	$2,$0,$L356
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L333
+	beq	$7,$2,$L356
 	nop
 
-	beq	$8,$2,$L333
+	beq	$8,$2,$L356
 	nop
 
-	beq	$9,$2,$L333
+	beq	$9,$2,$L356
 	nop
 
-	beq	$10,$2,$L333
+	beq	$10,$2,$L356
 	lui	$2,%hi(jiffies)
 
 	addiu	$3,$22,%lo(drop_priority)
@@ -1688,14 +1718,14 @@
 	subu	$2,$2,$4
 	srl	$2,$2,9
 	sltu	$3,$3,$2
-	bne	$3,$0,$L455
-	slt	$2,$20,1025
+	bne	$3,$0,$L560
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L455
-	slt	$2,$20,1025
+	beq	$2,$0,$L560
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
@@ -1706,10 +1736,10 @@
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L415
+	beq	$3,$2,$L515
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L440
+	beq	$3,$2,$L542
 	move	$5,$19
 
 	move	$4,$16
@@ -1718,40 +1748,40 @@
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L455:
-	beq	$2,$0,$L383
+	slt	$2,$20,129
+$L560:
+	beq	$2,$0,$L406
 	move	$3,$0
 
-$L333:
+$L356:
 	lw	$17,0($17)
-	j	$L439
+	j	$L541
 	nop
 
-$L415:
+$L515:
 	jal	local_bh_enable
 	nop
 
 	jal	rtl_death_action
 	move	$4,$16
 
-$L440:
-	j	$L383
+$L542:
+	j	$L406
 	li	$3,1			# 0x1
 
-$L327:
+$L350:
 	lui	$2,%hi(Udp_State_Hash_Head)
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addu	$2,$4,$2
 	lw	$18,-84($2)
 	lw	$4,0($18)
-	beq	$4,$18,$L360
+	beq	$4,$18,$L383
 	li	$23,12			# 0xc
 
 	move	$17,$4
 	move	$20,$0
-$L441:
-	beq	$17,$18,$L360
+$L543:
+	beq	$17,$18,$L383
 	addiu	$16,$17,-204
 
 	li	$12,-268435456			# 0xf0000000
@@ -1765,42 +1795,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$11,$L364
+	beq	$2,$11,$L387
 	addiu	$20,$20,1
 
 	and	$2,$3,$12
-	beq	$2,$11,$L364
+	beq	$2,$11,$L387
 	nop
 
-	bne	$4,$3,$L456
+	bne	$4,$3,$L561
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L364
+	beq	$6,$5,$L387
 	nop
 
-$L456:
-	bne	$2,$0,$L364
+$L561:
+	bne	$2,$0,$L387
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L364
+	bne	$2,$0,$L387
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L364
+	bne	$2,$0,$L387
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L364
+	bne	$2,$0,$L387
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L364
+	beq	$7,$2,$L387
 	nop
 
-	beq	$8,$2,$L364
+	beq	$8,$2,$L387
 	nop
 
-	beq	$9,$2,$L364
+	beq	$9,$2,$L387
 	nop
 
-	beq	$10,$2,$L364
+	beq	$10,$2,$L387
 	lui	$2,%hi(jiffies)
 
 	addiu	$3,$22,%lo(drop_priority)
@@ -1811,14 +1841,14 @@
 	subu	$2,$2,$4
 	srl	$2,$2,9
 	sltu	$3,$3,$2
-	bne	$3,$0,$L457
-	slt	$2,$20,1025
+	bne	$3,$0,$L562
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L457
-	slt	$2,$20,1025
+	beq	$2,$0,$L562
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
@@ -1829,10 +1859,10 @@
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L415
+	beq	$3,$2,$L515
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L440
+	beq	$3,$2,$L542
 	move	$5,$19
 
 	move	$4,$16
@@ -1841,67 +1871,275 @@
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L457:
-	beq	$2,$0,$L383
+	slt	$2,$20,129
+$L562:
+	beq	$2,$0,$L406
 	move	$3,$0
 
-$L364:
+$L387:
 	lw	$17,0($17)
-	j	$L441
+	j	$L543
 	nop
 
-$L360:
+$L383:
 	move	$3,$0
-$L383:
+$L406:
 	li	$2,1			# 0x1
-	beq	$3,$2,$L250
+	beq	$3,$2,$L548
 	addiu	$19,$19,1
 
 	sltu	$2,$19,10
-	bne	$2,$0,$L458
+	bne	$2,$0,$L563
 	lui	$22,%hi(drop_priority)
 
-	j	$L433
+	jal	local_bh_enable
+	move	$19,$0
+
+	jal	local_bh_disable
 	nop
 
-$L250:
+$L447:
+	lui	$20,%hi(drop_priority)
+	sll	$2,$19,2
+	addiu	$3,$20,%lo(drop_priority)
+	addu	$2,$2,$3
+	lbu	$3,0($2)
+	sltu	$2,$3,10
+	beq	$2,$0,$L421
+	lui	$2,%hi(Tcp_State_Hash_Head)
+
+	sll	$3,$3,3
+	addiu	$2,$2,%lo(Tcp_State_Hash_Head)
+	addu	$3,$3,$2
+	lw	$18,4($3)
+	lw	$4,0($18)
+	beq	$4,$18,$L421
+	move	$17,$4
+
+$L544:
+	beq	$17,$18,$L421
+	addiu	$16,$17,-204
+
+	li	$12,-268435456			# 0xf0000000
+	lw	$6,32($16)
+	li	$11,-536870912			# 0xe0000000
+	lhu	$10,28($16)
+	and	$2,$6,$12
+	lhu	$7,48($16)
+	lhu	$8,76($16)
+	lhu	$9,96($16)
+	lw	$4,12($16)
+	lw	$5,60($16)
+	lw	$3,80($16)
+	beq	$2,$11,$L427
+	and	$2,$3,$12
+
+	beq	$2,$11,$L427
+	nop
+
+	bne	$4,$3,$L564
+	sltu	$2,$10,1024
+
+	beq	$6,$5,$L427
+	nop
+
+$L564:
+	bne	$2,$0,$L427
+	sltu	$2,$7,1024
+
+	bne	$2,$0,$L427
+	sltu	$2,$8,1024
+
+	bne	$2,$0,$L427
+	sltu	$2,$9,1024
+
+	bne	$2,$0,$L427
+	li	$2,8080			# 0x1f90
+
+	beq	$10,$2,$L427
+	nop
+
+	beq	$7,$2,$L427
+	nop
+
+	beq	$8,$2,$L427
+	nop
+
+	beq	$9,$2,$L427
+	nop
+
+	jal	del_timer
+	addiu	$4,$17,-96
+
+	bne	$2,$0,$L520
+	nop
+
+$L427:
+	lw	$17,0($17)
+	j	$L544
+	nop
+
+$L421:
+	addiu	$19,$19,1
+	sltu	$2,$19,10
+	bne	$2,$0,$L447
+	nop
+
+	j	$L535
+	nop
+
+$L520:
+	jal	local_bh_enable
+	nop
+
+	jal	rtl_death_action
+	move	$4,$16
+
+$L548:
+	j	$L547
 	lui	$4,%hi(rtl_newGC_session_status_flags)
-$L443:
-	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
-	bne	$2,$0,$L391
+
+$L521:
+	jal	local_bh_enable
 	nop
 
+	jal	rtl_death_action
+	move	$4,$16
+
+	j	$L481
+	li	$2,1			# 0x1
+
+$L535:
+	jal	local_bh_enable
+	move	$19,$0
+
+	jal	local_bh_disable
+	nop
+
+	addiu	$3,$20,%lo(drop_priority)
+$L566:
+	sll	$2,$19,2
+	addu	$2,$2,$3
+	lbu	$3,0($2)
+	sltu	$2,$3,11
+	bne	$2,$0,$L457
+	lui	$2,%hi(Udp_State_Hash_Head)
+
+	sll	$3,$3,3
+	addiu	$2,$2,%lo(Udp_State_Hash_Head)
+	addu	$3,$3,$2
+	lw	$18,-84($3)
+	lw	$4,0($18)
+	beq	$4,$18,$L457
+	move	$17,$4
+
+$L545:
+	beq	$17,$18,$L457
+	addiu	$16,$17,-204
+
+	li	$12,-268435456			# 0xf0000000
+	lw	$6,32($16)
+	li	$11,-536870912			# 0xe0000000
+	lhu	$10,28($16)
+	and	$2,$6,$12
+	lhu	$7,48($16)
+	lhu	$8,76($16)
+	lhu	$9,96($16)
+	lw	$4,12($16)
+	lw	$5,60($16)
+	lw	$3,80($16)
+	beq	$2,$11,$L463
+	and	$2,$3,$12
+
+	beq	$2,$11,$L463
+	nop
+
+	bne	$4,$3,$L565
+	sltu	$2,$10,1024
+
+	beq	$6,$5,$L463
+	nop
+
+$L565:
+	bne	$2,$0,$L463
+	sltu	$2,$7,1024
+
+	bne	$2,$0,$L463
+	sltu	$2,$8,1024
+
+	bne	$2,$0,$L463
+	sltu	$2,$9,1024
+
+	bne	$2,$0,$L463
+	li	$2,8080			# 0x1f90
+
+	beq	$10,$2,$L463
+	nop
+
+	beq	$7,$2,$L463
+	nop
+
+	beq	$8,$2,$L463
+	nop
+
+	beq	$9,$2,$L463
+	nop
+
+	jal	del_timer
+	addiu	$4,$17,-96
+
+	bne	$2,$0,$L521
+	nop
+
+$L463:
+	lw	$17,0($17)
+	j	$L545
+	nop
+
+$L457:
+	addiu	$19,$19,1
+	sltu	$2,$19,10
+	bne	$2,$0,$L566
+	addiu	$3,$20,%lo(drop_priority)
+
+	jal	local_bh_enable
+	nop
+
+	move	$2,$0
+$L481:
+	beq	$2,$0,$L451
+	lui	$4,%hi(rtl_newGC_session_status_flags)
+
+$L547:
+	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
+	bne	$2,$0,$L486
 	lui	$2,%hi(jiffies)
+
 	lw	$3,%lo(jiffies)($2)
 	li	$2,3			# 0x3
 	sw	$2,%lo(rtl_newGC_session_status_flags)($4)
 	lui	$2,%hi(rtl_newGC_session_status_time)
 	addiu	$3,$3,1
 	sw	$3,%lo(rtl_newGC_session_status_time)($2)
-$L391:
-	j	$L154
-	li	$2,1			# 0x1
+$L486:
+	j	$L199
+	li	$5,1			# 0x1
 
-$L433:
-	jal	local_bh_enable
-	nop
+$L451:
+	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
+	bne	$2,$0,$L199
+	move	$5,$0
 
-	lui	$4,%hi(rtl_newGC_session_status_flags)
-	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
-	li	$3,1			# 0x1
-	beq	$2,$3,$L393
 	lui	$2,%hi(jiffies)
-
-	lw	$2,%lo(jiffies)($2)
-	sw	$3,%lo(rtl_newGC_session_status_flags)($4)
-	lui	$3,%hi(rtl_newGC_session_status_time)
-	addiu	$2,$2,200
-	sw	$2,%lo(rtl_newGC_session_status_time)($3)
-$L393:
-	move	$2,$0
-$L154:
+	lw	$3,%lo(jiffies)($2)
+	li	$2,3			# 0x3
+	sw	$2,%lo(rtl_newGC_session_status_flags)($4)
+	lui	$2,%hi(rtl_newGC_session_status_time)
+	addiu	$3,$3,1
+	sw	$3,%lo(rtl_newGC_session_status_time)($2)
+$L199:
 	lw	$31,56($sp)
+	move	$2,$5
 	lw	$23,52($sp)
 	lw	$22,48($sp)
 	lw	$21,44($sp)
@@ -1936,32 +2174,32 @@
 	sw	$31,20($sp)
 	addiu	$2,$2,4
 	sw	$16,16($sp)
-$L465:
+$L573:
 	lw	$3,0($2)
 	addiu	$5,$5,-1
-	beq	$3,$0,$L462
+	beq	$3,$0,$L570
 	addiu	$2,$2,8
 
 	sw	$3,4($3)
 	sw	$3,0($3)
-$L462:
-	bgez	$5,$L465
+$L570:
+	bgez	$5,$L573
 	nop
 
 	lui	$2,%hi(Udp_State_Hash_Head)
 	li	$5,1			# 0x1
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addiu	$2,$2,4
-$L471:
+$L579:
 	lw	$3,0($2)
 	addiu	$5,$5,-1
-	beq	$3,$0,$L468
+	beq	$3,$0,$L576
 	addiu	$2,$2,8
 
 	sw	$3,4($3)
 	sw	$3,0($3)
-$L468:
-	bgez	$5,$L471
+$L576:
+	bgez	$5,$L579
 	lui	$16,%hi(prot_limit)
 
 	move	$5,$0
@@ -1975,14 +2213,14 @@
 	addiu	$6,$2,%lo(_prot_limit)
 	move	$5,$0
 	sll	$2,$5,2
-$L494:
+$L602:
 	addiu	$5,$5,1
 	addu	$4,$2,$6
 	slt	$3,$5,3
 	addu	$2,$2,$7
 	sw	$0,0($2)
 	sw	$0,0($4)
-	bne	$3,$0,$L494
+	bne	$3,$0,$L602
 	sll	$2,$5,2
 
 	lui	$2,%hi(nf_conntrack_max)
@@ -2003,7 +2241,7 @@
 	move	$5,$0
 	sw	$0,%lo(rtl_newGC_session_status_flags)($7)
 	sll	$3,$5,2
-$L495:
+$L603:
 	addiu	$5,$5,1
 	addu	$2,$3,$9
 	slt	$4,$5,3
@@ -2015,7 +2253,7 @@
 	mfhi	$2
 	srl	$2,$2,5
 	sw	$2,0($3)
-	bne	$4,$0,$L495
+	bne	$4,$0,$L603
 	sll	$3,$5,2
 
 	li	$3,-859045888			# 0xcccc0000
@@ -2026,38 +2264,38 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
-	bne	$3,$0,$L481
+	sltu	$3,$3,129
+	bne	$3,$0,$L589
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
-$L481:
+$L589:
 	lui	$2,%hi(nf_conntrack_max)
 	lw	$2,%lo(nf_conntrack_max)($2)
-	beq	$2,$0,$L482
+	beq	$2,$0,$L590
 	lui	$2,%hi(init_net+468)
 
 	lw	$3,%lo(init_net+468)($2)
 	lw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 	slt	$2,$2,$3
-	beq	$2,$0,$L482
+	beq	$2,$0,$L590
 	li	$3,3			# 0x3
 
 	lw	$2,%lo(rtl_newGC_session_status_flags)($7)
-	beq	$2,$3,$L485
+	beq	$2,$3,$L593
 	lui	$2,%hi(jiffies)
 
 	lw	$2,%lo(jiffies)($2)
 	sw	$3,%lo(rtl_newGC_session_status_flags)($7)
 	lui	$3,%hi(rtl_newGC_session_status_time)
 	addiu	$2,$2,1
-	j	$L485
+	j	$L593
 	sw	$2,%lo(rtl_newGC_session_status_time)($3)
 
-$L482:
+$L590:
 	sw	$0,%lo(rtl_newGC_session_status_flags)($7)
-$L485:
+$L593:
 	jal	rtl_nf_conn_GC_init_hooks
 	nop
 
@@ -2097,8 +2335,16 @@
 	.size	prot_limit, 12
 prot_limit:
 	.space	12
-	.local	prot_counters
-	.comm	prot_counters,12,4
-	.local	_prot_limit
-	.comm	_prot_limit,12,4
+	.globl	prot_counters
+	.align	2
+	.type	prot_counters, @object
+	.size	prot_counters, 12
+prot_counters:
+	.space	12
+	.globl	_prot_limit
+	.align	2
+	.type	_prot_limit, @object
+	.size	_prot_limit, 12
+_prot_limit:
+	.space	12
 	.ident	"GCC: (GNU) 3.4.6-1.3.6"
Index: features/rtl_features.c
===================================================================
--- features/rtl_features.c	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ features/rtl_features.c	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -110,7 +110,7 @@
 	struct nf_conn_nat *nat;
 	u_int32_t sip, dip, gip;
 	u_int16_t sp, dp, gp, proto=0;
-	u_int32_t timeval;
+	int timeval;
 	int rc=0;
 
 #if defined(CONFIG_RTL_HW_QOS_SUPPORT)
@@ -870,8 +870,8 @@
 	if (buffer && !copy_from_user(&gHwNatSetting, buffer, 8)) {
 		if (gHwNatSetting[0] == '0') { /* hardware NAT disabled, operation mode = gateway */
 			gHwNatEnabled = 0;
-			rtl865x_nat_reinit();
-			rtl865x_changeOpMode(GATEWAY_MODE);
+			rtl865x_nat_reinit();			
+			rtl865x_reChangeOpMode();
 			//rtl8651_setAsicOperationLayer(4);
 		}
 		else if (gHwNatSetting[0] == '1') { /* hardware NAT enabled, operation mode = gateway */
@@ -976,7 +976,7 @@
 	if (proc_sw_nat) {
 		proc_sw_nat->read_proc = sw_nat_read_proc;
 		proc_sw_nat->write_proc = sw_nat_write_proc;
-	}  
+	}
 	#endif
 
 	#if	defined(CONFIG_RTL_HARDWARE_NAT)
@@ -1507,7 +1507,28 @@
 }
 #endif
 
+#if defined(CONFIG_RTL_IPTABLES_RULE_2_ACL) || defined(CONFIG_RTL_HARDWARE_NAT)
+/*get the chain number of the ipt_entry*/
+int get_hookNum(struct ipt_entry *e, unsigned char *base, const unsigned int valid_hooks,const unsigned int *hook_entries)
+{
+	int h;
+	unsigned int offset = 0;
+	int hook_num = -1;
 
+	offset = (void *)e - (void *)base;
+	for(h = 0; h < NF_INET_NUMHOOKS; h++)
+	{
+		if(!(valid_hooks & (1 << h)))
+			continue;
+
+		if(offset >= hook_entries[h])
+			hook_num = h;
+	}
+
+	return hook_num;
+}
+#endif
+
 #if	defined(CONFIG_RTL_HARDWARE_NAT)
 /*2007-12-19*/
  int syn_asic_arp(struct neighbour *n, int add)
@@ -1547,29 +1568,6 @@
 }
 #endif
 
-#if defined(CONFIG_RTL_IPTABLES_RULE_2_ACL) || defined(CONFIG_RTL_HARDWARE_NAT)
-/*get the chain number of the ipt_entry*/
-static int get_hookNum(struct ipt_entry *e, unsigned char *base, const unsigned int valid_hooks,const unsigned int *hook_entries)
-{
-	int h;
-	unsigned int offset = 0;
-	int hook_num = -1;
-
-	offset = (void *)e - (void *)base;	
-	for(h = 0; h < NF_INET_NUMHOOKS; h++)
-	{		
-		if(!(valid_hooks & (1 << h)))
-			continue;
-		
-		if(offset >= hook_entries[h])
-			hook_num = h;		
-	}
-
-	return hook_num;
-}
-#endif
-
-#ifdef CONFIG_RTL_HARDWARE_NAT  
 rtl_masq_if rtl_masq_info[RTL_MULTIPLE_WAN_NUM];
 
 rtl_masq_if *rtl_get_masq_info_by_devName(const char* name)
@@ -1926,7 +1924,7 @@
 
 int32 rtl_ip_vs_conn_expire_check(struct ip_vs_conn *cp)
 {
-	u_int32_t timeval;
+	int timeval;
 	rtl865x_napt_entry rtl865xNaptEntry;
 
 /*   chhuang:
@@ -2153,7 +2151,6 @@
 }
 
 #endif 
-#endif
 
 #if defined(CONFIG_PROC_FS) && defined(CONFIG_RTL_NF_CONNTRACK_GARBAGE_NEW)
 static struct proc_dir_entry *proc_gc_overflow_timout=NULL;
Index: features/96C/rtl_nf_connGC.S
===================================================================
--- features/96C/rtl_nf_connGC.S	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ features/96C/rtl_nf_connGC.S	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -282,11 +282,11 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
+	sltu	$3,$3,129
 	bne	$3,$0,$L8
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 $L8:
 	lui	$2,%hi(nf_conntrack_max)
@@ -393,11 +393,11 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
+	sltu	$3,$3,129
 	bne	$3,$0,$L24
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 $L24:
 	lui	$2,%hi(nf_conntrack_max)
@@ -442,6 +442,12 @@
 	.set	macro
 	.set	reorder
 	.end	conntrack_dointvec_minmax
+	.rdata
+	.align	2
+	.type	__func__.0, @object
+	.size	__func__.0, 17
+__func__.0:
+	.ascii	"clean_from_lists\000"
 	.section	.text.clean_from_lists,"ax",@progbits
 	.align	2
 	.globl	clean_from_lists
@@ -505,7 +511,7 @@
 
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L57
+	beq	$2,$0,$L69
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
@@ -513,16 +519,16 @@
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L54
+	beq	$3,$2,$L62
 	li	$2,6			# 0x6
 	.set	macro
 	.set	reorder
 
-	j	$L68
-$L57:
+	j	$L81
+$L69:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L51
+	beq	$3,$2,$L55
 	lui	$4,%hi(prot_counters+8)
 	.set	macro
 	.set	reorder
@@ -530,6 +536,9 @@
 	j	$L47
 $L48:
 	lui	$4,%hi(prot_counters+4)
+	lw	$2,%lo(prot_counters+4)($4)
+	#nop
+	beq	$2,$0,$L80
 #APP
 	raw_local_irq_save	$3
 #NO_APP
@@ -537,8 +546,11 @@
 	#nop
 	addiu	$2,$2,-1
 	sw	$2,%lo(prot_counters+4)($4)
-	j	$L67
-$L51:
+	j	$L79
+$L55:
+	lw	$2,%lo(prot_counters+8)($4)
+	#nop
+	beq	$2,$0,$L80
 #APP
 	raw_local_irq_save	$3
 #NO_APP
@@ -546,9 +558,16 @@
 	#nop
 	addiu	$2,$2,-1
 	sw	$2,%lo(prot_counters+8)($4)
-	j	$L67
-$L54:
+	j	$L79
+$L62:
 	lui	$4,%hi(prot_counters)
+	lw	$2,%lo(prot_counters)($4)
+	#nop
+	bne	$2,$0,$L63
+$L80:
+	jal	net_ratelimit
+	j	$L47
+$L63:
 #APP
 	raw_local_irq_save	$3
 #NO_APP
@@ -556,23 +575,23 @@
 	#nop
 	addiu	$2,$2,-1
 	sw	$2,%lo(prot_counters)($4)
-$L67:
+$L79:
 #APP
 	raw_local_irq_restore	$3
 #NO_APP
 $L47:
 	lbu	$3,50($16)
 	li	$2,6			# 0x6
-$L68:
+$L81:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L59
+	beq	$3,$2,$L71
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
 
-	bne	$3,$2,$L66
-$L59:
+	bne	$3,$2,$L78
+$L71:
 	move	$4,$16
 	.set	noreorder
 	.set	nomacro
@@ -597,7 +616,7 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L69
+	beq	$2,$0,$L82
 	lui	$2,%hi(rtl_newGC_session_status_flags)
 	.set	macro
 	.set	reorder
@@ -609,7 +628,7 @@
 	slt	$2,$2,$3
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L62
+	beq	$2,$0,$L74
 	lui	$4,%hi(rtl_newGC_session_status_flags)
 	.set	macro
 	.set	reorder
@@ -618,7 +637,7 @@
 	li	$3,3			# 0x3
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$3,$L66
+	beq	$2,$3,$L78
 	lui	$2,%hi(jiffies)
 	.set	macro
 	.set	reorder
@@ -629,16 +648,16 @@
 	addiu	$2,$2,1
 	.set	noreorder
 	.set	nomacro
-	j	$L66
+	j	$L78
 	sw	$2,%lo(rtl_newGC_session_status_time)($3)
 	.set	macro
 	.set	reorder
 
-$L62:
+$L74:
 	lui	$2,%hi(rtl_newGC_session_status_flags)
-$L69:
+$L82:
 	sw	$0,%lo(rtl_newGC_session_status_flags)($2)
-$L66:
+$L78:
 	jal	local_bh_enable
 	move	$4,$16
 	lw	$31,24($sp)
@@ -671,7 +690,7 @@
 	move	$16,$4
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$0,$L77
+	beq	$3,$0,$L90
 	addiu	$17,$2,%lo(init_net)
 	.set	macro
 	.set	reorder
@@ -680,20 +699,20 @@
 	#nop
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L77
+	beq	$2,$0,$L90
 	addu	$3,$3,$2
 	.set	macro
 	.set	reorder
 
-	beq	$3,$0,$L77
+	beq	$3,$0,$L90
 	lw	$2,0($3)
 	#nop
-	beq	$2,$0,$L77
+	beq	$2,$0,$L90
 	lw	$2,64($2)
 	#nop
-	beq	$2,$0,$L77
+	beq	$2,$0,$L90
 	jal	$2
-$L77:
+$L90:
 	jal	local_bh_disable
 	lw	$3,488($17)
 	move	$5,$17
@@ -709,7 +728,7 @@
 	.set	reorder
 
 	jal	local_bh_enable
-	beq	$16,$0,$L70
+	beq	$16,$0,$L83
 #APP
 	raw_local_irq_save	$3
 #NO_APP
@@ -722,7 +741,7 @@
 #NO_APP
 	.set	noreorder
 	.set	nomacro
-	bne	$2,$0,$L70
+	bne	$2,$0,$L83
 	move	$4,$16
 	.set	macro
 	.set	reorder
@@ -737,7 +756,7 @@
 	.set	macro
 	.set	reorder
 
-$L70:
+$L83:
 	lw	$31,24($sp)
 	lw	$17,20($sp)
 	lw	$16,16($sp)
@@ -761,18 +780,19 @@
 	.fmask	0x00000000,0
 	lw	$2,156($4)
 	#nop
+	beq	$2,$0,$L111
 	lbu	$3,9($2)
 	li	$2,6			# 0x6
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L100
+	beq	$3,$2,$L116
 	slt	$2,$3,7
 	.set	macro
 	.set	reorder
 
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L120
+	beq	$2,$0,$L136
 	li	$2,17			# 0x11
 	.set	macro
 	.set	reorder
@@ -780,7 +800,7 @@
 	li	$2,1			# 0x1
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L115
+	beq	$3,$2,$L131
 	lui	$4,%hi(prot_counters)
 	.set	macro
 	.set	reorder
@@ -792,16 +812,16 @@
 	.set	macro
 	.set	reorder
 
-$L120:
+$L136:
 	.set	noreorder
 	.set	nomacro
-	beq	$3,$2,$L106
+	beq	$3,$2,$L122
 	move	$2,$0
 	.set	macro
 	.set	reorder
 
-	j	$L123
-$L100:
+	j	$L139
+$L116:
 	lbu	$3,176($5)
 	lui	$2,%hi(Tcp_State_Hash_Head)
 	addiu	$2,$2,%lo(Tcp_State_Hash_Head)
@@ -809,14 +829,14 @@
 	addu	$3,$3,$2
 	lw	$4,4($3)
 	#nop
-	beq	$4,$0,$L101
+	beq	$4,$0,$L117
 	lw	$3,4($4)
 	addiu	$2,$5,204
 	sw	$4,204($5)
 	sw	$2,4($4)
 	sw	$2,0($3)
 	sw	$3,4($2)
-$L101:
+$L117:
 	lui	$4,%hi(prot_counters+4)
 #APP
 	raw_local_irq_save	$3
@@ -825,26 +845,26 @@
 	#nop
 	addiu	$2,$2,1
 	sw	$2,%lo(prot_counters+4)($4)
-	j	$L122
-$L106:
+	j	$L138
+$L122:
 	lw	$2,100($5)
 	addiu	$4,$5,204
 	andi	$2,$2,0x2
 	.set	noreorder
 	.set	nomacro
-	beq	$2,$0,$L107
+	beq	$2,$0,$L123
 	lui	$3,%hi(Udp_State_Hash_Head)
 	.set	macro
 	.set	reorder
 
 	addiu	$2,$3,%lo(Udp_State_Hash_Head)
 	lw	$2,12($2)
-	j	$L121
-$L107:
+	j	$L137
+$L123:
 	addiu	$2,$3,%lo(Udp_State_Hash_Head)
 	lw	$2,4($2)
 	#nop
-$L121:
+$L137:
 	lw	$3,4($2)
 	sw	$2,204($5)
 	sw	$4,4($2)
@@ -858,8 +878,8 @@
 	#nop
 	addiu	$2,$2,1
 	sw	$2,%lo(prot_counters+8)($4)
-	j	$L122
-$L115:
+	j	$L138
+$L131:
 #APP
 	raw_local_irq_save	$3
 #NO_APP
@@ -867,12 +887,13 @@
 	#nop
 	addiu	$2,$2,1
 	sw	$2,%lo(prot_counters)($4)
-$L122:
+$L138:
 #APP
 	raw_local_irq_restore	$3
 #NO_APP
+$L111:
 	move	$2,$0
-$L123:
+$L139:
 	j	$31
 	.end	rtl_connGC_addList
 	.section	.text.__nf_ct_refresh_acct_proto,"ax",@progbits
@@ -908,26 +929,26 @@
 	nop
 	srl	$2,$2,10
 	andi	$2,$2,0x1
-	bne	$2,$0,$L160
+	bne	$2,$0,$L176
 	nop
 
 	lw	$2,100($17)
 	nop
 	srl	$2,$2,3
 	andi	$2,$2,0x1
-	bne	$2,$0,$L133
+	bne	$2,$0,$L149
 	li	$2,8			# 0x8
 
 	sw	$19,116($17)
-	j	$L136
+	j	$L152
 	sw	$2,24($sp)
 
-$L133:
+$L149:
 	addiu	$16,$17,108
 	jal	del_timer
 	move	$4,$16
 
-	beq	$2,$0,$L136
+	beq	$2,$0,$L152
 	lui	$2,%hi(jiffies)
 
 	lw	$2,%lo(jiffies)($2)
@@ -939,16 +960,16 @@
 	li	$2,8			# 0x8
 	sw	$2,24($sp)
 	li	$2,6			# 0x6
-	beq	$18,$2,$L139
+	beq	$18,$2,$L155
 	li	$2,17			# 0x11
 
-	beq	$18,$2,$L144
+	beq	$18,$2,$L160
 	nop
 
-	j	$L136
+	j	$L152
 	nop
 
-$L139:
+$L155:
 	lw	$3,92($sp)
 	lui	$2,%hi(Tcp_State_Hash_Head)
 	addiu	$4,$17,204
@@ -964,26 +985,26 @@
 	sw	$2,204($17)
 	sw	$4,4($2)
 	sw	$4,0($3)
-	j	$L136
+	j	$L152
 	sw	$3,4($4)
 
-$L144:
+$L160:
 	lw	$2,100($17)
 	lw	$6,204($17)
 	andi	$2,$2,0x2
-	beq	$2,$0,$L145
+	beq	$2,$0,$L161
 	addiu	$5,$17,204
 
 	lw	$2,4($5)
 	lui	$3,%hi(udp_assured_list)
-	j	$L159
+	j	$L175
 	addiu	$3,$3,%lo(udp_assured_list)
 
-$L145:
+$L161:
 	lw	$2,4($5)
 	lui	$3,%hi(udp_unreply_list)
 	addiu	$3,$3,%lo(udp_unreply_list)
-$L159:
+$L175:
 	sw	$2,4($6)
 	lw	$4,4($3)
 	sw	$6,0($2)
@@ -991,7 +1012,7 @@
 	sw	$3,204($17)
 	sw	$4,4($5)
 	sw	$5,0($4)
-$L136:
+$L152:
 	lw	$7,80($sp)
 	addiu	$2,$sp,24
 	move	$4,$17
@@ -1000,7 +1021,7 @@
 	jal	__nf_ct_refresh_acct_proto_hooks
 	sw	$2,16($sp)
 
-$L160:
+$L176:
 	jal	local_bh_enable
 	nop
 
@@ -1017,111 +1038,136 @@
 	.set	macro
 	.set	reorder
 	.end	__nf_ct_refresh_acct_proto
-	.section	.text.drop_one_conntrack,"ax",@progbits
+	.section	.text.isReservedConntrack,"ax",@progbits
 	.align	2
-	.globl	drop_one_conntrack
-	.ent	drop_one_conntrack
-	.type	drop_one_conntrack, @function
-drop_one_conntrack:
+	.globl	isReservedConntrack
+	.ent	isReservedConntrack
+	.type	isReservedConntrack, @function
+isReservedConntrack:
 	.set	nomips16
-	.frame	$sp,64,$31		# vars= 0, regs= 9/0, args= 24, gp= 0
-	.mask	0x80ff0000,-8
+	.frame	$sp,0,$31		# vars= 0, regs= 0/0, args= 0, gp= 0
+	.mask	0x00000000,0
 	.fmask	0x00000000,0
 	.set	noreorder
 	.set	nomacro
 	
-	addiu	$sp,$sp,-64
-	sw	$31,56($sp)
-	sw	$23,52($sp)
-	sw	$22,48($sp)
-	sw	$21,44($sp)
-	sw	$20,40($sp)
-	sw	$19,36($sp)
-	sw	$18,32($sp)
-	sw	$17,28($sp)
-	sw	$16,24($sp)
-	lhu	$3,16($4)
-	nop
-	sltu	$2,$3,1024
-	bne	$2,$0,$L161
+	lbu	$3,38($4)
 	li	$2,1			# 0x1
+	beq	$3,$2,$L177
+	li	$7,1			# 0x1
 
-	li	$6,8080			# 0x1f90
-	beq	$3,$6,$L161
+	lw	$6,20($4)
+	li	$8,-268435456			# 0xfffffffff0000000
+	li	$9,-536870912			# 0xffffffffe0000000
+	and	$2,$6,$8
+	lw	$3,0($4)
+	beq	$2,$9,$L188
+	li	$7,-1			# 0xffffffffffffffff
+
+	beq	$6,$7,$L188
 	nop
 
-	lhu	$3,36($4)
+	beq	$3,$0,$L188
 	nop
-	sltu	$2,$3,1024
-	bne	$2,$0,$L161
-	li	$2,1			# 0x1
 
-	beq	$3,$6,$L161
+	lw	$3,20($5)
+	lw	$6,0($5)
+	and	$2,$3,$8
+	beq	$2,$9,$L188
 	nop
 
-	lhu	$3,16($5)
+	beq	$3,$7,$L188
 	nop
-	sltu	$2,$3,1024
-	bne	$2,$0,$L161
-	li	$2,1			# 0x1
 
-	beq	$3,$6,$L161
+	beq	$6,$0,$L188
+	li	$3,80			# 0x50
+
+	lhu	$2,16($4)
 	nop
+	beq	$2,$3,$L188
+	li	$6,8080			# 0x1f90
 
-	lhu	$3,36($5)
+	beq	$2,$6,$L188
 	nop
-	sltu	$2,$3,1024
-	bne	$2,$0,$L161
-	li	$2,1			# 0x1
 
-	beq	$3,$6,$L161
-	li	$7,-268435456			# 0xfffffffff0000000
+	lhu	$4,36($4)
+	nop
+	beq	$4,$3,$L188
+	nop
 
-	lw	$3,20($4)
-	li	$8,-536870912			# 0xffffffffe0000000
-	and	$2,$3,$7
-	lw	$4,0($4)
-	beq	$2,$8,$L398
-	li	$6,-1			# 0xffffffffffffffff
+	beq	$4,$6,$L188
+	nop
 
-	beq	$3,$6,$L161
-	li	$2,1			# 0x1
+	lhu	$2,16($5)
+	nop
+	beq	$2,$3,$L188
+	nop
 
-	beq	$4,$0,$L161
+	beq	$2,$6,$L188
 	nop
 
-	lw	$3,20($5)
-	lw	$5,0($5)
-	and	$2,$3,$7
-	beq	$2,$8,$L161
-	li	$2,1			# 0x1
-
-	beq	$3,$6,$L161
+	lhu	$5,36($5)
 	nop
+	beq	$5,$3,$L205
+	li	$7,1			# 0x1
 
-	beq	$5,$0,$L161
-	lui	$3,%hi(prot_counters+4)
+	bne	$5,$6,$L177
+	move	$7,$0
 
+$L188:
+	li	$7,1			# 0x1
+$L177:
+$L205:
+	j	$31
+	move	$2,$7
+
+	.set	macro
+	.set	reorder
+	.end	isReservedConntrack
+	.section	.text.drop_one_conntrack,"ax",@progbits
+	.align	2
+	.globl	drop_one_conntrack
+	.ent	drop_one_conntrack
+	.type	drop_one_conntrack, @function
+drop_one_conntrack:
+	.set	nomips16
+	.frame	$sp,64,$31		# vars= 0, regs= 9/0, args= 24, gp= 0
+	.mask	0x80ff0000,-8
+	.fmask	0x00000000,0
+	.set	noreorder
+	.set	nomacro
+	
+	addiu	$sp,$sp,-64
+	sw	$31,56($sp)
+	sw	$23,52($sp)
+	sw	$22,48($sp)
+	sw	$21,44($sp)
+	sw	$20,40($sp)
+	sw	$19,36($sp)
+	sw	$18,32($sp)
+	sw	$17,28($sp)
+	sw	$16,24($sp)
 	lui	$2,%hi(_prot_limit+4)
+	lui	$3,%hi(prot_counters+4)
 	lw	$2,%lo(_prot_limit+4)($2)
 	lw	$3,%lo(prot_counters+4)($3)
 	nop
 	slt	$2,$2,$3
-	beq	$2,$0,$L451
+	beq	$2,$0,$L556
 	lui	$2,%hi(_prot_limit+8)
 
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$3,%hi(drop_priority)
-$L453:
+$L558:
 	addiu	$3,$3,%lo(drop_priority)
 	sll	$2,$19,2
 	addu	$2,$2,$3
 	lbu	$3,0($2)
 	nop
 	sltu	$2,$3,10
-	beq	$2,$0,$L190
+	beq	$2,$0,$L213
 	lui	$2,%hi(Tcp_State_Hash_Head)
 
 	sll	$3,$3,3
@@ -1131,11 +1177,11 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L190
+	beq	$4,$18,$L213
 	move	$17,$4
 
-$L441:
-	beq	$17,$18,$L190
+$L543:
+	beq	$17,$18,$L213
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1149,85 +1195,85 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L196
+	beq	$2,$12,$L219
 	and	$2,$3,$11
 
-	beq	$2,$12,$L196
+	beq	$2,$12,$L219
 	nop
 
-	bne	$4,$3,$L452
+	bne	$4,$3,$L557
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L196
+	beq	$6,$5,$L219
 	nop
 
-$L452:
-	bne	$2,$0,$L196
+$L557:
+	bne	$2,$0,$L219
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L196
+	bne	$2,$0,$L219
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L196
+	bne	$2,$0,$L219
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L196
+	bne	$2,$0,$L219
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L196
+	beq	$7,$2,$L219
 	nop
 
-	beq	$8,$2,$L196
+	beq	$8,$2,$L219
 	nop
 
-	beq	$9,$2,$L196
+	beq	$9,$2,$L219
 	nop
 
-	beq	$10,$2,$L196
+	beq	$10,$2,$L219
 	nop
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	bne	$2,$0,$L416
+	bne	$2,$0,$L527
 	nop
 
-$L196:
+$L219:
 	lw	$17,0($17)
-	j	$L441
+	j	$L543
 	nop
 
-$L190:
+$L213:
 	addiu	$19,$19,1
 	sltu	$2,$19,10
-	bne	$2,$0,$L453
+	bne	$2,$0,$L558
 	lui	$3,%hi(drop_priority)
 
 	jal	local_bh_enable
 	nop
 
 	lui	$2,%hi(_prot_limit+8)
-$L451:
+$L556:
 	lui	$3,%hi(prot_counters+8)
 	lw	$2,%lo(_prot_limit+8)($2)
 	lw	$3,%lo(prot_counters+8)($3)
 	nop
 	slt	$2,$2,$3
-	beq	$2,$0,$L220
+	beq	$2,$0,$L243
 	nop
 
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$3,%hi(drop_priority)
-$L455:
+$L560:
 	addiu	$3,$3,%lo(drop_priority)
 	sll	$2,$19,2
 	addu	$2,$2,$3
 	lbu	$3,0($2)
 	nop
 	sltu	$2,$3,11
-	bne	$2,$0,$L226
+	bne	$2,$0,$L249
 	lui	$2,%hi(Udp_State_Hash_Head)
 
 	sll	$3,$3,3
@@ -1237,11 +1283,11 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L226
+	beq	$4,$18,$L249
 	move	$17,$4
 
-$L442:
-	beq	$17,$18,$L226
+$L544:
+	beq	$17,$18,$L249
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1255,89 +1301,76 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L232
+	beq	$2,$12,$L255
 	and	$2,$3,$11
 
-	beq	$2,$12,$L232
+	beq	$2,$12,$L255
 	nop
 
-	bne	$4,$3,$L454
+	bne	$4,$3,$L559
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L232
+	beq	$6,$5,$L255
 	nop
 
-$L454:
-	bne	$2,$0,$L232
+$L559:
+	bne	$2,$0,$L255
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L232
+	bne	$2,$0,$L255
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L232
+	bne	$2,$0,$L255
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L232
+	bne	$2,$0,$L255
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L232
+	beq	$7,$2,$L255
 	nop
 
-	beq	$8,$2,$L232
+	beq	$8,$2,$L255
 	nop
 
-	beq	$9,$2,$L232
+	beq	$9,$2,$L255
 	nop
 
-	beq	$10,$2,$L232
+	beq	$10,$2,$L255
 	nop
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	bne	$2,$0,$L416
+	bne	$2,$0,$L527
 	nop
 
-$L232:
+$L255:
 	lw	$17,0($17)
-	j	$L442
+	j	$L544
 	nop
 
-$L226:
+$L249:
 	addiu	$19,$19,1
 	sltu	$2,$19,10
-	bne	$2,$0,$L455
+	bne	$2,$0,$L560
 	lui	$3,%hi(drop_priority)
 
 	jal	local_bh_enable
 	nop
 
-	j	$L220
-	nop
-
-$L416:
-	jal	local_bh_enable
-	nop
-
-	jal	rtl_death_action
-	move	$4,$16
-
-	j	$L450
-	lui	$4,%hi(rtl_newGC_session_status_flags)
-
-$L220:
+$L243:
 	jal	local_bh_disable
 	move	$19,$0
 
 	lui	$22,%hi(drop_priority)
-$L460:
+$L565:
 	sll	$21,$19,2
 	addiu	$2,$22,%lo(drop_priority)
 	addu	$2,$21,$2
 	lbu	$2,0($2)
 	nop
 	sltu	$3,$2,10
-	beq	$3,$0,$L264
+	beq	$3,$0,$L287
 	sll	$4,$2,3
 
 	lui	$2,%hi(Tcp_State_Hash_Head)
@@ -1347,13 +1380,13 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L297
+	beq	$4,$18,$L320
 	li	$23,3			# 0x3
 
 	move	$17,$4
 	move	$20,$0
-$L443:
-	beq	$17,$18,$L297
+$L545:
+	beq	$17,$18,$L320
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1367,42 +1400,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L270
+	beq	$2,$12,$L293
 	addiu	$20,$20,1
 
 	and	$2,$3,$11
-	beq	$2,$12,$L270
+	beq	$2,$12,$L293
 	nop
 
-	bne	$4,$3,$L456
+	bne	$4,$3,$L561
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L270
+	beq	$6,$5,$L293
 	nop
 
-$L456:
-	bne	$2,$0,$L270
+$L561:
+	bne	$2,$0,$L293
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L270
+	bne	$2,$0,$L293
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L270
+	bne	$2,$0,$L293
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L270
+	bne	$2,$0,$L293
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L270
+	beq	$7,$2,$L293
 	nop
 
-	beq	$8,$2,$L270
+	beq	$8,$2,$L293
 	nop
 
-	beq	$9,$2,$L270
+	beq	$9,$2,$L293
 	nop
 
-	beq	$10,$2,$L270
+	beq	$10,$2,$L293
 	lui	$2,%hi(jiffies)
 
 	lw	$4,%lo(jiffies)($2)
@@ -1413,58 +1446,58 @@
 	subu	$3,$3,$4
 	srl	$3,$3,7
 	sltu	$2,$2,$3
-	bne	$2,$0,$L457
-	slt	$2,$20,1025
+	bne	$2,$0,$L562
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L457
-	slt	$2,$20,1025
+	beq	$2,$0,$L562
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks1
 	sw	$23,16($sp)
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L417
+	beq	$3,$2,$L517
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L444
+	beq	$3,$2,$L546
 	move	$5,$19
 
 	move	$4,$16
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L457:
-	beq	$2,$0,$L320
+	slt	$2,$20,129
+$L562:
+	beq	$2,$0,$L343
 	move	$3,$0
 
-$L270:
+$L293:
 	lw	$17,0($17)
-	j	$L443
+	j	$L545
 	nop
 
-$L417:
+$L517:
 	jal	local_bh_enable
 	nop
 
 	jal	rtl_death_action
 	move	$4,$16
 
-$L444:
-	j	$L320
+$L546:
+	j	$L343
 	li	$3,1			# 0x1
 
-$L264:
+$L287:
 	lui	$2,%hi(Udp_State_Hash_Head)
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addu	$2,$4,$2
@@ -1472,13 +1505,13 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L297
+	beq	$4,$18,$L320
 	li	$23,12			# 0xc
 
 	move	$17,$4
 	move	$20,$0
-$L445:
-	beq	$17,$18,$L297
+$L547:
+	beq	$17,$18,$L320
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1492,42 +1525,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L301
+	beq	$2,$12,$L324
 	addiu	$20,$20,1
 
 	and	$2,$3,$11
-	beq	$2,$12,$L301
+	beq	$2,$12,$L324
 	nop
 
-	bne	$4,$3,$L458
+	bne	$4,$3,$L563
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L301
+	beq	$6,$5,$L324
 	nop
 
-$L458:
-	bne	$2,$0,$L301
+$L563:
+	bne	$2,$0,$L324
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L301
+	bne	$2,$0,$L324
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L301
+	bne	$2,$0,$L324
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L301
+	bne	$2,$0,$L324
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L301
+	beq	$7,$2,$L324
 	nop
 
-	beq	$8,$2,$L301
+	beq	$8,$2,$L324
 	nop
 
-	beq	$9,$2,$L301
+	beq	$9,$2,$L324
 	nop
 
-	beq	$10,$2,$L301
+	beq	$10,$2,$L324
 	lui	$2,%hi(jiffies)
 
 	lw	$4,%lo(jiffies)($2)
@@ -1538,55 +1571,55 @@
 	subu	$3,$3,$4
 	srl	$3,$3,7
 	sltu	$2,$2,$3
-	bne	$2,$0,$L459
-	slt	$2,$20,1025
+	bne	$2,$0,$L564
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L459
-	slt	$2,$20,1025
+	beq	$2,$0,$L564
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks1
 	sw	$23,16($sp)
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L417
+	beq	$3,$2,$L517
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L444
+	beq	$3,$2,$L546
 	move	$5,$19
 
 	move	$4,$16
 	move	$6,$0
-	li	$7,1			# 0x1
+	move	$7,$0
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L459:
-	beq	$2,$0,$L320
+	slt	$2,$20,129
+$L564:
+	beq	$2,$0,$L343
 	move	$3,$0
 
-$L301:
+$L324:
 	lw	$17,0($17)
-	j	$L445
+	j	$L547
 	nop
 
-$L297:
+$L320:
 	move	$3,$0
-$L320:
+$L343:
 	li	$2,1			# 0x1
-	beq	$3,$2,$L257
+	beq	$3,$2,$L555
 	addiu	$19,$19,1
 
 	sltu	$2,$19,10
-	bne	$2,$0,$L460
+	bne	$2,$0,$L565
 	lui	$22,%hi(drop_priority)
 
 	jal	local_bh_enable
@@ -1595,14 +1628,14 @@
 	jal	local_bh_disable
 	lui	$22,%hi(drop_priority)
 
-$L465:
+$L570:
 	sll	$21,$19,2
 	addiu	$2,$22,%lo(drop_priority)
 	addu	$2,$21,$2
 	lbu	$2,0($2)
 	nop
 	sltu	$3,$2,10
-	beq	$3,$0,$L334
+	beq	$3,$0,$L357
 	sll	$4,$2,3
 
 	lui	$2,%hi(Tcp_State_Hash_Head)
@@ -1612,13 +1645,13 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L367
+	beq	$4,$18,$L390
 	li	$23,3			# 0x3
 
 	move	$17,$4
 	move	$20,$0
-$L446:
-	beq	$17,$18,$L367
+$L548:
+	beq	$17,$18,$L390
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1632,42 +1665,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L340
+	beq	$2,$12,$L363
 	addiu	$20,$20,1
 
 	and	$2,$3,$11
-	beq	$2,$12,$L340
+	beq	$2,$12,$L363
 	nop
 
-	bne	$4,$3,$L461
+	bne	$4,$3,$L566
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L340
+	beq	$6,$5,$L363
 	nop
 
-$L461:
-	bne	$2,$0,$L340
+$L566:
+	bne	$2,$0,$L363
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L340
+	bne	$2,$0,$L363
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L340
+	bne	$2,$0,$L363
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L340
+	bne	$2,$0,$L363
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L340
+	beq	$7,$2,$L363
 	nop
 
-	beq	$8,$2,$L340
+	beq	$8,$2,$L363
 	nop
 
-	beq	$9,$2,$L340
+	beq	$9,$2,$L363
 	nop
 
-	beq	$10,$2,$L340
+	beq	$10,$2,$L363
 	lui	$2,%hi(jiffies)
 
 	lw	$4,%lo(jiffies)($2)
@@ -1678,14 +1711,14 @@
 	subu	$3,$3,$4
 	srl	$3,$3,9
 	sltu	$2,$2,$3
-	bne	$2,$0,$L462
-	slt	$2,$20,1025
+	bne	$2,$0,$L567
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L462
-	slt	$2,$20,1025
+	beq	$2,$0,$L567
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
@@ -1696,10 +1729,10 @@
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L422
+	beq	$3,$2,$L522
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L447
+	beq	$3,$2,$L549
 	move	$5,$19
 
 	move	$4,$16
@@ -1708,28 +1741,28 @@
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L462:
-	beq	$2,$0,$L390
+	slt	$2,$20,129
+$L567:
+	beq	$2,$0,$L413
 	move	$3,$0
 
-$L340:
+$L363:
 	lw	$17,0($17)
-	j	$L446
+	j	$L548
 	nop
 
-$L422:
+$L522:
 	jal	local_bh_enable
 	nop
 
 	jal	rtl_death_action
 	move	$4,$16
 
-$L447:
-	j	$L390
+$L549:
+	j	$L413
 	li	$3,1			# 0x1
 
-$L334:
+$L357:
 	lui	$2,%hi(Udp_State_Hash_Head)
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addu	$2,$4,$2
@@ -1737,13 +1770,13 @@
 	nop
 	lw	$4,0($18)
 	nop
-	beq	$4,$18,$L367
+	beq	$4,$18,$L390
 	li	$23,12			# 0xc
 
 	move	$17,$4
 	move	$20,$0
-$L448:
-	beq	$17,$18,$L367
+$L550:
+	beq	$17,$18,$L390
 	addiu	$16,$17,-204
 
 	lw	$6,32($16)
@@ -1757,42 +1790,42 @@
 	lw	$4,12($16)
 	lw	$5,60($16)
 	lw	$3,80($16)
-	beq	$2,$12,$L371
+	beq	$2,$12,$L394
 	addiu	$20,$20,1
 
 	and	$2,$3,$11
-	beq	$2,$12,$L371
+	beq	$2,$12,$L394
 	nop
 
-	bne	$4,$3,$L463
+	bne	$4,$3,$L568
 	sltu	$2,$7,1024
 
-	beq	$6,$5,$L371
+	beq	$6,$5,$L394
 	nop
 
-$L463:
-	bne	$2,$0,$L371
+$L568:
+	bne	$2,$0,$L394
 	sltu	$2,$8,1024
 
-	bne	$2,$0,$L371
+	bne	$2,$0,$L394
 	sltu	$2,$9,1024
 
-	bne	$2,$0,$L371
+	bne	$2,$0,$L394
 	sltu	$2,$10,1024
 
-	bne	$2,$0,$L371
+	bne	$2,$0,$L394
 	li	$2,8080			# 0x1f90
 
-	beq	$7,$2,$L371
+	beq	$7,$2,$L394
 	nop
 
-	beq	$8,$2,$L371
+	beq	$8,$2,$L394
 	nop
 
-	beq	$9,$2,$L371
+	beq	$9,$2,$L394
 	nop
 
-	beq	$10,$2,$L371
+	beq	$10,$2,$L394
 	lui	$2,%hi(jiffies)
 
 	lw	$4,%lo(jiffies)($2)
@@ -1803,14 +1836,14 @@
 	subu	$3,$3,$4
 	srl	$3,$3,9
 	sltu	$2,$2,$3
-	bne	$2,$0,$L464
-	slt	$2,$20,1025
+	bne	$2,$0,$L569
+	slt	$2,$20,129
 
 	jal	del_timer
 	addiu	$4,$17,-96
 
-	beq	$2,$0,$L464
-	slt	$2,$20,1025
+	beq	$2,$0,$L569
+	slt	$2,$20,129
 
 	move	$4,$16
 	move	$5,$19
@@ -1821,10 +1854,10 @@
 
 	move	$3,$2
 	li	$2,1			# 0x1
-	beq	$3,$2,$L422
+	beq	$3,$2,$L522
 	li	$2,2			# 0x2
 
-	beq	$3,$2,$L447
+	beq	$3,$2,$L549
 	move	$5,$19
 
 	move	$4,$16
@@ -1833,67 +1866,282 @@
 	jal	__drop_one_conntrack_process_hooks2
 	sw	$23,16($sp)
 
-	slt	$2,$20,1025
-$L464:
-	beq	$2,$0,$L390
+	slt	$2,$20,129
+$L569:
+	beq	$2,$0,$L413
 	move	$3,$0
 
-$L371:
+$L394:
 	lw	$17,0($17)
-	j	$L448
+	j	$L550
 	nop
 
-$L367:
+$L390:
 	move	$3,$0
-$L390:
+$L413:
 	li	$2,1			# 0x1
-	beq	$3,$2,$L257
+	beq	$3,$2,$L555
 	addiu	$19,$19,1
 
 	sltu	$2,$19,10
-	bne	$2,$0,$L465
+	bne	$2,$0,$L570
 	lui	$22,%hi(drop_priority)
 
-	j	$L440
+	jal	local_bh_enable
+	move	$19,$0
+
+	jal	local_bh_disable
 	nop
 
-$L257:
+$L454:
+	lui	$20,%hi(drop_priority)
+	addiu	$3,$20,%lo(drop_priority)
+	sll	$2,$19,2
+	addu	$2,$2,$3
+	lbu	$3,0($2)
+	nop
+	sltu	$2,$3,10
+	beq	$2,$0,$L428
+	lui	$2,%hi(Tcp_State_Hash_Head)
+
+	sll	$3,$3,3
+	addiu	$2,$2,%lo(Tcp_State_Hash_Head)
+	addu	$3,$3,$2
+	lw	$18,4($3)
+	nop
+	lw	$4,0($18)
+	nop
+	beq	$4,$18,$L428
+	move	$17,$4
+
+$L551:
+	beq	$17,$18,$L428
+	addiu	$16,$17,-204
+
+	lw	$6,32($16)
+	li	$11,-268435456			# 0xfffffffff0000000
+	li	$12,-536870912			# 0xffffffffe0000000
+	and	$2,$6,$11
+	lhu	$7,28($16)
+	lhu	$8,48($16)
+	lhu	$9,76($16)
+	lhu	$10,96($16)
+	lw	$4,12($16)
+	lw	$5,60($16)
+	lw	$3,80($16)
+	beq	$2,$12,$L434
+	and	$2,$3,$11
+
+	beq	$2,$12,$L434
+	nop
+
+	bne	$4,$3,$L571
+	sltu	$2,$7,1024
+
+	beq	$6,$5,$L434
+	nop
+
+$L571:
+	bne	$2,$0,$L434
+	sltu	$2,$8,1024
+
+	bne	$2,$0,$L434
+	sltu	$2,$9,1024
+
+	bne	$2,$0,$L434
+	sltu	$2,$10,1024
+
+	bne	$2,$0,$L434
+	li	$2,8080			# 0x1f90
+
+	beq	$7,$2,$L434
+	nop
+
+	beq	$8,$2,$L434
+	nop
+
+	beq	$9,$2,$L434
+	nop
+
+	beq	$10,$2,$L434
+	nop
+
+	jal	del_timer
+	addiu	$4,$17,-96
+
+	bne	$2,$0,$L527
+	nop
+
+$L434:
+	lw	$17,0($17)
+	j	$L551
+	nop
+
+$L428:
+	addiu	$19,$19,1
+	sltu	$2,$19,10
+	bne	$2,$0,$L454
+	nop
+
+	j	$L542
+	nop
+
+$L527:
+	jal	local_bh_enable
+	nop
+
+	jal	rtl_death_action
+	move	$4,$16
+
+$L555:
+	j	$L554
 	lui	$4,%hi(rtl_newGC_session_status_flags)
-$L450:
-	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
+
+$L528:
+	jal	local_bh_enable
 	nop
-	bne	$2,$0,$L398
+
+	jal	rtl_death_action
+	move	$4,$16
+
+	j	$L488
+	li	$2,1			# 0x1
+
+$L542:
+	jal	local_bh_enable
+	move	$19,$0
+
+	jal	local_bh_disable
 	nop
 
+	addiu	$3,$20,%lo(drop_priority)
+$L573:
+	sll	$2,$19,2
+	addu	$2,$2,$3
+	lbu	$3,0($2)
+	nop
+	sltu	$2,$3,11
+	bne	$2,$0,$L464
+	lui	$2,%hi(Udp_State_Hash_Head)
+
+	sll	$3,$3,3
+	addiu	$2,$2,%lo(Udp_State_Hash_Head)
+	addu	$3,$3,$2
+	lw	$18,-84($3)
+	nop
+	lw	$4,0($18)
+	nop
+	beq	$4,$18,$L464
+	move	$17,$4
+
+$L552:
+	beq	$17,$18,$L464
+	addiu	$16,$17,-204
+
+	lw	$6,32($16)
+	li	$11,-268435456			# 0xfffffffff0000000
+	li	$12,-536870912			# 0xffffffffe0000000
+	and	$2,$6,$11
+	lhu	$7,28($16)
+	lhu	$8,48($16)
+	lhu	$9,76($16)
+	lhu	$10,96($16)
+	lw	$4,12($16)
+	lw	$5,60($16)
+	lw	$3,80($16)
+	beq	$2,$12,$L470
+	and	$2,$3,$11
+
+	beq	$2,$12,$L470
+	nop
+
+	bne	$4,$3,$L572
+	sltu	$2,$7,1024
+
+	beq	$6,$5,$L470
+	nop
+
+$L572:
+	bne	$2,$0,$L470
+	sltu	$2,$8,1024
+
+	bne	$2,$0,$L470
+	sltu	$2,$9,1024
+
+	bne	$2,$0,$L470
+	sltu	$2,$10,1024
+
+	bne	$2,$0,$L470
+	li	$2,8080			# 0x1f90
+
+	beq	$7,$2,$L470
+	nop
+
+	beq	$8,$2,$L470
+	nop
+
+	beq	$9,$2,$L470
+	nop
+
+	beq	$10,$2,$L470
+	nop
+
+	jal	del_timer
+	addiu	$4,$17,-96
+
+	bne	$2,$0,$L528
+	nop
+
+$L470:
+	lw	$17,0($17)
+	j	$L552
+	nop
+
+$L464:
+	addiu	$19,$19,1
+	sltu	$2,$19,10
+	bne	$2,$0,$L573
+	addiu	$3,$20,%lo(drop_priority)
+
+	jal	local_bh_enable
+	nop
+
+	move	$2,$0
+$L488:
+	beq	$2,$0,$L458
+	lui	$4,%hi(rtl_newGC_session_status_flags)
+
+$L554:
+	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
+	nop
+	bne	$2,$0,$L493
 	lui	$2,%hi(jiffies)
+
 	lw	$3,%lo(jiffies)($2)
 	li	$2,3			# 0x3
 	sw	$2,%lo(rtl_newGC_session_status_flags)($4)
 	addiu	$3,$3,1
 	lui	$2,%hi(rtl_newGC_session_status_time)
 	sw	$3,%lo(rtl_newGC_session_status_time)($2)
-$L398:
-	j	$L161
-	li	$2,1			# 0x1
+$L493:
+	j	$L206
+	li	$3,1			# 0x1
 
-$L440:
-	jal	local_bh_enable
+$L458:
+	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
 	nop
+	bne	$2,$0,$L206
+	move	$3,$0
 
-	lui	$4,%hi(rtl_newGC_session_status_flags)
-	lw	$2,%lo(rtl_newGC_session_status_flags)($4)
-	li	$3,1			# 0x1
-	beq	$2,$3,$L400
 	lui	$2,%hi(jiffies)
-
-	lw	$2,%lo(jiffies)($2)
-	sw	$3,%lo(rtl_newGC_session_status_flags)($4)
-	lui	$3,%hi(rtl_newGC_session_status_time)
-	addiu	$2,$2,200
-	sw	$2,%lo(rtl_newGC_session_status_time)($3)
-$L400:
-	move	$2,$0
-$L161:
+	lw	$3,%lo(jiffies)($2)
+	li	$2,3			# 0x3
+	sw	$2,%lo(rtl_newGC_session_status_flags)($4)
+	addiu	$3,$3,1
+	lui	$2,%hi(rtl_newGC_session_status_time)
+	sw	$3,%lo(rtl_newGC_session_status_time)($2)
+	move	$3,$0
+$L206:
 	lw	$31,56($sp)
 	lw	$23,52($sp)
 	lw	$22,48($sp)
@@ -1903,6 +2151,7 @@
 	lw	$18,32($sp)
 	lw	$17,28($sp)
 	lw	$16,24($sp)
+	move	$2,$3
 	j	$31
 	addiu	$sp,$sp,64
 
@@ -1929,32 +2178,32 @@
 	sw	$16,16($sp)
 	addiu	$2,$2,4
 	li	$5,10			# 0xa
-$L472:
+$L580:
 	lw	$3,0($2)
 	addiu	$5,$5,-1
-	beq	$3,$0,$L469
+	beq	$3,$0,$L577
 	addiu	$2,$2,8
 
 	sw	$3,4($3)
 	sw	$3,0($3)
-$L469:
-	bgez	$5,$L472
+$L577:
+	bgez	$5,$L580
 	nop
 
 	lui	$2,%hi(Udp_State_Hash_Head)
 	addiu	$2,$2,%lo(Udp_State_Hash_Head)
 	addiu	$2,$2,4
 	li	$5,1			# 0x1
-$L478:
+$L586:
 	lw	$3,0($2)
 	addiu	$5,$5,-1
-	beq	$3,$0,$L475
+	beq	$3,$0,$L583
 	addiu	$2,$2,8
 
 	sw	$3,4($3)
 	sw	$3,0($3)
-$L475:
-	bgez	$5,$L478
+$L583:
+	bgez	$5,$L586
 	lui	$16,%hi(prot_limit)
 
 	move	$5,$0
@@ -1968,14 +2217,14 @@
 	addiu	$6,$2,%lo(_prot_limit)
 	move	$5,$0
 	sll	$2,$5,2
-$L501:
+$L609:
 	addiu	$5,$5,1
 	addu	$4,$2,$6
 	slt	$3,$5,3
 	addu	$2,$2,$7
 	sw	$0,0($2)
 	sw	$0,0($4)
-	bne	$3,$0,$L501
+	bne	$3,$0,$L609
 	sll	$2,$5,2
 
 	lui	$2,%hi(nf_conntrack_max)
@@ -1996,7 +2245,7 @@
 	ori	$8,$2,0x851f
 	move	$5,$0
 	sll	$3,$5,2
-$L502:
+$L610:
 	addu	$2,$3,$9
 	lw	$2,0($2)
 	addiu	$5,$5,1
@@ -2008,7 +2257,7 @@
 	mfhi	$2
 	srl	$2,$2,5
 	sw	$2,0($3)
-	bne	$4,$0,$L502
+	bne	$4,$0,$L610
 	sll	$3,$5,2
 
 	li	$3,-859045888			# 0xffffffffcccc0000
@@ -2019,41 +2268,41 @@
 	mfhi	$2
 	srl	$2,$2,2
 	subu	$3,$6,$2
-	sltu	$3,$3,65
-	bne	$3,$0,$L488
+	sltu	$3,$3,129
+	bne	$3,$0,$L596
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 
-	addiu	$2,$6,-64
+	addiu	$2,$6,-128
 	sw	$2,%lo(rtl_nf_conntrack_threshold)($4)
-$L488:
+$L596:
 	lui	$2,%hi(nf_conntrack_max)
 	lw	$2,%lo(nf_conntrack_max)($2)
 	nop
-	beq	$2,$0,$L489
+	beq	$2,$0,$L597
 	lui	$2,%hi(init_net+468)
 
 	lw	$3,%lo(init_net+468)($2)
 	lw	$2,%lo(rtl_nf_conntrack_threshold)($4)
 	nop
 	slt	$2,$2,$3
-	beq	$2,$0,$L489
+	beq	$2,$0,$L597
 	li	$3,3			# 0x3
 
 	lw	$2,%lo(rtl_newGC_session_status_flags)($7)
 	nop
-	beq	$2,$3,$L492
+	beq	$2,$3,$L600
 	lui	$2,%hi(jiffies)
 
 	lw	$2,%lo(jiffies)($2)
 	sw	$3,%lo(rtl_newGC_session_status_flags)($7)
 	lui	$3,%hi(rtl_newGC_session_status_time)
 	addiu	$2,$2,1
-	j	$L492
+	j	$L600
 	sw	$2,%lo(rtl_newGC_session_status_time)($3)
 
-$L489:
+$L597:
 	sw	$0,%lo(rtl_newGC_session_status_flags)($7)
-$L492:
+$L600:
 	jal	rtl_nf_conn_GC_init_hooks
 	nop
 
@@ -2093,8 +2342,16 @@
 	.size	prot_limit, 12
 prot_limit:
 	.space	12
-	.local	prot_counters
-	.comm	prot_counters,12,4
-	.local	_prot_limit
-	.comm	_prot_limit,12,4
+	.globl	prot_counters
+	.align	2
+	.type	prot_counters, @object
+	.size	prot_counters, 12
+prot_counters:
+	.space	12
+	.globl	_prot_limit
+	.align	2
+	.type	_prot_limit, @object
+	.size	_prot_limit, 12
+_prot_limit:
+	.space	12
 	.ident	"GCC: (GNU) 3.4.6-1.3.6"
Index: features/rtl_ps_hooks.c
===================================================================
--- features/rtl_ps_hooks.c	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ features/rtl_ps_hooks.c	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -252,17 +252,17 @@
 	return RTL_PS_HOOKS_CONTINUE;
 }
 
-int32 rtl_netif_receive_skb_hooks(struct sk_buff *skb)
+int32 rtl_netif_receive_skb_hooks(struct sk_buff **pskb)
 {
 	int	ret;
 
 	#if defined(CONFIG_RTL_FAST_BRIDGE)
-	if(skb->dev->br_port && (rtl_fast_br_forwarding(skb)==RTL_FAST_BR_SUCCESS)) {
+	if(skb->dev->br_port && (rtl_fast_br_forwarding(*pskb)==RTL_FAST_BR_SUCCESS)) {
 		ret = RTL_PS_HOOKS_RETURN;
 	} else
 	#endif
 	#if defined(CONFIG_RTL_IPTABLES_FAST_PATH)
-	if (FastPath_Enter(&skb)== NET_RX_DROP) {
+	if (FastPath_Enter(pskb)== NET_RX_DROP) {
 		ret = RTL_PS_HOOKS_RETURN;
 	} else
 	#endif
Index: features/Makefile
===================================================================
--- features/Makefile	(.../rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 10143)
+++ features/Makefile	(.../sdk-store/rtl819x-sdk-v2.5/rtl819x/linux-2.6.30/net/rtl)	(revision 20709)
@@ -6,7 +6,7 @@
 EXTRA_CFLAGS += -I $(DIR_LINUX)/net
 EXTRA_CFLAGS += -D__KERNEL__
 #EXTRA_CFLAGS += -Wno-implicit -Werror
- 
+
 #EXTRA_CFLAGS += -DCONFIG_RTK_IPTABLES_FAST_PATH
 #EXTRA_CFLAGS += -DCONFIG_FAST_PATH_MODULE
 
